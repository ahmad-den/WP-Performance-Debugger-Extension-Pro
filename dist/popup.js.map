{"version":3,"file":"popup.js","mappings":"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","sources":["webpack://new-bs-helper-extension/./src/popup/toggle-manager.js","webpack://new-bs-helper-extension/./src/utils/window-state.js","webpack://new-bs-helper-extension/./src/utils/tab-helpers.js","webpack://new-bs-helper-extension/./src/utils/toast-notifications.js","webpack://new-bs-helper-extension/./src/popup/displays/insights-renderer.js","webpack://new-bs-helper-extension/./src/popup/displays/psi-insights-display.js","webpack://new-bs-helper-extension/./src/popup/displays/insights-display.js","webpack://new-bs-helper-extension/webpack/bootstrap","webpack://new-bs-helper-extension/webpack/runtime/define property getters","webpack://new-bs-helper-extension/webpack/runtime/hasOwnProperty shorthand","webpack://new-bs-helper-extension/webpack/runtime/make namespace object","webpack://new-bs-helper-extension/./src/popup/displays/image-display.js","webpack://new-bs-helper-extension/./src/popup/displays/font-display.js","webpack://new-bs-helper-extension/./src/utils/formatters.js","webpack://new-bs-helper-extension/./src/popup/displays/header-display.js","webpack://new-bs-helper-extension/./src/utils/messaging.js","webpack://new-bs-helper-extension/./src/popup/window-state-manager.js","webpack://new-bs-helper-extension/./src/popup/index.js","webpack://new-bs-helper-extension/./src/popup/tab-manager.js"],"sourcesContent":["/**\n * Module for managing debug toggles and parameters with proper loading detection\n */\n\n// Global state management\nlet isProcessingToggle = false\nconst toggleQueue = []\nlet currentOperation = null\n\n/**\n * Sets up toggle functionality\n */\nexport function setupToggleManagement() {\n\n  // Load initial toggle states using the target tab ID\n  loadInitialToggleStates()\n\n  // Add event listeners to toggles with queuing\n  const toggleInputs = document.querySelectorAll(\".toggle-input\")\n  toggleInputs.forEach((input) => {\n    input.addEventListener(\"change\", (event) => {\n      // Prevent rapid clicking\n      if (isProcessingToggle) {\n        event.preventDefault()\n        input.checked = !input.checked // Revert the change\n        return\n      }\n\n      // Queue the toggle change\n      queueToggleChange(input.id, input.checked)\n    })\n  })\n}\n\n/**\n * Loads initial toggle states for the current target tab\n */\nasync function loadInitialToggleStates() {\n\n  try {\n    // Get the target tab ID (works in both attached and detached modes)\n    const targetTabId = await window.getTargetTabId()\n\n    if (!targetTabId) {\n      console.log(\"No target tab available for loading toggle states\")\n      // Set all toggles to unchecked if no tab available\n      document.getElementById(\"perfmattersoff\").checked = false\n      document.getElementById(\"perfmatterscssoff\").checked = false\n      document.getElementById(\"perfmattersjsoff\").checked = false\n      document.getElementById(\"nocache\").checked = false\n      updateToggleStates(true)\n      return\n    }\n\n    console.log(\"Loading toggle states for tab:\", targetTabId)\n\n    // Get parameters for the specific tab\n    chrome.runtime.sendMessage({ action: \"getParameters\", tabId: targetTabId }, (parameters) => {\n      if (chrome.runtime.lastError) {\n        console.error(\"Error getting parameters:\", chrome.runtime.lastError)\n        parameters = []\n      }\n\n      // Ensure parameters is an array\n      if (!Array.isArray(parameters)) {\n        parameters = []\n      }\n\n      console.log(\"Loaded parameters for tab\", targetTabId, \":\", parameters)\n\n      // Update toggle states based on parameters\n      document.getElementById(\"perfmattersoff\").checked = parameters.includes(\"perfmattersoff\")\n      document.getElementById(\"perfmatterscssoff\").checked = parameters.includes(\"perfmatterscssoff\")\n      document.getElementById(\"perfmattersjsoff\").checked = parameters.includes(\"perfmattersjsoff\")\n      document.getElementById(\"nocache\").checked = parameters.includes(\"nocache\")\n\n      updateToggleStates(true) // Pass true to skip parameter updates during initial load\n    })\n  } catch (error) {\n    console.error(\"Error loading initial toggle states:\", error)\n    // Fallback to unchecked state\n    document.getElementById(\"perfmattersoff\").checked = false\n    document.getElementById(\"perfmatterscssoff\").checked = false\n    document.getElementById(\"perfmattersjsoff\").checked = false\n    document.getElementById(\"nocache\").checked = false\n    updateToggleStates(true)\n  }\n}\n\n/**\n * Queues a toggle change to be processed sequentially\n * @param {string} toggleId - The ID of the toggle\n * @param {boolean} isChecked - Whether the toggle is checked\n */\nfunction queueToggleChange(toggleId, isChecked) {\n  const operation = {\n    toggleId,\n    isChecked,\n    timestamp: Date.now(),\n  }\n\n  toggleQueue.push(operation)\n  console.log(`Queued toggle change: ${toggleId} = ${isChecked}`)\n\n  // Process the queue if not already processing\n  if (!isProcessingToggle) {\n    processToggleQueue()\n  }\n}\n\n/**\n * Processes the toggle queue sequentially\n */\nasync function processToggleQueue() {\n  if (isProcessingToggle || toggleQueue.length === 0) {\n    return\n  }\n\n  isProcessingToggle = true\n\n  while (toggleQueue.length > 0) {\n    const operation = toggleQueue.shift()\n    currentOperation = operation\n\n    console.log(`Processing toggle: ${operation.toggleId} = ${operation.isChecked}`)\n\n    // Update UI to show loading state\n    updateToggleStates(true) // Skip parameter updates, just update UI\n\n    // Process the parameter change and wait for site to load\n    await processParameterChangeAndWaitForLoad(operation.toggleId, operation.isChecked)\n  }\n\n  currentOperation = null\n  isProcessingToggle = false\n\n  // Final UI update\n  updateToggleStates(true)\n  console.log(\"Toggle queue processing completed\")\n}\n\n/**\n * Processes a single parameter change and waits for site to fully load\n * @param {string} toggleId - The ID of the toggle\n * @param {boolean} isChecked - Whether the toggle is checked\n * @returns {Promise} Promise that resolves when the change is complete and site is loaded\n */\nasync function processParameterChangeAndWaitForLoad(toggleId, isChecked) {\n  return new Promise(async (resolve) => {\n\n    // Map toggle IDs to parameter names\n    const parameterMap = {\n      perfmattersoff: \"perfmattersoff\",\n      perfmatterscssoff: \"perfmatterscssoff\",\n      perfmattersjsoff: \"perfmattersjsoff\",\n      nocache: \"nocache\",\n    }\n\n    const parameter = parameterMap[toggleId]\n    if (!parameter) {\n      console.error(\"Unknown toggle ID:\", toggleId)\n      resolve()\n      return\n    }\n\n    try {\n      // Get the target tab ID (works in both attached and detached modes)\n      const targetTabId = await window.getTargetTabId()\n\n      if (!targetTabId) {\n        console.error(\"No target tab available for parameter update\")\n        resolve()\n        return\n      }\n\n      console.log(\"Processing parameter change for tab:\", targetTabId, \"parameter:\", parameter, \"value:\", isChecked)\n\n      // Send parameter update with specific tab ID\n      chrome.runtime.sendMessage(\n        {\n          action: \"updateParameters\",\n          parameter: parameter,\n          add: isChecked,\n          tabId: targetTabId, // Include the specific tab ID\n        },\n        (response) => {\n          if (chrome.runtime.lastError) {\n            console.error(\"Parameter update error:\", chrome.runtime.lastError)\n            resolve()\n            return\n          }\n\n          if (response && response.error) {\n            console.error(\"Parameter update failed:\", response.error)\n            resolve()\n            return\n          }\n\n          if (response && response.urlChanged) {\n            console.log(`URL updated for ${parameter} on tab ${targetTabId}, waiting for page to load...`)\n\n            // Wait for the tab to finish loading + additional time\n            waitForTabToLoadWithDelay(targetTabId)\n              .then(() => {\n                console.log(`Page loaded successfully after ${parameter} change on tab ${targetTabId}`)\n                resolve()\n              })\n              .catch((error) => {\n                console.error(\"Error waiting for page load:\", error)\n                // Resolve anyway after timeout\n                setTimeout(resolve, 5000)\n              })\n          } else {\n            console.log(`No URL change needed for ${parameter} on tab ${targetTabId}`)\n            // Still add delay even if no URL change needed to ensure consistency\n            setTimeout(resolve, 2000)\n          }\n        },\n      )\n    } catch (error) {\n      console.error(\"Error in processParameterChangeAndWaitForLoad:\", error)\n      resolve()\n    }\n  })\n}\n\n/**\n * Waits for a tab to finish loading completely with additional delay\n * @param {number} tabId - The ID of the tab to monitor\n * @returns {Promise} Promise that resolves when the tab is fully loaded\n */\nfunction waitForTabToLoadWithDelay(tabId) {\n  return new Promise((resolve, reject) => {\n    const timeout = 20000 // 20 second timeout\n    const startTime = Date.now()\n\n    function checkTabStatus() {\n      chrome.tabs.get(tabId, (tab) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(\"Tab not found\"))\n          return\n        }\n\n        // Check if tab is complete\n        if (tab.status === \"complete\") {\n          // Additional wait to ensure all resources are loaded + fake delay for control\n          setTimeout(() => {\n            console.log(`Tab ${tabId} finished loading with additional delay`)\n            resolve()\n          }, 3000) // 3 second additional delay as requested\n          return\n        }\n\n        // Check timeout\n        if (Date.now() - startTime > timeout) {\n          console.warn(`Timeout waiting for tab ${tabId} to load`)\n          resolve() // Resolve anyway to not block the queue\n          return\n        }\n\n        // Tab still loading, check again\n        setTimeout(checkTabStatus, 500)\n      })\n    }\n\n    // Start checking\n    checkTabStatus()\n  })\n}\n\n/**\n * Updates toggle states and dependencies\n * @param {boolean} skipParameterUpdate - Whether to skip updating parameters\n */\nexport function updateToggleStates(skipParameterUpdate = false) {\n  const perfmattersoff = document.getElementById(\"perfmattersoff\")\n  const perfmatterscssoff = document.getElementById(\"perfmatterscssoff\")\n  const perfmattersjsoff = document.getElementById(\"perfmattersjsoff\")\n  const nocache = document.getElementById(\"nocache\")\n\n  const isPerfmattersOff = perfmattersoff.checked\n\n  // Get all toggle containers\n  const allContainers = [\n    perfmattersoff.closest(\".toggle-container\"),\n    perfmatterscssoff.closest(\".toggle-container\"),\n    perfmattersjsoff.closest(\".toggle-container\"),\n    nocache.closest(\".toggle-container\"),\n  ]\n\n  // Apply loading state to all toggles if processing\n  if (isProcessingToggle) {\n    allContainers.forEach((container, index) => {\n      const toggleIds = [\"perfmattersoff\", \"perfmatterscssoff\", \"perfmattersjsoff\", \"nocache\"]\n      const toggleId = toggleIds[index]\n\n      if (container) {\n        const input = container.querySelector(\".toggle-input\")\n        if (input) input.disabled = true\n\n        // Only show \"processing\" on the currently active toggle\n        if (currentOperation && currentOperation.toggleId === toggleId) {\n          container.classList.add(\"processing-current\")\n          container.classList.remove(\"disabled-toggle\")\n        } else {\n          // All other toggles appear disabled\n          container.classList.add(\"disabled-toggle\")\n          container.classList.remove(\"processing-current\")\n        }\n      }\n    })\n\n    return\n  }\n\n  // Clear all loading states\n  allContainers.forEach((container) => {\n    if (container) {\n      container.classList.remove(\"processing-current\", \"disabled-toggle\")\n      const input = container.querySelector(\".toggle-input\")\n      if (input) input.disabled = false\n    }\n  })\n\n  // Handle dependent toggles\n  ;[perfmatterscssoff, perfmattersjsoff].forEach((toggle) => {\n    toggle.disabled = isPerfmattersOff\n    const container = toggle.closest(\".toggle-container\")\n    if (isPerfmattersOff) {\n      toggle.checked = false\n      container.classList.add(\"disabled-toggle\")\n    } else {\n      container.classList.remove(\"disabled-toggle\")\n    }\n  })\n\n  // Handle nocache toggle\n  nocache.disabled = isPerfmattersOff || perfmatterscssoff.checked || perfmattersjsoff.checked\n  const nocacheContainer = nocache.closest(\".toggle-container\")\n  if (nocache.disabled) {\n    if (nocache.checked) nocache.checked = false\n    nocacheContainer.classList.add(\"disabled-toggle\")\n  } else {\n    nocacheContainer.classList.remove(\"disabled-toggle\")\n  }\n\n  // Handle main perfmatters toggle\n  perfmattersoff.disabled = false\n  const perfmattersContainer = perfmattersoff.closest(\".toggle-container\")\n  perfmattersContainer.classList.remove(\"disabled-toggle\")\n}\n","/**\n * Utility module for managing popup window state - Enhanced with bounds validation\n */\n\n// Window state constants\nexport const WINDOW_STATES = {\n  ATTACHED: \"attached\",\n  DETACHED: \"detached\",\n}\n\n// Storage keys\nexport const STORAGE_KEYS = {\n  WINDOW_STATE: \"popup_window_state\",\n  DETACHED_WINDOW_ID: \"detached_window_id\",\n  WINDOW_BOUNDS: \"detached_window_bounds\",\n}\n\n// Default window dimensions - Conservative sizes for better compatibility\nexport const DEFAULT_WINDOW_CONFIG = {\n  width: 700, // Reduced from 800\n  height: 600, // Reduced from 700\n  type: \"popup\",\n  focused: true,\n}\n\n// Declare chrome variable\nconst chrome = globalThis.chrome || self.chrome\n\n/**\n * Gets the current window state from storage\n * @returns {Promise<string>} Current window state\n */\nexport async function getWindowState() {\n  try {\n    const result = await chrome.storage.local.get(STORAGE_KEYS.WINDOW_STATE)\n    return result[STORAGE_KEYS.WINDOW_STATE] || WINDOW_STATES.ATTACHED\n  } catch (error) {\n    console.debug(\"Error getting window state:\", error)\n    return WINDOW_STATES.ATTACHED\n  }\n}\n\n/**\n * Sets the window state in storage\n * @param {string} state - The window state to set\n */\nexport async function setWindowState(state) {\n  try {\n    await chrome.storage.local.set({ [STORAGE_KEYS.WINDOW_STATE]: state })\n  } catch (error) {\n    console.debug(\"Error setting window state:\", error)\n  }\n}\n\n/**\n * Gets the detached window ID from storage\n * @returns {Promise<number|null>} Window ID or null\n */\nexport async function getDetachedWindowId() {\n  try {\n    const result = await chrome.storage.local.get(STORAGE_KEYS.DETACHED_WINDOW_ID)\n    return result[STORAGE_KEYS.DETACHED_WINDOW_ID] || null\n  } catch (error) {\n    console.debug(\"Error getting detached window ID:\", error)\n    return null\n  }\n}\n\n/**\n * Sets the detached window ID in storage\n * @param {number|null} windowId - The window ID to store\n */\nexport async function setDetachedWindowId(windowId) {\n  try {\n    if (windowId === null) {\n      await chrome.storage.local.remove(STORAGE_KEYS.DETACHED_WINDOW_ID)\n    } else {\n      await chrome.storage.local.set({ [STORAGE_KEYS.DETACHED_WINDOW_ID]: windowId })\n    }\n  } catch (error) {\n    console.debug(\"Error setting detached window ID:\", error)\n  }\n}\n\n/**\n * Gets saved window bounds from storage with validation\n * @returns {Promise<Object|null>} Window bounds or null\n */\nexport async function getWindowBounds() {\n  try {\n    const result = await chrome.storage.local.get(STORAGE_KEYS.WINDOW_BOUNDS)\n    const bounds = result[STORAGE_KEYS.WINDOW_BOUNDS]\n\n    // Validate bounds before returning\n    if (bounds && typeof bounds === \"object\") {\n      // Check if bounds seem reasonable\n      if (\n        bounds.width >= 300 &&\n        bounds.height >= 200 &&\n        bounds.width <= 2000 &&\n        bounds.height <= 1500 &&\n        typeof bounds.left === \"number\" &&\n        typeof bounds.top === \"number\"\n      ) {\n        return bounds\n      } else {\n        console.log(\"Stored bounds seem invalid, ignoring:\", bounds)\n        // Clear invalid bounds\n        await setWindowBounds(null)\n        return null\n      }\n    }\n\n    return null\n  } catch (error) {\n    console.debug(\"Error getting window bounds:\", error)\n    return null\n  }\n}\n\n/**\n * Saves window bounds to storage with validation\n * @param {Object|null} bounds - Window bounds object\n */\nexport async function setWindowBounds(bounds) {\n  try {\n    if (bounds === null) {\n      await chrome.storage.local.remove(STORAGE_KEYS.WINDOW_BOUNDS)\n      console.log(\"Window bounds cleared\")\n    } else {\n      // Validate bounds before saving\n      if (\n        bounds &&\n        typeof bounds === \"object\" &&\n        bounds.width >= 300 &&\n        bounds.height >= 200 &&\n        bounds.width <= 2000 &&\n        bounds.height <= 1500 &&\n        typeof bounds.left === \"number\" &&\n        typeof bounds.top === \"number\"\n      ) {\n        await chrome.storage.local.set({ [STORAGE_KEYS.WINDOW_BOUNDS]: bounds })\n        console.log(\"Window bounds saved:\", bounds)\n      } else {\n        console.log(\"Invalid bounds not saved:\", bounds)\n      }\n    }\n  } catch (error) {\n    console.debug(\"Error setting window bounds:\", error)\n  }\n}\n\n/**\n * Gets the original tab ID from storage\n * @returns {Promise<number|null>} Original tab ID or null\n */\nexport async function getOriginalTabId() {\n  try {\n    const result = await chrome.storage.local.get(\"originalTabId\")\n    return result.originalTabId || null\n  } catch (error) {\n    console.debug(\"Error getting original tab ID:\", error)\n    return null\n  }\n}\n\n/**\n * Sets the original tab ID in storage\n * @param {number|null} tabId - The tab ID to store\n */\nexport async function setOriginalTabId(tabId) {\n  try {\n    if (tabId === null) {\n      await chrome.storage.local.remove(\"originalTabId\")\n    } else {\n      await chrome.storage.local.set({ originalTabId: tabId })\n    }\n  } catch (error) {\n    console.debug(\"Error setting original tab ID:\", error)\n  }\n}\n\n/**\n * Clears the original tab ID from storage\n */\nexport async function clearOriginalTabId() {\n  try {\n    await chrome.storage.local.remove(\"originalTabId\")\n  } catch (error) {\n    console.debug(\"Error clearing original tab ID:\", error)\n  }\n}\n\n/**\n * Checks if current window is the detached popup window\n * @returns {Promise<boolean>} True if this is the detached window\n */\nexport async function isCurrentWindowDetached() {\n  try {\n    const currentWindowId = await getCurrentWindowId()\n    const detachedWindowId = await getDetachedWindowId()\n    return currentWindowId === detachedWindowId\n  } catch (error) {\n    console.debug(\"Error checking if current window is detached:\", error)\n    return false\n  }\n}\n\n/**\n * Gets the current window ID\n * @returns {Promise<number|null>} Current window ID or null\n */\nexport async function getCurrentWindowId() {\n  try {\n    const currentWindow = await chrome.windows.getCurrent()\n    return currentWindow.id\n  } catch (error) {\n    console.debug(\"Error getting current window ID:\", error)\n    return null\n  }\n}\n","/**\n * Utility functions for tab management and verification\n */\n\nimport { getOriginalTabId, setOriginalTabId } from \"./window-state.js\"\n\n// Declare chrome variable\n\n/**\n * Gets the original tab ID from URL parameters or storage\n * @returns {Promise<number|null>} Original tab ID or null\n */\nexport async function getOriginalTabIdFromUrl() {\n  try {\n    const urlParams = new URLSearchParams(window.location.search)\n    const tabIdFromUrl = urlParams.get(\"originalTabId\")\n\n    if (tabIdFromUrl) {\n      const tabId = Number.parseInt(tabIdFromUrl, 10)\n      console.log(\"Retrieved original tab ID from URL:\", tabId)\n      return tabId\n    }\n\n    // Fallback to storage\n    const tabIdFromStorage = await getOriginalTabId()\n\n    if (tabIdFromStorage) {\n      console.log(\"Retrieved original tab ID from storage:\", tabIdFromStorage)\n      return tabIdFromStorage\n    }\n\n    console.log(\"No original tab ID found in URL or storage\")\n    return null\n  } catch (error) {\n    console.debug(\"Error getting original tab ID:\", error)\n    return null\n  }\n}\n\n/**\n * Stores the original tab ID for future use\n * @param {number} tabId - The tab ID to store\n */\nexport async function storeOriginalTabId(tabId) {\n  try {\n    await setOriginalTabId(tabId)\n    console.log(\"Stored original tab ID:\", tabId)\n  } catch (error) {\n    console.debug(\"Error storing original tab ID:\", error)\n  }\n}\n\n/**\n * Verifies that a tab exists and is accessible\n * @param {number} tabId - The tab ID to verify\n * @returns {Promise<boolean>} True if tab exists and is accessible\n */\nexport async function verifyTabExists(tabId) {\n  if (!tabId) return false\n\n  try {\n    return new Promise((resolve) => {\n      chrome.tabs.get(Number.parseInt(tabId, 10), (tab) => {\n        if (chrome.runtime.lastError) {\n          console.debug(`Tab verification failed for ID ${tabId}:`, chrome.runtime.lastError.message)\n          resolve(false)\n        } else {\n          console.log(`Tab ${tabId} verified:`, tab.url)\n          resolve(true)\n        }\n      })\n    })\n  } catch (error) {\n    console.debug(\"Exception during tab verification:\", error)\n    return false\n  }\n}\n\n/**\n * Detects if we're in detached mode by checking URL parameters\n * @returns {boolean} True if in detached mode\n */\nfunction isDetachedMode() {\n  const urlParams = new URLSearchParams(window.location.search)\n  const hasOriginalTabId = urlParams.has(\"originalTabId\")\n  console.log(\"Detached mode detection:\", hasOriginalTabId, \"URL:\", window.location.href)\n  return hasOriginalTabId\n}\n\n/**\n * Gets the target tab ID for messaging, automatically detecting attached vs detached mode\n * @returns {Promise<number|null>} Tab ID or null if not available\n */\nexport async function getTargetTabId() {\n  try {\n    const detachedMode = isDetachedMode()\n    console.log(\"getTargetTabId called, detached mode:\", detachedMode)\n\n    if (detachedMode) {\n      // In detached mode, use the original bound tab ID\n      const originalTabId = await getOriginalTabIdFromUrl()\n      console.log(\"Detached mode - original tab ID:\", originalTabId)\n\n      if (originalTabId) {\n        // Verify the tab still exists\n        const tabExists = await verifyTabExists(originalTabId)\n        if (tabExists) {\n          console.log(\"Using bound original tab ID for detached mode:\", originalTabId)\n          return originalTabId\n        } else {\n          console.log(\"Bound original tab no longer exists:\", originalTabId)\n          return null\n        }\n      }\n\n      console.log(\"No bound tab ID available in detached mode\")\n      return null\n    }\n\n    // In attached mode, get the current active tab\n    console.log(\"Attached mode - getting current active tab\")\n    return new Promise((resolve) => {\n      chrome.tabs.query({ active: true, currentWindow: true }, (activeTabs) => {\n        if (chrome.runtime.lastError || !activeTabs || activeTabs.length === 0) {\n          console.log(\"No active tabs found in attached mode\")\n          resolve(null)\n          return\n        }\n\n        const tabId = activeTabs[0].id\n        console.log(\"Using current active tab ID for attached mode:\", tabId)\n        resolve(tabId)\n      })\n    })\n  } catch (error) {\n    console.debug(\"Error getting target tab ID:\", error)\n    return null\n  }\n}\n\n/**\n * Sends a message to a content script with error handling\n * @param {number} tabId - The tab ID to send the message to\n * @param {Object} message - The message to send\n * @returns {Promise<Object|null>} Response from content script or null if failed\n */\nexport async function sendMessageToContentScript(tabId, message) {\n  if (!tabId) {\n    console.error(\"Cannot send message: No tab ID provided\")\n    return null\n  }\n\n  try {\n    return new Promise((resolve) => {\n      chrome.tabs.sendMessage(Number.parseInt(tabId, 10), message, (response) => {\n        if (chrome.runtime.lastError) {\n          console.error(`Error sending message to tab ${tabId}:`, chrome.runtime.lastError.message)\n          resolve(null)\n        } else {\n          console.log(`Message sent successfully to tab ${tabId}:`, message.action)\n          resolve(response)\n        }\n      })\n    })\n  } catch (error) {\n    console.error(\"Exception when sending message to content script:\", error)\n    return null\n  }\n}\n\n/**\n * Shows minimal visual feedback on an element\n * @param {HTMLElement} element - The element to show feedback on\n * @param {string} type - The feedback type ('success', 'error')\n * @param {number} duration - Duration in milliseconds\n */\nexport function showElementFeedback(element, type = \"success\", duration = 1000) {\n  if (!element) return\n\n  const originalTransform = element.style.transform\n  const originalTransition = element.style.transition\n\n  // Add subtle visual feedback\n  element.style.transition = \"transform 0.1s ease\"\n  element.style.transform = \"scale(0.95)\"\n\n  setTimeout(() => {\n    element.style.transform = \"scale(1)\"\n\n    setTimeout(() => {\n      element.style.transform = originalTransform\n      element.style.transition = originalTransition\n    }, 100)\n  }, 50)\n}\n\n// Legacy function names for compatibility (now just do minimal feedback)\n\n/**\n * Refreshes the original tab ID in storage to maintain connection\n * @param {number} tabId - The tab ID to store\n * @returns {Promise<boolean>} Success status\n */\nexport async function refreshOriginalTabId(tabId) {\n  try {\n    if (!tabId) return false\n\n    // Verify the tab still exists before storing\n    const tabExists = await verifyTabExists(tabId)\n    if (!tabExists) return false\n\n    // Store the tab ID\n    await setOriginalTabId(tabId)\n    console.log(\"Refreshed original tab ID:\", tabId)\n    return true\n  } catch (error) {\n    console.debug(\"Error refreshing original tab ID:\", error)\n    return false\n  }\n}\n\n/**\n * Gets the current active tab ID\n * @returns {Promise<number|null>} Current active tab ID or null\n */\nexport async function getCurrentActiveTabId() {\n  try {\n    return new Promise((resolve) => {\n      chrome.tabs.query({ active: true, lastFocusedWindow: true }, (tabs) => {\n        if (chrome.runtime.lastError || !tabs || tabs.length === 0) {\n          console.debug(\"No active tab found\")\n          resolve(null)\n          return\n        }\n        const tabId = tabs[0].id\n        console.log(\"Current active tab ID:\", tabId, \"URL:\", tabs[0].url)\n        resolve(tabId)\n      })\n    })\n  } catch (error) {\n    console.debug(\"Error getting current active tab ID:\", error)\n    return null\n  }\n}\n","/**\n * Professional toast notification system\n */\n\n// Toast container and configuration\nlet toastContainer = null\nlet toastCounter = 0\n\nconst TOAST_TYPES = {\n  SUCCESS: \"success\",\n  ERROR: \"error\",\n  WARNING: \"warning\",\n  INFO: \"info\",\n}\n\nconst TOAST_CONFIG = {\n  duration: {\n    success: 2500,\n    error: 4000,\n    warning: 3000,\n    info: 2500,\n  },\n  maxToasts: 3,\n  position: \"top-center\", // Changed to top-center for better positioning\n}\n\n/**\n * Initialize the toast container\n */\nfunction initializeToastContainer() {\n  if (toastContainer) return\n\n  toastContainer = document.createElement(\"div\")\n  toastContainer.id = \"toast-container\"\n  toastContainer.className = `toast-container toast-${TOAST_CONFIG.position}`\n\n  // Add container styles\n  toastContainer.style.cssText = `\n    position: fixed;\n    z-index: 10000;\n    pointer-events: none;\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n    max-width: 320px;\n    padding: 8px;\n  `\n\n  // Position the container\n  switch (TOAST_CONFIG.position) {\n    case \"top-center\":\n      toastContainer.style.top = \"8px\"\n      toastContainer.style.left = \"50%\"\n      toastContainer.style.transform = \"translateX(-50%)\"\n      break\n    case \"top-right\":\n      toastContainer.style.top = \"8px\"\n      toastContainer.style.right = \"8px\"\n      break\n    case \"top-left\":\n      toastContainer.style.top = \"8px\"\n      toastContainer.style.left = \"8px\"\n      break\n    case \"bottom-right\":\n      toastContainer.style.bottom = \"8px\"\n      toastContainer.style.right = \"8px\"\n      toastContainer.style.flexDirection = \"column-reverse\"\n      break\n    case \"bottom-left\":\n      toastContainer.style.bottom = \"8px\"\n      toastContainer.style.left = \"8px\"\n      toastContainer.style.flexDirection = \"column-reverse\"\n      break\n  }\n\n  document.body.appendChild(toastContainer)\n}\n\n/**\n * Create a toast notification\n * @param {string} message - The message to display\n * @param {string} type - The type of toast (success, error, warning, info)\n * @param {Object} options - Additional options\n * @returns {HTMLElement} The toast element\n */\nfunction createToast(message, type = TOAST_TYPES.INFO, options = {}) {\n  initializeToastContainer()\n\n  const toastId = `toast-${++toastCounter}`\n  const duration = options.duration || TOAST_CONFIG.duration[type]\n  const dismissible = options.dismissible !== false\n  const compact = options.compact !== false // Default to compact\n\n  // Create toast element\n  const toast = document.createElement(\"div\")\n  toast.id = toastId\n  toast.className = `toast toast-${type} ${compact ? \"toast-compact\" : \"\"}`\n  toast.style.pointerEvents = \"auto\"\n\n  // Get icon for toast type\n  const icon = getToastIcon(type)\n\n  // Create compact toast content\n  if (compact) {\n    toast.innerHTML = `\n      <div class=\"toast-content-compact\">\n        <div class=\"toast-icon-compact\">${icon}</div>\n        <div class=\"toast-message-compact\">${message}</div>\n        ${dismissible ? '<button class=\"toast-dismiss-compact\" aria-label=\"Dismiss\"></button>' : \"\"}\n      </div>\n      <div class=\"toast-progress-compact\"></div>\n    `\n  } else {\n    // Keep original layout for non-compact toasts\n    toast.innerHTML = `\n      <div class=\"toast-content\">\n        <div class=\"toast-icon\">${icon}</div>\n        <div class=\"toast-message\">${message}</div>\n        ${dismissible ? '<button class=\"toast-dismiss\" aria-label=\"Dismiss\">&times;</button>' : \"\"}\n      </div>\n      <div class=\"toast-progress\"></div>\n    `\n  }\n\n  // Add event listeners\n  if (dismissible) {\n    const dismissBtn = toast.querySelector(compact ? \".toast-dismiss-compact\" : \".toast-dismiss\")\n    dismissBtn.addEventListener(\"click\", () => dismissToast(toast))\n  }\n\n  // Add to container\n  toastContainer.appendChild(toast)\n\n  // Trigger entrance animation\n  requestAnimationFrame(() => {\n    toast.classList.add(\"toast-show\")\n  })\n\n  // Auto dismiss\n  if (duration > 0) {\n    const progressBar = toast.querySelector(compact ? \".toast-progress-compact\" : \".toast-progress\")\n\n    // Animate progress bar\n    progressBar.style.animation = `toast-progress ${duration}ms linear`\n\n    setTimeout(() => {\n      dismissToast(toast)\n    }, duration)\n  }\n\n  // Limit number of toasts\n  limitToasts()\n\n  return toast\n}\n\n/**\n * Dismiss a toast notification\n * @param {HTMLElement} toast - The toast element to dismiss\n */\nfunction dismissToast(toast) {\n  if (!toast || !toast.parentNode) return\n\n  toast.classList.add(\"toast-hide\")\n\n  setTimeout(() => {\n    if (toast.parentNode) {\n      toast.parentNode.removeChild(toast)\n    }\n  }, 300) // Match animation duration\n}\n\n/**\n * Limit the number of visible toasts\n */\nfunction limitToasts() {\n  const toasts = toastContainer.querySelectorAll(\".toast\")\n  if (toasts.length > TOAST_CONFIG.maxToasts) {\n    const oldestToast = toasts[0]\n    dismissToast(oldestToast)\n  }\n}\n\n/**\n * Get icon for toast type\n * @param {string} type - Toast type\n * @returns {string} SVG icon\n */\nfunction getToastIcon(type) {\n  const icons = {\n    success: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"></path>\n      <polyline points=\"22,4 12,14.01 9,11.01\"></polyline>\n    </svg>`,\n    error: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n      <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line>\n      <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line>\n    </svg>`,\n    warning: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <path d=\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\"></path>\n      <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line>\n      <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line>\n    </svg>`,\n    info: `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n      <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line>\n      <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line>\n    </svg>`,\n  }\n  return icons[type] || icons.info\n}\n\n/**\n * Show success toast\n * @param {string} message - Success message\n * @param {Object} options - Additional options\n */\nexport function showSuccessToast(message, options = {}) {\n  return createToast(message, TOAST_TYPES.SUCCESS, options)\n}\n\n/**\n * Show error toast\n * @param {string} message - Error message\n * @param {Object} options - Additional options\n */\nexport function showErrorToast(message, options = {}) {\n  return createToast(message, TOAST_TYPES.ERROR, options)\n}\n\n/**\n * Show warning toast\n * @param {string} message - Warning message\n * @param {Object} options - Additional options\n */\nexport function showWarningToast(message, options = {}) {\n  return createToast(message, TOAST_TYPES.WARNING, options)\n}\n\n/**\n * Show info toast\n * @param {string} message - Info message\n * @param {Object} options - Additional options\n */\nexport function showInfoToast(message, options = {}) {\n  return createToast(message, TOAST_TYPES.INFO, options)\n}\n\n/**\n * Show toast with action button\n * @param {string} message - Toast message\n * @param {string} type - Toast type\n * @param {Object} action - Action configuration\n * @param {Object} options - Additional options\n */\nexport function showActionToast(message, type, action, options = {}) {\n  return createToast(message, type, { ...options, action })\n}\n\n/**\n * Clear all toasts\n */\nexport function clearAllToasts() {\n  if (!toastContainer) return\n\n  const toasts = toastContainer.querySelectorAll(\".toast\")\n  toasts.forEach((toast) => dismissToast(toast))\n}\n\n/**\n * Configure toast system\n * @param {Object} config - Configuration options\n */\nexport function configureToasts(config) {\n  Object.assign(TOAST_CONFIG, config)\n}\n\n// Export types for convenience\nexport { TOAST_TYPES }\n","/**\n * Simplified PSI Insights Renderer\n * Renders PageSpeed Insights data with minimal DOM structure\n */\n\nexport class InsightsRenderer {\n  constructor() {\n    this.expandedInsights = new Set()\n    this.activeTooltip = null\n  }\n\n  /**\n   * Render the complete PSI insights interface\n   */\n  renderInsights(container, insights) {\n    if (!container) {\n      console.error(\"InsightsRenderer: Container element not found\")\n      return\n    }\n\n    // Clear existing content\n    container.innerHTML = \"\"\n\n    if (!insights || !Array.isArray(insights) || insights.length === 0) {\n      this.renderEmptyState(container)\n      return\n    }\n\n    // Render header directly to container\n    const header = this.renderHeader(insights.length)\n    container.appendChild(header)\n\n    // Render insights directly to container\n    insights.forEach((insight, index) => {\n      const item = this.renderInsightItem(insight, index)\n      container.appendChild(item)\n    })\n\n    // Initialize tooltip system after rendering\n    this.initializeTooltips()\n  }\n\n  /**\n   * Initialize smart tooltip system with proper cleanup\n   */\n  initializeTooltips() {\n    // Clean up any existing tooltips and listeners\n    this.cleanupTooltips()\n\n    // Add event listeners to all tooltip triggers\n    document.querySelectorAll(\".tooltip-trigger\").forEach((trigger) => {\n      trigger.addEventListener(\"mouseenter\", (e) => this.showTooltip(e))\n      trigger.addEventListener(\"mouseleave\", (e) => this.hideTooltip(e))\n      trigger.addEventListener(\"mousemove\", (e) => this.updateTooltipPosition(e))\n    })\n  }\n\n  /**\n   * Clean up all tooltips and prevent clustering\n   */\n  cleanupTooltips() {\n    // Remove all existing tooltips\n    document.querySelectorAll(\".smart-tooltip\").forEach((tooltip) => tooltip.remove())\n    this.activeTooltip = null\n  }\n\n  /**\n   * Show smart positioned tooltip with clustering prevention\n   */\n  showTooltip(event) {\n    // Prevent multiple tooltips\n    this.cleanupTooltips()\n\n    const trigger = event.target\n    const tooltipText = trigger.getAttribute(\"data-tooltip\")\n\n    if (!tooltipText) return\n\n    // Create tooltip element\n    const tooltip = document.createElement(\"div\")\n    tooltip.className = \"smart-tooltip\"\n    tooltip.textContent = tooltipText\n    document.body.appendChild(tooltip)\n\n    // Store reference\n    this.activeTooltip = tooltip\n    trigger._tooltip = tooltip\n\n    // Position tooltip\n    this.positionTooltip(trigger, tooltip)\n  }\n\n  /**\n   * Position tooltip intelligently\n   */\n  positionTooltip(trigger, tooltip) {\n    const triggerRect = trigger.getBoundingClientRect()\n    const tooltipRect = tooltip.getBoundingClientRect()\n    const viewportWidth = window.innerWidth\n    const viewportHeight = window.innerHeight\n    const padding = 16\n\n    // Calculate initial position (below trigger)\n    let left = triggerRect.left\n    let top = triggerRect.bottom + 8\n\n    // Adjust horizontal position if tooltip would overflow\n    if (left + tooltipRect.width > viewportWidth - padding) {\n      left = viewportWidth - tooltipRect.width - padding\n    }\n    if (left < padding) {\n      left = padding\n    }\n\n    // Adjust vertical position if tooltip would overflow\n    if (top + tooltipRect.height > viewportHeight - padding) {\n      top = triggerRect.top - tooltipRect.height - 8\n    }\n    if (top < padding) {\n      top = triggerRect.bottom + 8 // Fallback to below\n    }\n\n    // Apply position with smooth animation\n    tooltip.style.left = `${left}px`\n    tooltip.style.top = `${top}px`\n    tooltip.style.opacity = \"1\"\n    tooltip.style.transform = \"translateY(0)\"\n  }\n\n  /**\n   * Update tooltip position on mouse move (for better tracking)\n   */\n  updateTooltipPosition(event) {\n    if (!this.activeTooltip) return\n\n    const trigger = event.target\n    this.positionTooltip(trigger, this.activeTooltip)\n  }\n\n  /**\n   * Hide tooltip with proper cleanup\n   */\n  hideTooltip(event) {\n    const trigger = event.target\n    if (trigger._tooltip) {\n      trigger._tooltip.remove()\n      trigger._tooltip = null\n    }\n    if (this.activeTooltip) {\n      this.activeTooltip.remove()\n      this.activeTooltip = null\n    }\n  }\n\n  /**\n   * Render the insights header with count\n   */\n  renderHeader(count) {\n    const header = document.createElement(\"div\")\n    header.className = \"psi-insights-header\"\n\n    const title = document.createElement(\"h3\")\n    title.className = \"section-title\"\n    title.textContent = \"Performance Insights\"\n\n    const countBadge = document.createElement(\"span\")\n    countBadge.className = \"insights-count\"\n    countBadge.textContent = `${count} insights`\n\n    header.appendChild(title)\n    header.appendChild(countBadge)\n\n    return header\n  }\n\n  /**\n   * Render individual insight item - simplified without icons\n   */\n  renderInsightItem(insight, index) {\n    const item = document.createElement(\"div\")\n\n    // Determine status based on score instead of hardcoding\n    const statusClass = this.determineInsightStatus(insight)\n    item.className = `psi-insight-item ${statusClass}`\n\n    // Create header\n    const header = this.renderInsightHeader(insight, index)\n    item.appendChild(header)\n\n    // Create content (initially hidden)\n    const content = this.renderInsightContent(insight)\n    item.appendChild(content)\n\n    return item\n  }\n\n  /**\n   * Determine insight status based on category and score\n   */\n  determineInsightStatus(insight) {\n    // First check if insight has a category from the API\n    if (insight.category) {\n      switch (insight.category) {\n        case \"failed\":\n          return \"failed-insight\"\n        case \"warning\":\n          return \"warning-insight\"\n        default:\n          return \"unknown-insight\"\n      }\n    }\n\n    // Fallback to score-based determination if no category\n    if (insight.score === undefined || insight.score === null) {\n      return \"unknown-insight\"\n    }\n\n    const score = Number.parseFloat(insight.score)\n\n    // PSI scoring: 0-0.49 = failed, 0.5-0.89 = warning\n    if (score < 0.5) {\n      return \"failed-insight\"\n    } else if (score < 0.9) {\n      return \"warning-insight\"\n    } else {\n      return \"unknown-insight\"\n    }\n  }\n\n  /**\n   * Render insight header (clickable) - simplified without icons\n   */\n  renderInsightHeader(insight, index) {\n    const header = document.createElement(\"div\")\n    header.className = \"insight-header\"\n    header.setAttribute(\"role\", \"button\")\n    header.setAttribute(\"tabindex\", \"0\")\n    header.setAttribute(\"aria-expanded\", \"false\")\n\n    // Title only (no icon)\n    const title = document.createElement(\"div\")\n    title.className = \"insight-title\"\n    title.textContent = this.formatInsightTitle(insight.title || insight.id)\n\n    // Expand icon\n    const expandIcon = document.createElement(\"div\")\n    expandIcon.className = \"insight-expand-icon\"\n    expandIcon.innerHTML = `\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                <polyline points=\"6,9 12,15 18,9\"></polyline>\n            </svg>\n        `\n\n    header.appendChild(title)\n    header.appendChild(expandIcon)\n\n    // Add click handler\n    header.addEventListener(\"click\", () => this.toggleInsight(header.parentElement, index))\n    header.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Enter\" || e.key === \" \") {\n        e.preventDefault()\n        this.toggleInsight(header.parentElement, index)\n      }\n    })\n\n    return header\n  }\n\n  /**\n   * Render insight content with support for different detail types\n   */\n  renderInsightContent(insight) {\n    console.log(\"Rendering insight content for:\", insight.title || insight.id, insight)\n\n    const content = document.createElement(\"div\")\n    content.className = \"insight-content\"\n\n    // Add description if available\n    if (insight.description) {\n      const description = this.renderDescription(insight.description)\n      content.appendChild(description)\n    }\n\n    // Special handling for network dependency tree\n    if (insight.id === \"network-dependency-tree-insight\" || insight.id === \"critical-request-chains\") {\n      console.log(\"Detected network dependency tree insight\")\n      const networkTree = this.renderNetworkDependencyFromAPI(insight)\n      content.appendChild(networkTree)\n      return content\n    }\n\n    // Handle different types of details\n    if (insight.details) {\n      console.log(\"Processing insight details:\", insight.details)\n\n      if (insight.details.type === \"network-tree\") {\n        console.log(\"Rendering network tree for:\", insight.title)\n        const networkTree = this.renderNetworkTree(insight.details)\n        content.appendChild(networkTree)\n      } else if (insight.details.items) {\n        console.log(\"Rendering details items for:\", insight.title)\n        const detailsContainer = this.renderDetails(insight.details, insight)\n        if (detailsContainer.children.length > 0) {\n          content.appendChild(detailsContainer)\n        }\n      } else {\n        console.log(\"Unknown details structure for:\", insight.title, insight.details)\n        // Show raw details structure for debugging\n        const debugContainer = document.createElement(\"div\")\n        debugContainer.className = \"debug-details\"\n        debugContainer.innerHTML = `<pre style=\"font-size: 10px; max-height: 150px; overflow: auto;\">${JSON.stringify(insight.details, null, 2)}</pre>`\n        content.appendChild(debugContainer)\n      }\n    } else {\n      console.log(\"No details found for:\", insight.title)\n      // Show a minimal \"no data\" message if no details\n      const noData = document.createElement(\"div\")\n      noData.className = \"no-data-message\"\n      noData.textContent = \"No detailed data available\"\n      content.appendChild(noData)\n    }\n\n    return content\n  }\n\n  /**\n   * Render network dependency tree from API response structure\n   */\n  renderNetworkDependencyFromAPI(insight) {\n    console.log(\"Rendering network dependency tree from API:\", insight)\n\n    const container = document.createElement(\"div\")\n    container.className = \"network-dependency-container\"\n\n    // Extract chains data from the API structure\n    let chainsData = null\n    let longestChain = null\n\n    if (insight.details && insight.details.items && insight.details.items.length > 0) {\n      const firstItem = insight.details.items[0]\n      if (firstItem.value && firstItem.value.chains) {\n        chainsData = firstItem.value.chains\n        longestChain = firstItem.value.longestChain\n        console.log(\"Found chains data:\", chainsData)\n      }\n    }\n\n    if (chainsData && Object.keys(chainsData).length > 0) {\n      // Show summary info\n      const summary = document.createElement(\"div\")\n      summary.className = \"network-summary\"\n\n      const chainCount = Object.keys(chainsData).length\n\n      summary.innerHTML = `\n        <div class=\"summary-item\">\n          <span class=\"summary-label\">Critical chains:</span>\n          <span class=\"summary-value\">${chainCount}</span>\n        </div>\n        ${\n          longestChain && longestChain.duration\n            ? `\n        <div class=\"summary-item\">\n          <span class=\"summary-label\">Longest chain:</span>\n          <span class=\"summary-value\">${Math.round(longestChain.duration)}ms</span>\n        </div>\n        `\n            : \"\"\n        }\n      `\n      container.appendChild(summary)\n\n      // Render each chain\n      const chainsContainer = document.createElement(\"div\")\n      chainsContainer.className = \"critical-chains\"\n\n      Object.entries(chainsData).forEach(([chainId, chain], index) => {\n        const chainHeader = document.createElement(\"div\")\n        chainHeader.className = \"chain-header\"\n        chainHeader.textContent = `Chain ${index + 1}`\n        chainsContainer.appendChild(chainHeader)\n\n        const chainTree = this.renderAPIChain(chain, 0)\n        chainsContainer.appendChild(chainTree)\n      })\n\n      container.appendChild(chainsContainer)\n    } else {\n      // No chains data found\n      const noChains = document.createElement(\"div\")\n      noChains.className = \"no-chains-message\"\n      noChains.textContent = \"No critical request chains detected\"\n      container.appendChild(noChains)\n    }\n\n    return container\n  }\n\n  /**\n   * Render a chain from the API response structure\n   */\n  renderAPIChain(chain, depth) {\n    const chainElement = document.createElement(\"div\")\n    chainElement.className = `critical-chain-item depth-${depth}`\n\n    // Create the main item\n    const itemElement = document.createElement(\"div\")\n    itemElement.className = \"chain-item\"\n\n    // Add indentation\n    const indent = document.createElement(\"div\")\n    indent.className = \"chain-indent\"\n    indent.style.width = `${depth * 16}px`\n\n    if (depth > 0) {\n      indent.innerHTML = \" \"\n    }\n\n    // Extract URL info\n    const url = chain.url || \"Unknown URL\"\n    const filename = this.extractFilename(url)\n    const domain = this.extractDomain(url)\n\n    // Create URL display\n    const urlDisplay = document.createElement(\"div\")\n    urlDisplay.className = \"chain-url\"\n\n    const urlText = document.createElement(\"span\")\n    urlText.className = \"url-text tooltip-trigger\"\n    urlText.setAttribute(\"data-tooltip\", url)\n    urlText.textContent = filename\n\n    if (domain && !domain.includes(window.location.hostname)) {\n      const domainSpan = document.createElement(\"span\")\n      domainSpan.className = \"url-domain\"\n      domainSpan.textContent = ` (${domain})`\n      urlText.appendChild(domainSpan)\n    }\n\n    urlDisplay.appendChild(urlText)\n\n    // Add timing info\n    const timing = document.createElement(\"div\")\n    timing.className = \"chain-timing\"\n\n    const transferSize = chain.transferSize || 0\n    const duration = chain.navStartToEndTime || 0\n\n    timing.innerHTML = `\n      <span class=\"timing-size\">${this.formatBytes(transferSize)}</span>\n      <span class=\"timing-duration\">${Math.round(duration)}ms</span>\n    `\n\n    // Combine elements\n    itemElement.appendChild(indent)\n    itemElement.appendChild(urlDisplay)\n    itemElement.appendChild(timing)\n    chainElement.appendChild(itemElement)\n\n    // Render children recursively\n    if (chain.children && Object.keys(chain.children).length > 0) {\n      Object.values(chain.children).forEach((childChain) => {\n        const childElement = this.renderAPIChain(childChain, depth + 1)\n        chainElement.appendChild(childElement)\n      })\n    }\n\n    return chainElement\n  }\n\n  /**\n   * Render network dependency tree specifically for critical request chains\n   */\n  renderNetworkDependencyTree(insight) {\n    console.log(\"Rendering network dependency tree for critical request chains:\", insight)\n\n    const container = document.createElement(\"div\")\n    container.className = \"network-dependency-container\"\n\n    // Check if we have chains data\n    let chainsData = null\n\n    if (insight.details && insight.details.chains) {\n      chainsData = insight.details.chains\n    } else if (insight.details && insight.details.items) {\n      // Look for chains in items\n      for (const item of insight.details.items) {\n        if (item.chains) {\n          chainsData = item.chains\n          break\n        }\n      }\n    }\n\n    if (chainsData && Object.keys(chainsData).length > 0) {\n      // Show summary info\n      const summary = document.createElement(\"div\")\n      summary.className = \"network-summary\"\n\n      const chainCount = Object.keys(chainsData).length\n      const longestChain = this.findLongestChain(chainsData)\n\n      summary.innerHTML = `\n        <div class=\"summary-item\">\n          <span class=\"summary-label\">Critical chains:</span>\n          <span class=\"summary-value\">${chainCount}</span>\n        </div>\n        ${\n          longestChain\n            ? `\n        <div class=\"summary-item\">\n          <span class=\"summary-label\">Longest chain:</span>\n          <span class=\"summary-value\">${Math.round(longestChain.duration)}ms</span>\n        </div>\n        `\n            : \"\"\n        }\n      `\n      container.appendChild(summary)\n\n      // Render each chain\n      const chainsContainer = document.createElement(\"div\")\n      chainsContainer.className = \"critical-chains\"\n\n      Object.entries(chainsData).forEach(([chainId, chain], index) => {\n        const chainHeader = document.createElement(\"div\")\n        chainHeader.className = \"chain-header\"\n        chainHeader.textContent = `Chain ${index + 1}`\n        chainsContainer.appendChild(chainHeader)\n\n        const chainTree = this.renderCriticalChain(chain, 0)\n        chainsContainer.appendChild(chainTree)\n      })\n\n      container.appendChild(chainsContainer)\n    } else {\n      // No chains data found\n      const noChains = document.createElement(\"div\")\n      noChains.className = \"no-chains-message\"\n      noChains.textContent = \"No critical request chains detected\"\n      container.appendChild(noChains)\n    }\n\n    return container\n  }\n\n  /**\n   * Find the longest chain for summary display\n   */\n  findLongestChain(chainsData) {\n    let longest = null\n    let maxDuration = 0\n\n    Object.values(chainsData).forEach((chain) => {\n      const duration = this.calculateChainDuration(chain)\n      if (duration > maxDuration) {\n        maxDuration = duration\n        longest = { ...chain, duration }\n      }\n    })\n\n    return longest\n  }\n\n  /**\n   * Calculate total duration of a chain\n   */\n  calculateChainDuration(chain) {\n    let totalDuration = chain.transferSize || 0\n\n    if (chain.children) {\n      Object.values(chain.children).forEach((child) => {\n        totalDuration += this.calculateChainDuration(child)\n      })\n    }\n\n    return totalDuration\n  }\n\n  /**\n   * Render a critical request chain\n   */\n  renderCriticalChain(chain, depth) {\n    const chainElement = document.createElement(\"div\")\n    chainElement.className = `critical-chain-item depth-${depth}`\n\n    // Create the main item\n    const itemElement = document.createElement(\"div\")\n    itemElement.className = \"chain-item\"\n\n    // Add indentation\n    const indent = document.createElement(\"div\")\n    indent.className = \"chain-indent\"\n    indent.style.width = `${depth * 16}px`\n\n    if (depth > 0) {\n      indent.innerHTML = \" \"\n    }\n\n    // Extract URL info\n    const url = chain.request?.url || chain.url || \"Unknown URL\"\n    const filename = this.extractFilename(url)\n    const domain = this.extractDomain(url)\n\n    // Create URL display\n    const urlDisplay = document.createElement(\"div\")\n    urlDisplay.className = \"chain-url\"\n\n    const urlText = document.createElement(\"span\")\n    urlText.className = \"url-text tooltip-trigger\"\n    urlText.setAttribute(\"data-tooltip\", url)\n    urlText.textContent = filename\n\n    if (domain && !domain.includes(window.location.hostname)) {\n      const domainSpan = document.createElement(\"span\")\n      domainSpan.className = \"url-domain\"\n      domainSpan.textContent = ` (${domain})`\n      urlText.appendChild(domainSpan)\n    }\n\n    urlDisplay.appendChild(urlText)\n\n    // Add timing info\n    const timing = document.createElement(\"div\")\n    timing.className = \"chain-timing\"\n\n    const transferSize = chain.transferSize || 0\n    const duration = chain.responseReceivedTime - chain.startTime || 0\n\n    timing.innerHTML = `\n      <span class=\"timing-size\">${this.formatBytes(transferSize)}</span>\n      <span class=\"timing-duration\">${Math.round(duration)}ms</span>\n    `\n\n    // Combine elements\n    itemElement.appendChild(indent)\n    itemElement.appendChild(urlDisplay)\n    itemElement.appendChild(timing)\n    chainElement.appendChild(itemElement)\n\n    // Render children recursively\n    if (chain.children && Object.keys(chain.children).length > 0) {\n      Object.values(chain.children).forEach((childChain) => {\n        const childElement = this.renderCriticalChain(childChain, depth + 1)\n        chainElement.appendChild(childElement)\n      })\n    }\n\n    return chainElement\n  }\n\n  /**\n   * Render insight description with link formatting\n   */\n  renderDescription(description) {\n    const descContainer = document.createElement(\"div\")\n    descContainer.className = \"insight-description\"\n\n    // Convert markdown-style links to HTML links\n    const htmlDescription = description.replace(\n      /\\[([^\\]]+)\\]$$([^)]+)$$/g,\n      '<a href=\"$2\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"insight-link\">$1</a>',\n    )\n\n    descContainer.innerHTML = htmlDescription\n    return descContainer\n  }\n\n  /**\n   * Render details based on type\n   */\n  renderDetails(details, insight) {\n    const container = document.createElement(\"div\")\n    container.className = \"insight-details-container\"\n\n    if (!details.items || !Array.isArray(details.items)) {\n      console.log(\"No items array found in details:\", details)\n      return container\n    }\n\n    // Process items only once - find the first table-like structure\n    let tableRendered = false\n\n    for (const item of details.items) {\n      if (item.type === \"checklist\") {\n        const checklist = this.renderChecklist(item)\n        container.appendChild(checklist)\n      } else if (item.type === \"node\") {\n        const nodeInfo = this.renderNodeInfo(item)\n        container.appendChild(nodeInfo)\n      } else if (item.items && Array.isArray(item.items) && !tableRendered) {\n        // Only render the first table structure found\n        const table = this.renderDetailsTable({ items: item.items, headings: item.headings }, insight)\n        container.appendChild(table)\n        tableRendered = true\n      }\n    }\n\n    // Fallback: if no table was rendered, try extracting from details\n    if (!tableRendered && container.children.length === 0) {\n      const tableData = this.extractTableData(details)\n      if (tableData && tableData.items && tableData.items.length > 0) {\n        const table = this.renderDetailsTable(tableData, insight)\n        container.appendChild(table)\n      }\n    }\n\n    return container\n  }\n\n  /**\n   * Render checklist items with checkmarks and X marks\n   */\n  renderChecklist(checklistItem) {\n    const checklist = document.createElement(\"div\")\n    checklist.className = \"insight-checklist\"\n\n    if (!checklistItem.items || typeof checklistItem.items !== \"object\") {\n      return checklist\n    }\n\n    // Convert checklist items object to array for rendering\n    Object.entries(checklistItem.items).forEach(([key, item]) => {\n      const checklistRow = document.createElement(\"div\")\n      checklistRow.className = \"checklist-item\"\n\n      // Create icon based on value\n      const icon = document.createElement(\"div\")\n      icon.className = `checklist-icon ${item.value ? \"checklist-pass\" : \"checklist-fail\"}`\n\n      if (item.value) {\n        icon.innerHTML = `\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <polyline points=\"20,6 9,17 4,12\"></polyline>\n          </svg>\n        `\n      } else {\n        icon.innerHTML = `\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n          </svg>\n        `\n      }\n\n      // Create label\n      const label = document.createElement(\"div\")\n      label.className = \"checklist-label\"\n      label.textContent = item.label || key\n\n      checklistRow.appendChild(icon)\n      checklistRow.appendChild(label)\n      checklist.appendChild(checklistRow)\n    })\n\n    return checklist\n  }\n\n  /**\n   * Render node information\n   */\n  renderNodeInfo(nodeItem) {\n    const nodeContainer = document.createElement(\"div\")\n    nodeContainer.className = \"insight-node-info\"\n\n    if (nodeItem.snippet) {\n      const snippet = document.createElement(\"div\")\n      snippet.className = \"node-snippet\"\n      snippet.textContent = nodeItem.snippet\n      nodeContainer.appendChild(snippet)\n    }\n\n    if (nodeItem.selector) {\n      const selector = document.createElement(\"div\")\n      selector.className = \"node-selector\"\n      selector.textContent = `Selector: ${nodeItem.selector}`\n      nodeContainer.appendChild(selector)\n    }\n\n    if (nodeItem.nodeLabel) {\n      const label = document.createElement(\"div\")\n      label.className = \"node-label\"\n      label.textContent = nodeItem.nodeLabel\n      nodeContainer.appendChild(label)\n    }\n\n    return nodeContainer\n  }\n\n  /**\n   * Render network dependency tree - Fixed to handle PSI network tree structure\n   */\n  renderNetworkTree(details) {\n    console.log(\"Rendering network tree with details:\", details)\n\n    const treeContainer = document.createElement(\"div\")\n    treeContainer.className = \"network-tree-container\"\n\n    // Add maximum critical path latency if available\n    if (details.longestChain && details.longestChain.duration) {\n      const latencyInfo = document.createElement(\"div\")\n      latencyInfo.className = \"network-latency-info\"\n      latencyInfo.textContent = `Maximum critical path latency: ${details.longestChain.duration} ms`\n      treeContainer.appendChild(latencyInfo)\n    }\n\n    // Add initial navigation header\n    const navHeader = document.createElement(\"div\")\n    navHeader.className = \"network-nav-header\"\n    navHeader.textContent = \"Initial Navigation\"\n    treeContainer.appendChild(navHeader)\n\n    // Handle different possible structures for network tree data\n    let chainsData = null\n\n    // Check for chains in details directly\n    if (details.chains) {\n      chainsData = details.chains\n      console.log(\"Found chains in details.chains:\", chainsData)\n    }\n    // Check for chains in items array\n    else if (details.items && Array.isArray(details.items)) {\n      // Look for chains in the items array\n      for (const item of details.items) {\n        if (item.chains) {\n          chainsData = item.chains\n          console.log(\"Found chains in details.items[].chains:\", chainsData)\n          break\n        }\n        // Sometimes the entire item is the chain data\n        if (item.url && (item.children || item.transferSize)) {\n          // Convert single item to chains format\n          chainsData = { 0: item }\n          console.log(\"Converted single item to chains format:\", chainsData)\n          break\n        }\n      }\n\n      // If no chains found but we have items, try to render as a simple list\n      if (!chainsData && details.items.length > 0) {\n        console.log(\"No chains found, rendering items as simple list\")\n        const simpleList = this.renderNetworkSimpleList(details.items)\n        treeContainer.appendChild(simpleList)\n        return treeContainer\n      }\n    }\n\n    // Render the dependency chains if we found them\n    if (chainsData && typeof chainsData === \"object\") {\n      const chainsContainer = document.createElement(\"div\")\n      chainsContainer.className = \"network-chains\"\n\n      Object.entries(chainsData).forEach(([chainId, chain]) => {\n        console.log(`Rendering chain ${chainId}:`, chain)\n        const chainElement = this.renderNetworkChain(chain, 0)\n        chainsContainer.appendChild(chainElement)\n      })\n\n      treeContainer.appendChild(chainsContainer)\n    } else {\n      console.log(\"No valid chains data found, showing debug info\")\n      // Show debug information\n      const debugInfo = document.createElement(\"div\")\n      debugInfo.className = \"network-debug\"\n      debugInfo.innerHTML = `\n        <div>Network tree structure not recognized:</div>\n        <pre style=\"font-size: 8px; max-height: 200px; overflow: auto;\">${JSON.stringify(details, null, 2)}</pre>\n      `\n      treeContainer.appendChild(debugInfo)\n    }\n\n    return treeContainer\n  }\n\n  /**\n   * Render network items as a simple list when chain structure is not available\n   */\n  renderNetworkSimpleList(items) {\n    const listContainer = document.createElement(\"div\")\n    listContainer.className = \"network-simple-list\"\n\n    items.forEach((item, index) => {\n      const itemElement = document.createElement(\"div\")\n      itemElement.className = \"network-list-item\"\n\n      // Extract URL and basic info\n      const url = item.url || item.href || \"Unknown URL\"\n      const filename = this.extractFilename(url)\n      const domain = this.extractDomain(url)\n\n      // Create display\n      const urlDisplay = document.createElement(\"div\")\n      urlDisplay.className = \"network-url-display\"\n      urlDisplay.textContent = filename\n\n      if (domain && !domain.includes(window.location.hostname)) {\n        const domainSpan = document.createElement(\"span\")\n        domainSpan.className = \"network-domain\"\n        domainSpan.textContent = ` (${domain})`\n        urlDisplay.appendChild(domainSpan)\n      }\n\n      // Add timing/size info if available\n      const metaInfo = document.createElement(\"div\")\n      metaInfo.className = \"network-meta\"\n\n      const parts = []\n      if (item.transferSize) parts.push(this.formatBytes(item.transferSize))\n      if (item.duration) parts.push(`${item.duration}ms`)\n      if (item.startTime) parts.push(`@${item.startTime}ms`)\n\n      if (parts.length > 0) {\n        metaInfo.textContent = parts.join(\", \")\n      }\n\n      itemElement.appendChild(urlDisplay)\n      if (metaInfo.textContent) {\n        itemElement.appendChild(metaInfo)\n      }\n\n      listContainer.appendChild(itemElement)\n    })\n\n    return listContainer\n  }\n\n  /**\n   * Render individual network chain with proper indentation\n   */\n  renderNetworkChain(chain, depth) {\n    if (!chain || typeof chain !== \"object\") {\n      console.log(\"Invalid chain data:\", chain)\n      return document.createElement(\"div\")\n    }\n\n    const chainElement = document.createElement(\"div\")\n    chainElement.className = `network-chain-item depth-${depth}`\n\n    // Create the main item\n    const itemElement = document.createElement(\"div\")\n    itemElement.className = \"network-item\"\n\n    // Add tree connector\n    const connector = document.createElement(\"div\")\n    connector.className = \"tree-connector\"\n    connector.style.marginLeft = `${depth * 20}px`\n\n    // Add connector lines based on depth\n    if (depth > 0) {\n      connector.innerHTML = \" \"\n    }\n\n    // Extract filename and domain\n    const url = chain.url || chain.href || \"Unknown\"\n    const filename = this.extractFilename(url)\n    const domain = this.extractDomain(url)\n\n    // Create URL display\n    const urlDisplay = document.createElement(\"span\")\n    urlDisplay.className = \"network-url\"\n\n    // Color code by domain\n    if (domain && domain.includes(\"mediavine.com\")) {\n      urlDisplay.classList.add(\"mediavine-domain\")\n    } else if (domain && domain.includes(\"googlesyndication.com\")) {\n      urlDisplay.classList.add(\"third-party\")\n    } else {\n      urlDisplay.classList.add(\"main-domain\")\n    }\n\n    // Truncate long filenames\n    const displayName = filename.length > 50 ? `...${filename.slice(-47)}` : filename\n    urlDisplay.textContent = displayName\n\n    // Add domain in parentheses if different from main\n    if (domain && !domain.includes(window.location.hostname)) {\n      const domainSpan = document.createElement(\"span\")\n      domainSpan.className = \"network-domain\"\n      domainSpan.textContent = ` (${domain})`\n      urlDisplay.appendChild(domainSpan)\n    }\n\n    // Add timing and size info\n    const metaInfo = document.createElement(\"span\")\n    metaInfo.className = \"network-meta\"\n\n    const timing = chain.navStartToEndTime || chain.duration || chain.endTime\n    const timingText = timing ? `${Math.round(timing)} ms` : \"N/A\"\n    const size = chain.transferSize ? this.formatBytes(chain.transferSize) : \"N/A\"\n\n    metaInfo.innerHTML = ` - <span class=\"network-timing\">${timingText}</span>, <span class=\"network-size\">${size}</span>`\n\n    // Combine elements\n    itemElement.appendChild(connector)\n    itemElement.appendChild(urlDisplay)\n    itemElement.appendChild(metaInfo)\n\n    chainElement.appendChild(itemElement)\n\n    // Render children recursively\n    if (chain.children && typeof chain.children === \"object\" && Object.keys(chain.children).length > 0) {\n      Object.entries(chain.children).forEach(([childId, childChain]) => {\n        const childElement = this.renderNetworkChain(childChain, depth + 1)\n        chainElement.appendChild(childElement)\n      })\n    }\n\n    return chainElement\n  }\n\n  /**\n   * Extract table data from PSI nested structure\n   */\n  extractTableData(details) {\n    if (!details) return null\n\n    // Handle PSI nested structure: details.items[0].items contains the actual data\n    if (details.items && Array.isArray(details.items) && details.items.length > 0) {\n      // Look for the first item that has table-like structure\n      for (const item of details.items) {\n        if (item.items && Array.isArray(item.items) && item.items.length > 0) {\n          // Check if this looks like table data (not checklist or node)\n          if (item.type !== \"checklist\" && item.type !== \"node\") {\n            return {\n              headings: item.headings || details.headings || [],\n              items: item.items,\n            }\n          }\n        }\n      }\n\n      // Fallback: use details.items directly if no nested structure found\n      const nonSpecialItems = details.items.filter(\n        (item) => item.type !== \"checklist\" && item.type !== \"node\" && !item.items,\n      )\n\n      if (nonSpecialItems.length > 0) {\n        return {\n          headings: details.headings || [],\n          items: nonSpecialItems,\n        }\n      }\n    }\n\n    return null\n  }\n\n  /**\n   * Render details table for insight data\n   */\n  renderDetailsTable(details, insight) {\n    const table = document.createElement(\"table\")\n    table.className = \"insight-table\"\n\n    // Create header\n    const thead = document.createElement(\"thead\")\n    const headerRow = document.createElement(\"tr\")\n\n    if (details.headings && details.headings.length > 0) {\n      details.headings.forEach((heading, index) => {\n        const th = document.createElement(\"th\")\n        // Safely extract string value from heading object\n        let headingText = \"Column\"\n        if (typeof heading === \"string\") {\n          headingText = heading\n        } else if (heading && typeof heading === \"object\") {\n          headingText = heading.label || heading.text || heading.key || \"Column\"\n        }\n\n        th.textContent = this.formatHeading(headingText)\n\n        // Add alignment classes based on column type\n        if (index === 0) {\n          th.classList.add(\"url-column\")\n        } else if (this.isNumericColumn(headingText)) {\n          th.classList.add(\"numeric-column\")\n        }\n\n        headerRow.appendChild(th)\n      })\n    } else {\n      // Default headers for forced reflow data\n      const sourceHeader = document.createElement(\"th\")\n      sourceHeader.textContent = \"Source\"\n      sourceHeader.classList.add(\"url-column\")\n      const timeHeader = document.createElement(\"th\")\n      timeHeader.textContent = \"Reflow Time\"\n      timeHeader.classList.add(\"numeric-column\")\n      headerRow.appendChild(sourceHeader)\n      headerRow.appendChild(timeHeader)\n    }\n\n    thead.appendChild(headerRow)\n    table.appendChild(thead)\n\n    // Create body\n    const tbody = document.createElement(\"tbody\")\n    details.items.forEach((item) => {\n      const row = this.renderTableRow(item, details.headings, insight)\n      tbody.appendChild(row)\n    })\n\n    table.appendChild(tbody)\n    return table\n  }\n\n  /**\n   * Check if a column should be treated as numeric\n   */\n  isNumericColumn(headingText) {\n    const numericKeywords = [\"transfer\", \"savings\", \"time\", \"size\", \"bytes\", \"ms\", \"kb\", \"mb\", \"duration\", \"score\"]\n    return numericKeywords.some((keyword) => headingText.toLowerCase().includes(keyword))\n  }\n\n  /**\n   * Render table row for insight item\n   */\n  renderTableRow(item, headings, insight) {\n    const row = document.createElement(\"tr\")\n\n    if (headings && headings.length > 0) {\n      headings.forEach((heading, index) => {\n        const td = document.createElement(\"td\")\n        // Safely extract key from heading object\n        let key = \"unknown\"\n        if (typeof heading === \"string\") {\n          key = heading\n        } else if (heading && typeof heading === \"object\") {\n          key = heading.key || heading.text || heading.label || \"unknown\"\n        }\n        const value = item[key]\n\n        // Apply column-specific styling\n        if (index === 0) {\n          td.className = \"url-cell\"\n          td.innerHTML = this.formatUrlCell(value, item)\n        } else if (this.isNumericColumn(key)) {\n          td.className = \"numeric-cell\"\n          td.innerHTML = this.formatNumericValue(value, key)\n        } else if (key === \"source\") {\n          td.className = \"source-cell\"\n          td.innerHTML = this.formatSourceCell(value, item)\n        } else if (key === \"reflowTime\" || key === \"time\" || key.includes(\"time\") || key.includes(\"Time\")) {\n          td.className = \"metric-value\"\n          td.innerHTML = this.formatTimeValue(value)\n        } else {\n          td.textContent = this.formatCellValue(value)\n        }\n\n        row.appendChild(td)\n      })\n    } else {\n      // Default formatting for forced reflow data\n      const sourceCell = document.createElement(\"td\")\n      sourceCell.className = \"source-cell\"\n      sourceCell.innerHTML = this.formatSourceCell(item.source || item.url, item)\n\n      const timeCell = document.createElement(\"td\")\n      timeCell.className = \"metric-value\"\n      timeCell.innerHTML = this.formatTimeValue(item.reflowTime || item.time || item.duration)\n\n      row.appendChild(sourceCell)\n      row.appendChild(timeCell)\n    }\n\n    return row\n  }\n\n  /**\n   * Format URL cell with better wrapping and tooltip\n   */\n  formatUrlCell(url, item) {\n    if (!url) {\n      return '<div class=\"unattributed\">Unattributed</div>'\n    }\n\n    const urlString = typeof url === \"object\" ? url.url || url.href || String(url) : String(url)\n    const filename = this.extractFilename(urlString)\n    const domain = this.extractDomain(urlString)\n\n    return `\n  <div class=\"url-container compact\">\n    <div class=\"url-filename tooltip-trigger\" data-tooltip=\"${this.escapeHtml(urlString)}\">\n      ${this.escapeHtml(filename)}${domain ? ` (${this.escapeHtml(domain)})` : \"\"}\n    </div>\n  </div>\n`\n  }\n\n  /**\n   * Format numeric values with proper alignment and units\n   */\n  formatNumericValue(value, key) {\n    if (value === undefined || value === null) {\n      return '<span class=\"numeric-na\"></span>'\n    }\n\n    const numValue = Number.parseFloat(value)\n    if (isNaN(numValue)) {\n      return '<span class=\"numeric-na\"></span>'\n    }\n\n    // Format based on the type of numeric value\n    if (key.toLowerCase().includes(\"bytes\") || key.toLowerCase().includes(\"size\")) {\n      return `<span class=\"numeric-bytes\">${this.formatBytes(numValue)}</span>`\n    } else if (key.toLowerCase().includes(\"time\") || key.toLowerCase().includes(\"ms\")) {\n      return `<span class=\"numeric-time\">${numValue.toFixed(1)}ms</span>`\n    } else if (key.toLowerCase().includes(\"savings\")) {\n      return `<span class=\"numeric-savings\">${this.formatBytes(numValue)}</span>`\n    } else {\n      return `<span class=\"numeric-value\">${numValue.toLocaleString()}</span>`\n    }\n  }\n\n  /**\n   * Format bytes into human readable format\n   */\n  formatBytes(bytes) {\n    if (bytes === 0) return \"0 B\"\n    const k = 1024\n    const sizes = [\"B\", \"KB\", \"MB\", \"GB\"]\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return Number.parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + \" \" + sizes[i]\n  }\n\n  /**\n   * Extract domain from URL\n   */\n  extractDomain(url) {\n    if (!url) return \"\"\n\n    try {\n      const urlObj = new URL(url)\n      return urlObj.hostname\n    } catch (e) {\n      return \"\"\n    }\n  }\n\n  /**\n   * Format source cell with URL and location\n   */\n  formatSourceCell(source, item) {\n    if (!source) {\n      return '<div class=\"unattributed\">Unattributed</div>'\n    }\n\n    // Handle PSI source object structure\n    if (typeof source === \"object\" && source.url) {\n      const filename = this.extractFilename(source.url)\n      const domain = this.extractDomain(source.url)\n\n      let html = `\n  <div class=\"url-container compact\">\n    <div class=\"url-filename tooltip-trigger\" data-tooltip=\"${this.escapeHtml(source.url || source)}\">\n      ${this.escapeHtml(filename)}${domain ? ` (${this.escapeHtml(domain)})` : \"\"}\n    </div>\n  </div>\n`\n\n      if (source.line !== undefined || source.column !== undefined) {\n        const line = source.line || 0\n        const column = source.column || 0\n        html += `<div class=\"source-location\">Line ${line}, Column ${column}</div>`\n      }\n\n      return html\n    }\n\n    // Handle string source\n    if (typeof source === \"string\") {\n      const filename = this.extractFilename(source)\n      const domain = this.extractDomain(source)\n\n      let html = `\n  <div class=\"url-container compact\">\n    <div class=\"url-filename tooltip-trigger\" data-tooltip=\"${this.escapeHtml(source.url || source)}\">\n      ${this.escapeHtml(filename)}${domain ? ` (${this.escapeHtml(domain)})` : \"\"}\n    </div>\n  </div>\n`\n\n      if (item.line !== undefined || item.column !== undefined) {\n        const line = item.line || 0\n        const column = item.column || 0\n        html += `<div class=\"source-location\">Line ${line}, Column ${column}</div>`\n      }\n\n      return html\n    }\n\n    return '<div class=\"unattributed\">Unattributed</div>'\n  }\n\n  /**\n   * Extract filename from URL for cleaner display\n   */\n  extractFilename(url) {\n    if (!url) return \"Unknown\"\n\n    try {\n      const urlObj = new URL(url)\n      const pathname = urlObj.pathname\n      const filename = pathname.split(\"/\").pop() || pathname\n      return filename || \"Unknown\"\n    } catch (e) {\n      // Handle relative URLs or malformed URLs\n      const parts = url.split(\"/\")\n      return parts[parts.length - 1] || url\n    }\n  }\n\n  /**\n   * Format time value with appropriate styling\n   */\n  formatTimeValue(time) {\n    if (time === undefined || time === null) {\n      return '<span class=\"reflow-time low\">N/A</span>'\n    }\n\n    const numTime = Number.parseFloat(time)\n    if (isNaN(numTime)) {\n      return '<span class=\"reflow-time low\">N/A</span>'\n    }\n\n    let className = \"low\"\n\n    if (numTime > 50) {\n      className = \"high\"\n    } else if (numTime > 16) {\n      className = \"medium\"\n    }\n\n    return `<span class=\"reflow-time ${className}\">${numTime.toFixed(2)}ms</span>`\n  }\n\n  /**\n   * Format cell value\n   */\n  formatCellValue(value) {\n    if (value === undefined || value === null) {\n      return \"N/A\"\n    }\n\n    if (typeof value === \"object\") {\n      return JSON.stringify(value)\n    }\n\n    return String(value)\n  }\n\n  /**\n   * Format insight title\n   */\n  formatInsightTitle(title) {\n    if (!title) return \"Performance Insight\"\n\n    // Convert kebab-case to title case\n    return title.replace(/-/g, \" \").replace(/\\b\\w/g, (l) => l.toUpperCase())\n  }\n\n  /**\n   * Format table heading\n   */\n  formatHeading(heading) {\n    // Ensure we have a string\n    if (!heading) {\n      return \"Column\"\n    }\n\n    if (typeof heading !== \"string\") {\n      return String(heading)\n    }\n\n    return heading\n      .replace(/([A-Z])/g, \" $1\")\n      .replace(/^./, (str) => str.toUpperCase())\n      .trim()\n  }\n\n  /**\n   * Toggle insight expansion\n   */\n  toggleInsight(item, index) {\n    const header = item.querySelector(\".insight-header\")\n    const content = item.querySelector(\".insight-content\")\n    const expandIcon = header.querySelector(\".insight-expand-icon\")\n\n    const isExpanded = item.classList.contains(\"expanded\")\n\n    if (isExpanded) {\n      item.classList.remove(\"expanded\")\n      header.classList.remove(\"expanded\")\n      header.setAttribute(\"aria-expanded\", \"false\")\n      this.expandedInsights.delete(index)\n    } else {\n      item.classList.add(\"expanded\")\n      header.classList.add(\"expanded\")\n      header.setAttribute(\"aria-expanded\", \"true\")\n      this.expandedInsights.add(index)\n\n      // Reinitialize tooltips for newly expanded content\n      setTimeout(() => this.initializeTooltips(), 100)\n    }\n  }\n\n  /**\n   * Render empty state\n   */\n  renderEmptyState(container) {\n    const emptyState = document.createElement(\"div\")\n    emptyState.className = \"psi-insights-empty\"\n    emptyState.innerHTML = `\n            <p>No performance insights available</p>\n            <small>Run a PageSpeed Insights analysis to see detailed performance recommendations</small>\n        `\n    container.appendChild(emptyState)\n  }\n\n  /**\n   * Render error state\n   */\n  renderError(container, error) {\n    const errorState = document.createElement(\"div\")\n    errorState.className = \"psi-insights-error\"\n    errorState.innerHTML = `\n            <p>Failed to load insights</p>\n            <small>${this.escapeHtml(error.message || \"Unknown error occurred\")}</small>\n        `\n    container.appendChild(errorState)\n  }\n\n  /**\n   * Render loading state\n   */\n  renderLoading(container) {\n    const loadingState = document.createElement(\"div\")\n    loadingState.className = \"psi-insights-loading\"\n    loadingState.textContent = \"Loading insights...\"\n    container.appendChild(loadingState)\n  }\n\n  /**\n   * Escape HTML to prevent XSS\n   */\n  escapeHtml(text) {\n    if (typeof text !== \"string\") return \"\"\n    const div = document.createElement(\"div\")\n    div.textContent = text\n    return div.innerHTML\n  }\n\n  processMarkdown(text) {\n    if (!text) return \"\"\n\n    // Convert markdown links [text](url) to HTML links\n    return text.replace(/\\[([^\\]]+)\\]$$([^)]+)$$/g, '<a href=\"$2\" class=\"insight-link\" target=\"_blank\">$1</a>')\n  }\n\n  getFilenameFromUrl(url) {\n    try {\n      const urlObj = new URL(url)\n      const pathname = urlObj.pathname\n      const filename = pathname.split(\"/\").pop()\n      return filename || urlObj.hostname\n    } catch {\n      return url\n    }\n  }\n\n  destroy() {\n    if (this.tooltipElement) {\n      this.tooltipElement.remove()\n    }\n  }\n}\n\n// Export singleton instance\nexport const insightsRenderer = new InsightsRenderer()\n","/**\n * Module for handling PSI Insights display in the popup\n */\n\n// Chrome API is available globally in extension context\nconst chrome = globalThis.chrome || window.chrome\n\nimport { insightsRenderer } from \"./insights-renderer.js\"\n\n/**\n * PSI Insights state management\n */\nconst psiInsightsState = {\n  insights: {},\n  lastUpdate: null,\n  isLoading: false,\n  hasError: false,\n  errorMessage: \"\",\n}\n\n/**\n * Updates PSI insights display with data from PSI API\n * @param {Object} psiData - Complete PSI API response data\n */\nexport function updatePSIInsightsDisplay(psiData) {\n  console.log(\"=== updatePSIInsightsDisplay called ===\")\n  console.log(\"PSI Data received:\", psiData)\n\n  try {\n    // Extract insights from PSI data structure\n    const insights = extractPSIInsights(psiData)\n\n    if (!insights || Object.keys(insights).length === 0) {\n      console.log(\"No PSI insights found in data\")\n      showEmptyInsightsState()\n      return\n    }\n\n    console.log(\"Extracted PSI insights:\", insights)\n\n    // Update state\n    psiInsightsState.insights = insights\n    psiInsightsState.lastUpdate = Date.now()\n    psiInsightsState.isLoading = false\n    psiInsightsState.hasError = false\n\n    // Update UI\n    displayPSIInsights(insights)\n  } catch (error) {\n    console.error(\"Error updating PSI insights display:\", error)\n    psiInsightsState.hasError = true\n    psiInsightsState.errorMessage = error.message\n    psiInsightsState.isLoading = false\n    showInsightsError(error.message)\n  }\n}\n\nfunction extractPSIInsights(psiData) {\n  console.log(\"=== extractPSIInsights called ===\")\n\n  try {\n    // Navigate through the PSI data structure\n    if (!psiData || !psiData.data) {\n      console.log(\"No PSI data or data property found\")\n      return null\n    }\n\n    const lighthouseResult = psiData.data.lighthouseResult\n    if (!lighthouseResult) {\n      console.log(\"No lighthouseResult found in PSI data\")\n      return null\n    }\n\n    const audits = lighthouseResult.audits\n    if (!audits) {\n      console.log(\"No audits found in lighthouse result\")\n      return null\n    }\n\n    const allInsights = {}\n\n    // Extract failed insights\n    if (audits.failed && audits.failed.insights) {\n      console.log(\"Found failed insights:\", audits.failed.insights)\n      Object.keys(audits.failed.insights).forEach((key) => {\n        allInsights[key] = {\n          ...audits.failed.insights[key],\n          category: \"failed\",\n          score: 0, // Failed insights have score of 0\n        }\n      })\n    }\n\n    // Extract warning insights\n    if (audits.warnings && audits.warnings.insights) {\n      console.log(\"Found warning insights:\", audits.warnings.insights)\n      Object.keys(audits.warnings.insights).forEach((key) => {\n        allInsights[key] = {\n          ...audits.warnings.insights[key],\n          category: \"warning\",\n          score: 0.7, // Warning insights have score between 0.5-0.89\n        }\n      })\n    }\n\n    console.log(\"Successfully extracted all insights:\", allInsights)\n    return Object.keys(allInsights).length > 0 ? allInsights : null\n  } catch (error) {\n    console.error(\"Error extracting PSI insights:\", error)\n    return null\n  }\n}\n\nfunction displayPSIInsights(insights) {\n  console.log(\"=== displayPSIInsights called ===\")\n  console.log(\"Displaying insights:\", insights)\n\n  const container = document.getElementById(\"psiInsightsContainer\")\n  if (!container) {\n    console.log(\"PSI insights container not found in DOM\")\n    return\n  }\n\n  // Convert insights object to array format expected by renderer\n  const insightsArray = Object.keys(insights).map((insightKey) => {\n    const insightData = insights[insightKey]\n    return {\n      id: insightKey,\n      title: insightData.title || insightKey,\n      description: insightData.description,\n      details: insightData.details,\n      ...insightData,\n    }\n  })\n\n  // Use the insights renderer to display the insights\n  insightsRenderer.renderInsights(container, insightsArray)\n\n  // Show the container\n  container.style.display = \"block\"\n}\n\n/**\n * Formats insight key into readable title\n * @param {string} insightKey - Raw insight key\n * @returns {string} Formatted title\n */\n\n/**\n * Shows empty state when no insights are available\n */\nfunction showEmptyInsightsState() {\n  console.log(\"=== showEmptyInsightsState called ===\")\n\n  const container = document.getElementById(\"psiInsightsContainer\")\n  if (!container) return\n\n  container.innerHTML = `\n    <div class=\"psi-insights-empty\">\n      <p>No performance insights available</p>\n      <small>Run PSI analysis to get detailed insights</small>\n    </div>\n  `\n  container.style.display = \"block\"\n}\n\n/**\n * Shows error state for insights\n * @param {string} errorMessage - Error message to display\n */\nfunction showInsightsError(errorMessage) {\n  console.log(\"=== showInsightsError called ===\")\n  console.log(\"Error message:\", errorMessage)\n\n  const container = document.getElementById(\"psiInsightsContainer\")\n  if (!container) return\n\n  container.innerHTML = `\n    <div class=\"psi-insights-error\">\n      <p>Error loading insights: ${errorMessage}</p>\n    </div>\n  `\n  container.style.display = \"block\"\n}\n\n/**\n * Clears PSI insights display\n */\nexport function clearPSIInsightsDisplay() {\n  console.log(\"=== clearPSIInsightsDisplay called ===\")\n\n  const container = document.getElementById(\"psiInsightsContainer\")\n  if (container) {\n    container.innerHTML = \"\"\n    container.style.display = \"none\"\n  }\n\n  // Reset state\n  psiInsightsState.insights = {}\n  psiInsightsState.lastUpdate = null\n  psiInsightsState.hasError = false\n  psiInsightsState.errorMessage = \"\"\n}\n\n/**\n * Sets loading state for PSI insights\n * @param {boolean} isLoading - Loading state\n */\nexport function setPSIInsightsLoading(isLoading) {\n  console.log(\"=== setPSIInsightsLoading called ===\", isLoading)\n\n  psiInsightsState.isLoading = isLoading\n\n  const container = document.getElementById(\"psiInsightsContainer\")\n  if (!container) return\n\n  if (isLoading) {\n    container.innerHTML = `\n      <div class=\"psi-insights-loading\">\n        <p>Loading performance insights...</p>\n      </div>\n    `\n    container.style.display = \"block\"\n  }\n}\n\n/**\n * Gets current PSI insights state\n * @returns {Object} Current insights state\n */\nexport function getPSIInsightsState() {\n  return { ...psiInsightsState }\n}\n","// src/popup/displays/insights-display.js\n\n/**\n * Module for handling insights display in the popup - Complete Enhanced Version with Combination Indicators\n */\n\n// Import the simplified helpers\nimport { sendMessageToContentScript, showElementFeedback, getTargetTabId } from \"../../utils/tab-helpers.js\"\nimport { showErrorToast } from \"../../utils/toast-notifications.js\"\nimport { updatePSIInsightsDisplay, clearPSIInsightsDisplay, setPSIInsightsLoading } from \"./psi-insights-display.js\"\n\n// Chrome API is available globally in extension context\nconst chrome = globalThis.chrome || window.chrome\n\n/**\n * Enhanced state management for insights display\n */\nconst insightsState = {\n  isLoading: false,\n  hasError: false,\n  errorMessage: \"\",\n  lastUpdate: null,\n  dataTypes: {\n    local: { available: false, lastUpdate: null },\n    field: { available: false, lastUpdate: null },\n    lab: { available: false, lastUpdate: null },\n  },\n  metrics: {\n    cls: { local: null, field: null, lab: null },\n    lcp: { local: null, field: null, lab: null },\n    inp: { local: null, field: null, lab: null },\n    ttfb: { local: null, field: null, lab: null }, // Note: lab TTFB will always be null\n  },\n}\n\n/**\n * Core Web Vitals thresholds based on official Google guidelines\n */\nconst THRESHOLDS = {\n  cls: { good: 0.1, needsImprovement: 0.25 },\n  lcp: { good: 2500, needsImprovement: 4000 },\n  inp: { good: 200, needsImprovement: 500 },\n  ttfb: { good: 800, needsImprovement: 1800 },\n}\n\n/**\n * Format metric value for display\n */\nfunction formatMetricValue(metric, value) {\n  if (metric === \"cls\") {\n    return typeof value === \"number\" ? value.toFixed(3) : value\n  } else {\n    return typeof value === \"number\" ? `${Math.round(value)}ms` : value\n  }\n}\n\n/**\n * Updates the insights state and triggers UI updates\n */\nfunction updateInsightsState(updates) {\n  const previousState = JSON.parse(JSON.stringify(insightsState))\n\n  // Deep merge updates\n  if (updates.dataTypes) {\n    Object.assign(insightsState.dataTypes, updates.dataTypes)\n  }\n  if (updates.metrics) {\n    Object.keys(updates.metrics).forEach((metric) => {\n      if (insightsState.metrics[metric]) {\n        Object.assign(insightsState.metrics[metric], updates.metrics[metric])\n      }\n    })\n  }\n\n  // Update other properties\n  Object.keys(updates).forEach((key) => {\n    if (key !== \"dataTypes\" && key !== \"metrics\") {\n      insightsState[key] = updates[key]\n    }\n  })\n\n  insightsState.lastUpdate = Date.now()\n\n  // Trigger UI updates if state changed\n  if (JSON.stringify(previousState) !== JSON.stringify(insightsState)) {\n    updateUIFromState()\n  }\n}\n\n/**\n * Updates UI based on current state\n */\nfunction updateUIFromState() {\n  // Update loading states\n  updateLoadingStates()\n\n  // Update error states\n  updateErrorStates()\n\n  // Hide cache status when resetting\n  hideElement(\"psiCacheStatus\")\n  \n    cacheStatus.style.display = \"none\"\n  updateLegendFromState()\n\n  // Update metric displays\n  updateMetricDisplaysFromState()\n}\n\n/**\n * Updates loading states across the UI\n */\nfunction updateLoadingStates() {\n  const loadingElements = document.querySelectorAll(\".metric-loading\")\n  loadingElements.forEach((el) => {\n    el.style.display = insightsState.isLoading ? \"flex\" : \"none\"\n  })\n\n  // Update PSI button loading state\n  if (insightsState.isLoading) {\n    setPSIButtonState(\"analyzing\")\n  }\n}\n\n/**\n * Updates error states across the UI\n */\nfunction updateErrorStates() {\n  const errorContainer = document.getElementById(\"insightsErrorContainer\")\n  if (errorContainer) {\n    if (insightsState.hasError) {\n      errorContainer.style.display = \"block\"\n      errorContainer.textContent = insightsState.errorMessage || \"An error occurred\"\n      errorContainer.className = \"insights-error-message\"\n    } else {\n      errorContainer.style.display = \"none\"\n    }\n  }\n}\n\n/**\n * Updates legend visibility based on state including combination indicators\n */\nfunction updateLegendFromState() {\n  const localLegend = document.querySelector('.legend-item[data-type=\"local\"]')\n  const fieldLegend = document.querySelector('.legend-item[data-type=\"field\"]')\n  const labLegend = document.querySelector('.legend-item[data-type=\"lab\"]')\n\n  // Check for combination matches across all metrics\n  const combinationStates = getCombinationStates()\n\n  // Show/hide individual legends based on availability and combinations\n  if (localLegend) {\n    const showLocal = insightsState.dataTypes.local.available && !hasAnyCombinations(combinationStates)\n    localLegend.style.display = showLocal ? \"flex\" : \"none\"\n  }\n  if (fieldLegend) {\n    const showField = insightsState.dataTypes.field.available && !hasAnyCombinations(combinationStates)\n    fieldLegend.style.display = showField ? \"flex\" : \"none\"\n  }\n  if (labLegend) {\n    const showLab = insightsState.dataTypes.lab.available && !hasAnyCombinations(combinationStates)\n    labLegend.style.display = showLab ? \"flex\" : \"none\"\n  }\n\n  // Update combination legends\n  updateCombinationLegends(combinationStates)\n\n  const legendContainer = document.querySelector(\".cwv-legend\")\n  if (legendContainer) {\n    const hasAnyData = Object.values(insightsState.dataTypes).some((dt) => dt.available)\n    legendContainer.style.display = hasAnyData ? \"flex\" : \"none\"\n  }\n}\n\n/**\n * Get combination states across all metrics\n */\nfunction getCombinationStates() {\n  const states = {\n    localField: false,\n    localLab: false,\n    fieldLab: false,\n    allSources: false,\n  }\n\n  Object.keys(insightsState.metrics).forEach((metric) => {\n    const metricData = insightsState.metrics[metric]\n    const localValue = metricData.local\n    const fieldValue = metricData.field\n    const labValue = metricData.lab\n\n    if (localValue !== null && fieldValue !== null && labValue !== null) {\n      const tolerance = calculateTolerance(metric, localValue)\n      const localFieldMatch = Math.abs(localValue - fieldValue) <= tolerance\n      const localLabMatch = Math.abs(localValue - labValue) <= tolerance\n      const fieldLabMatch = Math.abs(fieldValue - labValue) <= tolerance\n\n      if (localFieldMatch && localLabMatch && fieldLabMatch) {\n        states.allSources = true\n      } else if (localFieldMatch) {\n        states.localField = true\n      } else if (localLabMatch) {\n        states.localLab = true\n      } else if (fieldLabMatch) {\n        states.fieldLab = true\n      }\n    } else {\n      // Check two-way combinations\n      if (localValue !== null && fieldValue !== null) {\n        const tolerance = calculateTolerance(metric, localValue)\n        if (Math.abs(localValue - fieldValue) <= tolerance) {\n          states.localField = true\n        }\n      }\n      if (localValue !== null && labValue !== null) {\n        const tolerance = calculateTolerance(metric, localValue)\n        if (Math.abs(localValue - labValue) <= tolerance) {\n          states.localLab = true\n        }\n      }\n      if (fieldValue !== null && labValue !== null) {\n        const tolerance = calculateTolerance(metric, fieldValue)\n        if (Math.abs(fieldValue - labValue) <= tolerance) {\n          states.fieldLab = true\n        }\n      }\n    }\n  })\n\n  return states\n}\n\n/**\n * Check if any combinations are active\n */\nfunction hasAnyCombinations(states) {\n  return states.localField || states.localLab || states.fieldLab || states.allSources\n}\n\n/**\n * Update combination legend items\n */\nfunction updateCombinationLegends(states) {\n  const legendContainer = document.querySelector(\".cwv-legend\")\n  if (!legendContainer) return\n\n  // Remove existing combination legends\n  const existingCombinations = legendContainer.querySelectorAll(\n    '.legend-item[data-type*=\"-\"], .legend-item[data-type=\"all-sources\"]',\n  )\n  existingCombinations.forEach((item) => item.remove())\n\n  // Add active combination legends\n  if (states.allSources) {\n    addCombinationLegendItem(legendContainer, \"all-sources\", \"All Match\")\n  } else {\n    if (states.localField) {\n      addCombinationLegendItem(legendContainer, \"local-field\", \"Local + Field\")\n    }\n    if (states.localLab) {\n      addCombinationLegendItem(legendContainer, \"local-lab\", \"Local + Lab\")\n    }\n    if (states.fieldLab) {\n      addCombinationLegendItem(legendContainer, \"field-lab\", \"Field + Lab\")\n    }\n  }\n}\n\n/**\n * Add combination legend item\n */\nfunction addCombinationLegendItem(container, type, label) {\n  const legendItem = document.createElement(\"div\")\n  legendItem.className = \"legend-item\"\n  legendItem.setAttribute(\"data-type\", type)\n\n  const dot = document.createElement(\"div\")\n  dot.className = \"legend-dot\"\n\n  const labelElement = document.createElement(\"span\")\n  labelElement.className = \"legend-label\"\n  labelElement.textContent = label\n\n  legendItem.appendChild(dot)\n  legendItem.appendChild(labelElement)\n  container.appendChild(legendItem)\n}\n\n/**\n * Updates metric displays based on current state\n */\nfunction updateMetricDisplaysFromState() {\n  Object.keys(insightsState.metrics).forEach((metric) => {\n    const metricData = insightsState.metrics[metric]\n\n    // Update local values\n    if (metricData.local !== null) {\n      updateMetricValue(metric, \"local\", metricData.local)\n    }\n\n    // Update field values\n    if (metricData.field !== null) {\n      updateMetricValue(metric, \"field\", metricData.field)\n    }\n\n    // Update lab values (only for CLS and LCP, TTFB not available in lab)\n    if (metricData.lab !== null && (metric === \"cls\" || metric === \"lcp\")) {\n      updateMetricValue(metric, \"lab\", metricData.lab)\n    }\n  })\n}\n\n/**\n * Generic function to update metric values in UI\n */\nfunction updateMetricValue(metric, type, value) {\n  const valueContainer = document.getElementById(`${metric}${type.charAt(0).toUpperCase() + type.slice(1)}Value`)\n  const textElement = document.getElementById(`${metric}${type.charAt(0).toUpperCase() + type.slice(1)}Text`)\n\n  if (!valueContainer || !textElement) {\n    console.log(`Missing elements for ${metric} ${type}:`, {\n      container: !!valueContainer,\n      text: !!textElement,\n    })\n    return\n  }\n\n  // Show the container\n  valueContainer.style.display = \"flex\"\n\n  // Format value based on metric type\n  const displayValue = formatMetricValue(metric, value)\n  textElement.textContent = displayValue\n\n  // Add threshold-based styling\n  if (typeof value === \"number\") {\n    updateMetricThresholds(metric, value, type === \"field\", type === \"lab\")\n    addThresholdStyling(textElement, metric, value)\n  }\n\n  console.log(`Updated ${metric} ${type} value:`, displayValue)\n}\n\n/**\n * Adds threshold-based styling to metric elements\n */\nfunction addThresholdStyling(element, metric, value) {\n  const threshold = THRESHOLDS[metric]\n  if (!threshold) return\n\n  // Remove existing threshold classes\n  element.classList.remove(\"metric-good\", \"metric-needs-improvement\", \"metric-poor\")\n\n  // Add appropriate class\n  if (value <= threshold.good) {\n    element.classList.add(\"metric-good\")\n  } else if (value <= threshold.needsImprovement) {\n    element.classList.add(\"metric-needs-improvement\")\n  } else {\n    element.classList.add(\"metric-poor\")\n  }\n}\n\n/**\n * Verifies content script is ready with simple ping\n */\nasync function verifyContentScriptReady(targetTabId) {\n  console.log(`Verifying content script readiness for tab ${targetTabId}`)\n\n  return new Promise((resolve) => {\n    chrome.tabs.sendMessage(targetTabId, { action: \"ping\" }, (response) => {\n      if (chrome.runtime.lastError) {\n        console.log(\"Content script ping failed:\", chrome.runtime.lastError.message)\n        resolve(false)\n      } else if (response && response.ready) {\n        console.log(\"Content script ping successful\")\n        resolve(true)\n      } else {\n        console.log(\"Content script ping returned unexpected response:\", response)\n        resolve(false)\n      }\n    })\n  })\n}\n\n/**\n * Sets up the PSI analyze button functionality with proper detached mode support\n */\nfunction setupPSIAnalyzeButton() {\n  console.log(\"Setting up PSI button\")\n  const psiBtn = document.getElementById(\"analyzePSIBtn\")\n\n  if (!psiBtn) {\n    console.log(\"PSI button not found\")\n    return\n  }\n\n  // Remove any existing listeners to prevent duplicates\n  const newBtn = psiBtn.cloneNode(true)\n  psiBtn.parentNode.replaceChild(newBtn, psiBtn)\n\n  // Set initial state\n  newBtn.setAttribute(\"data-tooltip\", \"Analyze with PageSpeed Insights\")\n\n  // Single event listener with proper error handling\n  newBtn.addEventListener(\"click\", handlePSIButtonClick)\n}\n\n/**\n * Handles PSI button click with proper detached mode support\n */\nasync function handlePSIButtonClick() {\n  try {\n    console.log(\"PSI button clicked - starting analysis\")\n\n    // Update state to loading\n    updateInsightsState({\n      isLoading: true,\n      hasError: false,\n      errorMessage: \"\",\n    })\n\n    // Get target tab ID using the improved helper that auto-detects mode\n    console.log(\"Getting target tab ID...\")\n    const targetTabId = await getTargetTabId()\n    console.log(\"Target tab ID for PSI analysis:\", targetTabId)\n\n    if (!targetTabId) {\n      throw new Error(\"No target tab available. Please ensure you're on a valid webpage.\")\n    }\n\n    // Verify content script is ready before sending PSI request\n    console.log(\"Verifying content script readiness...\")\n    const isReady = await verifyContentScriptReady(targetTabId)\n\n    if (!isReady) {\n      throw new Error(\"Content script not ready. Please refresh the page and try again.\")\n    }\n\n    console.log(\"Content script ready, sending PSI analysis request...\")\n\n    // Send PSI analysis request with proper timeout handling\n    const response = await new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(new Error(\"Request timeout - analysis taking too long\"))\n      }, 45000)\n\n      chrome.tabs.sendMessage(targetTabId, { action: \"analyzePSI\" }, (response) => {\n        clearTimeout(timeout)\n\n        if (chrome.runtime.lastError) {\n          console.error(\"Chrome runtime error:\", chrome.runtime.lastError.message)\n          reject(new Error(`Connection failed: ${chrome.runtime.lastError.message}`))\n        } else if (response && response.success) {\n          console.log(\"PSI analysis request successful:\", response)\n          resolve(response)\n        } else {\n          const errorMessage = response?.userMessage || response?.message || \"Analysis failed. Please try again.\"\n          console.error(\"PSI analysis failed:\", errorMessage)\n          reject(new Error(errorMessage))\n        }\n      })\n    })\n\n    // Success state\n    updateInsightsState({\n      isLoading: false,\n      hasError: false,\n    })\n\n    console.log(\" PSI analysis completed successfully\")\n  } catch (error) {\n    console.error(\"PSI button error:\", error)\n\n    // Error state\n    updateInsightsState({\n      isLoading: false,\n      hasError: true,\n      errorMessage: error.message,\n    })\n\n    showErrorToast(error.message, { duration: 5000 })\n  }\n}\n\n/**\n * Enhanced PSI button state management\n */\nfunction setPSIButtonState(state) {\n  const psiBtn = document.getElementById(\"analyzePSIBtn\")\n  if (!psiBtn) return\n\n  console.log(`Setting PSI button state to: ${state}`)\n\n  // Remove all state classes\n  psiBtn.classList.remove(\"analyzing\", \"success\", \"error\")\n\n  const btnText = psiBtn.querySelector(\".psi-btn-text\")\n  const btnIcon = psiBtn.querySelector(\".psi-btn-icon\")\n\n  if (state === \"analyzing\") {\n    psiBtn.classList.add(\"analyzing\")\n    psiBtn.disabled = true\n    if (btnText) btnText.textContent = \"Analyzing...\"\n    psiBtn.setAttribute(\"data-tooltip\", \"Analyzing with PageSpeed Insights...\")\n  } else if (state === \"success\") {\n    psiBtn.classList.add(\"success\")\n    psiBtn.disabled = false\n    if (btnText) btnText.textContent = \"Success!\"\n    psiBtn.setAttribute(\"data-tooltip\", \"Analysis completed successfully\")\n\n    // Reset to default after 2 seconds\n    setTimeout(() => {\n      setPSIButtonState(\"default\")\n    }, 2000)\n  } else if (state === \"error\") {\n    psiBtn.classList.add(\"error\")\n    psiBtn.disabled = false\n    if (btnText) btnText.textContent = \"Error\"\n    psiBtn.setAttribute(\"data-tooltip\", \"Analysis failed - click to retry\")\n\n    // Reset to default after 3 seconds\n    setTimeout(() => {\n      setPSIButtonState(\"default\")\n    }, 3000)\n  } else {\n    // Default state\n    psiBtn.disabled = false\n    if (btnText) btnText.textContent = \"Analyze PSI\"\n    psiBtn.setAttribute(\"data-tooltip\", \"Analyze with PageSpeed Insights\")\n  }\n}\n\n/**\n * Resets data availability (useful when navigating to new page)\n */\nfunction resetDataAvailability() {\n  updateInsightsState({\n    dataTypes: {\n      local: { available: false, lastUpdate: null },\n      field: { available: false, lastUpdate: null },\n      lab: { available: false, lastUpdate: null },\n    },\n    metrics: {\n      cls: { local: null, field: null, lab: null },\n      lcp: { local: null, field: null, lab: null },\n      inp: { local: null, field: null, lab: null },\n      ttfb: { local: null, field: null, lab: null }, // Lab TTFB always null\n    },\n    hasError: false,\n    errorMessage: \"\",\n    isLoading: false,\n  })\n\n  // Clear PSI insights as well\n  clearPSIInsightsDisplay()\n}\n\n/**\n * Updates the insights display with analysis results\n * @param {Object} data - Analysis data object\n */\nexport function updateInsightsDisplay(data) {\n  console.log(\"Updating insights display with data:\", data)\n\n  // Update CLS display\n  if (data.cls !== undefined) {\n    console.log(\"Updating CLS display\")\n    updateCLSDisplay(data.cls)\n  }\n\n  // Update LCP display\n  if (data.lcp !== undefined) {\n    console.log(\"Updating LCP display\")\n    updateLCPDisplay(data.lcp)\n  }\n\n  // Update INP display\n  if (data.inp !== undefined) {\n    console.log(\"Updating INP display\")\n    updateINPDisplay(data.inp)\n  }\n\n  // Update TTFB display\n  if (data.additionalMetrics !== undefined) {\n    console.log(\"Updating TTFB display\")\n    updateTTFBDisplay(data.additionalMetrics)\n  }\n}\n\n// Update the CLS display function - Fixed to properly update state\nexport function updateCLSDisplay(clsData) {\n  console.log(\"updateCLSDisplay called with:\", clsData)\n\n  const value = clsData.value || 0\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      local: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      cls: { local: value },\n    },\n  })\n\n  const clsElementPreview = document.getElementById(\"clsElementPreview\")\n\n  // Show/hide element preview\n  if (clsElementPreview) {\n    if (value > 0) {\n      clsElementPreview.style.display = \"block\"\n      updateCLSElementPreview(clsData.element || {}, value)\n    } else {\n      clsElementPreview.style.display = \"none\"\n    }\n  }\n\n  updateMetricThresholds(\"cls\", value, false, false) // isField = false, isLab = false (local)\n}\n\n// Update the LCP display function - Fixed to properly update state\nexport function updateLCPDisplay(lcpData) {\n  console.log(\"updateLCPDisplay called with:\", lcpData)\n\n  const value = lcpData.value || 0\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      local: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      lcp: { local: value },\n    },\n  })\n\n  const lcpElementPreview = document.getElementById(\"lcpElementPreview\")\n\n  // Show element preview\n  if (lcpElementPreview) {\n    lcpElementPreview.style.display = \"block\"\n    updateLCPElementPreview(lcpData.element || {})\n  }\n\n  updateMetricThresholds(\"lcp\", value, false, false) // isField = false, isLab = false (local)\n}\n\n// Update the INP display function - Enhanced to show element details\nexport function updateINPDisplay(inpData) {\n  console.log(\"updateINPDisplay called with:\", inpData)\n\n  const value = inpData.value || 0\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      local: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      inp: { local: value },\n    },\n  })\n\n  const inpStatus = document.getElementById(\"inpStatus\")\n  const inpElementPreview = document.getElementById(\"inpElementPreview\")\n\n  if (inpStatus) {\n    const status = inpData.status || \"waiting\"\n\n    if (value !== null && value !== undefined && value > 0) {\n      if (inpData.entries && inpData.entries.length > 0) {\n        const latestEntry = inpData.entries[0]\n        inpStatus.innerHTML = `\n          <div class=\"inp-message\">\n            Latest interaction: ${latestEntry.name} on ${latestEntry.target} (${latestEntry.duration}ms)\n          </div>\n        `\n\n        // Show element preview if we have element data\n        if (latestEntry.element && inpElementPreview) {\n          inpElementPreview.style.display = \"block\"\n          updateINPElementPreview(latestEntry.element, latestEntry)\n        }\n      } else {\n        inpStatus.innerHTML = `<div class=\"inp-message\">INP measured: ${value}ms</div>`\n        if (inpElementPreview) {\n          inpElementPreview.style.display = \"none\"\n        }\n      }\n    } else {\n      if (status === \"waiting\") {\n        inpStatus.innerHTML = `<div class=\"inp-message\">Click anywhere on the page to measure interaction responsiveness</div>`\n      } else {\n        inpStatus.innerHTML = `<div class=\"inp-message\">No interactions detected yet</div>`\n      }\n      if (inpElementPreview) {\n        inpElementPreview.style.display = \"none\"\n      }\n    }\n  }\n\n  updateMetricThresholds(\"inp\", value, false, false) // isField = false, isLab = false (local)\n}\n\n// Update the TTFB display function - Fixed to properly update state\nexport function updateTTFBDisplay(metrics) {\n  console.log(\"updateTTFBDisplay called with:\", metrics)\n\n  const value = metrics.ttfb || 0\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      local: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      ttfb: { local: value },\n    },\n  })\n\n  updateMetricThresholds(\"ttfb\", value, false, false) // isField = false, isLab = false (local)\n}\n\n/**\n * Updates the CLS display with PSI field data\n */\nexport function updatePSICLSDisplay(psiData) {\n  console.log(\"updatePSICLSDisplay called with:\", psiData)\n\n  if (!psiData || psiData.value === null || psiData.value === undefined || isNaN(psiData.value)) {\n    console.log(\"No valid PSI CLS data available\")\n    return\n  }\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      field: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      cls: { field: psiData.value },\n    },\n  })\n\n  console.log(\"PSI CLS field data processed:\", psiData.value)\n  updateMetricThresholds(\"cls\", psiData.value, true, false) // isField = true, isLab = false\n}\n\n/**\n * Updates the LCP display with PSI field data\n */\nexport function updatePSILCPDisplay(psiData) {\n  console.log(\"updatePSILCPDisplay called with:\", psiData)\n\n  if (!psiData || psiData.value === null || psiData.value === undefined || isNaN(psiData.value)) {\n    console.log(\"No valid PSI LCP data available\")\n    return\n  }\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      field: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      lcp: { field: psiData.value },\n    },\n  })\n\n  console.log(\"PSI LCP field data processed:\", psiData.value)\n  updateMetricThresholds(\"lcp\", psiData.value, true, false) // isField = true, isLab = false\n}\n\n/**\n * Updates the INP display with PSI field data\n */\nexport function updatePSIINPDisplay(psiData) {\n  console.log(\"updatePSIINPDisplay called with:\", psiData)\n\n  if (!psiData || psiData.value === null || psiData.value === undefined || isNaN(psiData.value)) {\n    console.log(\"No valid PSI INP data available\")\n    return\n  }\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      field: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      inp: { field: psiData.value },\n    },\n  })\n\n  console.log(\"PSI INP field data processed:\", psiData.value)\n  updateMetricThresholds(\"inp\", psiData.value, true, false) // isField = true, isLab = false\n}\n\n/**\n * Updates the TTFB display with PSI field data\n */\nexport function updatePSITTFBDisplay(psiData) {\n  console.log(\"updatePSITTFBDisplay called with:\", psiData)\n\n  if (!psiData || psiData.value === null || psiData.value === undefined || isNaN(psiData.value)) {\n    console.log(\"No valid PSI TTFB data available\")\n    return\n  }\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      field: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      ttfb: { field: psiData.value },\n    },\n  })\n\n  console.log(\"PSI TTFB field data processed:\", psiData.value)\n  updateMetricThresholds(\"ttfb\", psiData.value, true, false) // isField = true, isLab = false\n}\n\n/**\n * Updates the CLS display with PSI lab data\n */\nexport function updatePSILabCLSDisplay(labData) {\n  console.log(\"updatePSILabCLSDisplay called with:\", labData)\n\n  if (!labData || labData.value === null || labData.value === undefined || isNaN(labData.value)) {\n    console.log(\"No valid PSI Lab CLS data available\")\n    return\n  }\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      lab: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      cls: { lab: labData.value },\n    },\n  })\n\n  console.log(\"PSI Lab CLS data processed:\", labData.value)\n  updateMetricThresholds(\"cls\", labData.value, false, true) // isField = false, isLab = true\n}\n\n/**\n * Updates the LCP display with PSI lab data\n */\nexport function updatePSILabLCPDisplay(labData) {\n  console.log(\"updatePSILabLCPDisplay called with:\", labData)\n\n  if (!labData || labData.value === null || labData.value === undefined || isNaN(labData.value)) {\n    console.log(\"No valid PSI Lab LCP data available\")\n    return\n  }\n\n  // Update state with actual value\n  updateInsightsState({\n    dataTypes: {\n      lab: { available: true, lastUpdate: Date.now() },\n    },\n    metrics: {\n      lcp: { lab: labData.value },\n    },\n  })\n\n  console.log(\"PSI Lab LCP data processed:\", labData.value)\n  updateMetricThresholds(\"lcp\", labData.value, false, true) // isField = false, isLab = true\n}\n\n// Note: TTFB lab data function removed as TTFB is not available in Lighthouse lab environment\n\n/**\n * @param {Object} statusData - PSI status data\n */\nexport function updatePSIStatus(statusData) {\n  console.log(\"updatePSIStatus called with:\", statusData)\n\n  if (statusData.status === \"loading\") {\n    console.log(\"PSI: Loading...\")\n  const cacheStatusContainer = document.getElementById(\"psiCacheStatus\")\n  const cacheStatusText = document.getElementById(\"cacheStatusText\")\n    setPSIButtonState(\"analyzing\")\n    setPSIInsightsLoading(true)\n    \n    // Hide cache status during loading\n    if (cacheStatusContainer) {\n      cacheStatusContainer.style.display = \"none\"\n    // Hide cache status during loading and start timing\n    if (cacheStatus) {\n      cacheStatus.style.display = \"none\"\n    }\n    \n    // Store start time for timing-based cache detection\n    window.psiAnalysisStartTime = Date.now()\n    }\n  } else if (statusData.status === \"success\") {\n    console.log(\"PSI: Success -\", statusData.message, statusData.cached ? \"(cached)\" : \"(fresh)\")\n    setPSIButtonState(\"success\")\n    setPSIInsightsLoading(false)\n  } else if (statusData.status === \"error\") {\n    console.error(\"PSI: Error -\", statusData.message)\n    setPSIButtonState(\"error\")\n    setPSIInsightsLoading(false)\n\n    // Show error toast for API errors\n    // Implement timing-based cache detection\n    if (cacheStatus) {\n      const analysisEndTime = Date.now()\n      const startTime = window.psiAnalysisStartTime || analysisEndTime\n      const duration = analysisEndTime - startTime\n      \n      // If analysis took more than 10 seconds, it's fresh; otherwise cached\n      const isFresh = duration > 10000\n      const statusText = isFresh ? \"FRESH\" : \"CACHED\"\n      \n      console.log(`PSI analysis took ${duration}ms - showing as ${statusText}`)\n      \n      const cacheStatusText = document.getElementById(\"cacheStatusText\")\n      if (cacheStatusText) {\n        cacheStatusText.textContent = statusText\n        cacheStatusText.className = `cache-status-text ${isFresh ? \"fresh\" : \"cached\"}`\n        cacheStatus.style.display = \"block\"\n      }\n    }\n    \n    // Hide cache status on error\n    if (cacheStatusContainer) {\n      cacheStatus.style.display = \"none\"\n    }\n  }\n}\n\n/**\n * Handles complete PSI results including insights\n * @param {Object} psiData - Complete PSI data\n */\nexport function handleCompletePSIResults(psiData) {\n  console.log(\"handleCompletePSIResults called with:\", psiData)\n\n  try {\n  // Update cache status indicator\n  updatePSICacheStatus(psiData.fromCache)\n  \n    // Update insights display with complete PSI data\n    updatePSIInsightsDisplay(psiData)\n  } catch (error) {\n    console.error(\"Error handling complete PSI results:\", error)\n  }\n}\n\n/**\n * Updates PSI cache status indicator\n * @param {boolean} fromCache - Whether PSI data is from cache\n */\nfunction updatePSICacheStatus(fromCache) {\n  console.log(\"=== updatePSICacheStatus called ===\", fromCache)\n  \n  const cacheStatusContainer = document.getElementById(\"psiCacheStatus\")\n  const cacheStatusText = document.getElementById(\"cacheStatusText\")\n  \n  if (!cacheStatusContainer || !cacheStatusText) {\n    console.log(\"PSI cache status elements not found\")\n    return\n  }\n  \n  // Only show cache status for actual PSI API responses, not restored data\n  if (fromCache === undefined || fromCache === null) {\n    console.log(\"No cache status provided, hiding indicator\")\n    psiCacheStatus.style.display = \"none\"\n    return\n  }\n  \n  // Show the container\n  cacheStatusContainer.style.display = \"flex\"\n  \n  // Update text and styling based on cache status\n  if (fromCache === false) {\n    cacheStatusText.textContent = \"Fresh\"\n    cacheStatusText.className = \"cache-status-text fresh\"\n  } else {\n    cacheStatusText.textContent = \"Cached\"\n    cacheStatusText.className = \"cache-status-text cached\"\n  }\n  \n  console.log(\"PSI cache status updated:\", fromCache === false ? \"Fresh\" : \"Cached\")\n}\n\n/**\n * Updates the CLS element preview with enhanced information\n * @param {Object} element - CLS element data\n * @param {number} clsValue - Current CLS value\n */\nfunction updateCLSElementPreview(element, clsValue) {\n  console.log(\"updateCLSElementPreview called with:\", element, clsValue)\n\n  const elementTag = document.getElementById(\"clsElementTag\")\n  const elementImage = document.getElementById(\"clsElementImage\")\n  const clsShiftValue = document.getElementById(\"clsShiftValue\")\n  const elementDimensions = document.getElementById(\"clsElementDimensions\")\n  const elementPosition = document.getElementById(\"clsElementPosition\")\n  const elementClassesContainer = document.getElementById(\"clsElementClassesContainer\")\n  const elementClasses = document.getElementById(\"clsElementClasses\")\n  const elementSelectorContainer = document.getElementById(\"clsElementSelector\")\n  const elementSelector = document.getElementById(\"clsElementSelector\")\n\n  // Handle case where element data might be empty or incomplete\n  if (!element || Object.keys(element).length === 0 || !element.tagName) {\n    console.log(\"No CLS element data available, element:\", element)\n    if (elementTag) elementTag.textContent = \"Layout Shift Detected\"\n    if (clsShiftValue) clsShiftValue.textContent = clsValue ? clsValue.toFixed(3) : \"0.000\"\n\n    // Show what we can from the CLS data itself\n    if (elementDimensions) {\n      elementDimensions.textContent = \"Element details not available\"\n    }\n    if (elementPosition) {\n      elementPosition.textContent = \"Position not available\"\n    }\n    if (elementImage) {\n      elementImage.innerHTML = '<div class=\"preview-placeholder\">No element preview available</div>'\n    }\n\n    // Hide optional sections\n    if (elementClassesContainer) elementClassesContainer.style.display = \"none\"\n    if (elementSelectorContainer) elementSelectorContainer.style.display = \"none\"\n    return\n  }\n\n  console.log(\"Updating CLS element preview with:\", element)\n\n  // Update element tag with more detailed information\n  if (elementTag) {\n    let tagDisplay = element.tagName ? element.tagName.toUpperCase() : \"ELEMENT\"\n    if (element.classList && element.classList.length > 0) {\n      tagDisplay += \".\" + element.classList[0]\n    } else if (element.id) {\n      tagDisplay += `#${element.id}`\n    }\n    elementTag.textContent = tagDisplay\n    elementTag.style.color = \"#ff9500\" // Orange color for CLS\n  }\n\n  // Update shift value\n  if (clsShiftValue) {\n    clsShiftValue.textContent = element.shiftValue\n      ? element.shiftValue.toFixed(3)\n      : clsValue\n        ? clsValue.toFixed(3)\n        : \"0.000\"\n  }\n\n  // Update dimensions\n  if (elementDimensions && element.dimensions) {\n    let dimensionText = `${element.dimensions.width || 0}${element.dimensions.height || 0}px`\n    if (element.dimensions.naturalWidth && element.dimensions.naturalHeight) {\n      dimensionText += ` (natural: ${element.dimensions.naturalWidth}${element.dimensions.naturalHeight}px)`\n    }\n    elementDimensions.textContent = dimensionText\n  } else if (elementDimensions) {\n    elementDimensions.textContent = \"Unknown dimensions\"\n  }\n\n  // Update position\n  if (elementPosition && element.position) {\n    elementPosition.textContent = `${element.position.left || 0}, ${element.position.top || 0}px`\n  } else if (elementPosition) {\n    elementPosition.textContent = \"Unknown position\"\n  }\n\n  // Update classes\n  if (elementClassesContainer && elementClasses && element.classList && element.classList.length > 0) {\n    elementClassesContainer.style.display = \"block\"\n    elementClasses.textContent = element.classList.join(\" \")\n    elementClasses.title = element.classList.join(\" \")\n  } else if (elementClassesContainer) {\n    elementClassesContainer.style.display = \"none\"\n  }\n\n  // Update CSS selector\n  if (elementSelectorContainer && elementSelector && element.selector) {\n    elementSelectorContainer.style.display = \"block\"\n    elementSelector.textContent = element.selector\n    elementSelector.title = element.selector\n  } else if (elementSelectorContainer) {\n    elementSelectorContainer.style.display = \"none\"\n  }\n\n  // Update preview image with click functionality\n  if (elementImage) {\n    const imageUrl =\n      element.preview || element.primarySource || element.src || element.currentSrc || element.backgroundImageUrl\n\n    if (imageUrl) {\n      console.log(\"Setting CLS preview image:\", imageUrl)\n      elementImage.innerHTML = `\n        <img src=\"${imageUrl}\" \n             alt=\"CLS Element Preview\" \n             class=\"element-preview-img clickable-preview\" \n             title=\"Click to highlight this element on the page\"\n             crossorigin=\"anonymous\">\n      `\n\n      // Add click handler to highlight element\n      const previewImg = elementImage.querySelector(\".clickable-preview\")\n      if (previewImg) {\n        previewImg.addEventListener(\"click\", () => {\n          highlightCLSElementOnPage()\n        })\n\n        // Add error handling for image loading\n        previewImg.addEventListener(\"error\", () => {\n          console.log(\"CLS preview image failed to load\")\n          elementImage.innerHTML = '<div class=\"preview-placeholder\">Preview not available</div>'\n        })\n      }\n    } else {\n      console.log(\"No image URL available for CLS preview\")\n      elementImage.innerHTML = '<div class=\"preview-placeholder\">No preview available</div>'\n    }\n  }\n\n  // Make the entire preview clickable\n  const clsElementPreview = document.getElementById(\"clsElementPreview\")\n  if (clsElementPreview) {\n    clsElementPreview.style.cursor = \"pointer\"\n    clsElementPreview.title = \"Click to highlight this element on the page\"\n\n    // Remove existing click handlers\n    clsElementPreview.replaceWith(clsElementPreview.cloneNode(true))\n    const newPreview = document.getElementById(\"clsElementPreview\")\n\n    newPreview.addEventListener(\"click\", () => {\n      highlightCLSElementOnPage()\n    })\n  }\n}\n\n/**\n * Updates the LCP element preview with enhanced information\n * @param {Object} element - LCP element data\n */\nfunction updateLCPElementPreview(element) {\n  console.log(\"updateLCPElementPreview called with:\", element)\n\n  const elementTag = document.getElementById(\"lcpElementTag\")\n  const elementImage = document.getElementById(\"lcpElementImage\")\n  const elementDimensions = document.getElementById(\"lcpElementDimensions\")\n  const elementPosition = document.getElementById(\"lcpElementPosition\")\n  const elementSrcContainer = document.getElementById(\"lcpElementSrcContainer\")\n  const elementSrc = document.getElementById(\"lcpElementSrc\")\n  const elementTextContainer = document.getElementById(\"lcpElementText\")\n  const elementText = document.getElementById(\"lcpElementText\")\n  const elementClassesContainer = document.getElementById(\"lcpElementClassesContainer\")\n  const elementClasses = document.getElementById(\"lcpElementClasses\")\n\n  // Handle case where element data might be empty or incomplete\n  if (!element || Object.keys(element).length === 0) {\n    console.log(\"No element data available, showing placeholder\")\n    if (elementTag) elementTag.textContent = \"LCP Element\"\n    if (elementDimensions) elementDimensions.textContent = \"Analyzing...\"\n    if (elementPosition) elementPosition.textContent = \"Analyzing...\"\n    if (elementImage) {\n      elementImage.innerHTML = '<div class=\"preview-placeholder\">Analyzing LCP element...</div>'\n    }\n\n    // Hide optional sections\n    if (elementSrcContainer) elementSrcContainer.style.display = \"none\"\n    if (elementTextContainer) elementTextContainer.style.display = \"none\"\n    if (elementClassesContainer) elementClassesContainer.style.display = \"none\"\n    return\n  }\n\n  console.log(\"Updating LCP element preview with:\", element)\n\n  // Update element tag with more detailed information\n  if (elementTag) {\n    let tagDisplay = element.tagName ? element.tagName.toUpperCase() : \"ELEMENT\"\n    if (element.classList && element.classList.length > 0) {\n      tagDisplay += \".\" + element.classList[0]\n    } else if (element.id) {\n      tagDisplay += `#${element.id}`\n    }\n    elementTag.textContent = tagDisplay\n    elementTag.style.color = \"#007aff\" // Make it blue like in the screenshot\n  }\n\n  // Update dimensions with natural dimensions if available\n  if (elementDimensions && element.dimensions) {\n    let dimensionText = `${element.dimensions.width || 0}${element.dimensions.height || 0}px`\n    if (element.dimensions.naturalWidth && element.dimensions.naturalHeight) {\n      dimensionText += ` (natural: ${element.dimensions.naturalWidth}${element.dimensions.naturalHeight}px)`\n    }\n    elementDimensions.textContent = dimensionText\n  } else if (elementDimensions) {\n    elementDimensions.textContent = \"Unknown dimensions\"\n  }\n\n  // Update position\n  if (elementPosition && element.position) {\n    elementPosition.textContent = `${element.position.left || 0}, ${element.position.top || 0}px`\n  } else if (elementPosition) {\n    elementPosition.textContent = \"Unknown position\"\n  }\n\n  // Update classes\n  if (elementClassesContainer && elementClasses && element.classList && element.classList.length > 0) {\n    elementClassesContainer.style.display = \"block\"\n    elementClasses.textContent = element.classList.join(\" \")\n    elementClasses.title = element.classList.join(\" \")\n  } else if (elementClassesContainer) {\n    elementClassesContainer.style.display = \"none\"\n  }\n\n  // Update source with primary source\n  if (element.primarySource || element.src || element.currentSrc || element.backgroundImageUrl) {\n    const sourceUrl = element.primarySource || element.src || element.currentSrc || element.backgroundImageUrl\n    if (elementSrcContainer && elementSrc) {\n      elementSrcContainer.style.display = \"block\"\n      const displaySrc = sourceUrl.length > 60 ? sourceUrl.substring(0, 60) + \"...\" : sourceUrl\n      elementSrc.textContent = displaySrc\n      elementSrc.title = sourceUrl\n    }\n  } else if (elementSrcContainer) {\n    elementSrcContainer.style.display = \"none\"\n  }\n\n  // Update text content\n  if (element.textContent && element.textContent.trim()) {\n    if (elementTextContainer && elementText) {\n      elementTextContainer.style.display = \"block\"\n      const displayText =\n        element.textContent.length > 60 ? element.textContent.substring(0, 60) + \"...\" : element.textContent\n      elementText.textContent = displayText\n      elementText.title = element.textContent\n    }\n  } else if (elementTextContainer) {\n    elementTextContainer.style.display = \"none\"\n  }\n\n  // Update preview image with click functionality\n  if (elementImage) {\n    const imageUrl =\n      element.preview || element.primarySource || element.src || element.currentSrc || element.backgroundImageUrl\n\n    if (imageUrl) {\n      console.log(\"Setting LCP preview image:\", imageUrl)\n      elementImage.innerHTML = `\n        <img src=\"${imageUrl}\" \n             alt=\"LCP Element Preview\" \n             class=\"element-preview-img clickable-preview\" \n             title=\"Click to highlight this element on the page\"\n             crossorigin=\"anonymous\">\n      `\n\n      // Add click handler to highlight element\n      const previewImg = elementImage.querySelector(\".clickable-preview\")\n      if (previewImg) {\n        previewImg.addEventListener(\"click\", () => {\n          highlightLCPElementOnPage()\n        })\n\n        // Add error handling for image loading\n        previewImg.addEventListener(\"error\", () => {\n          console.log(\"LCP preview image failed to load\")\n          elementImage.innerHTML = '<div class=\"preview-placeholder\">Preview not available</div>'\n        })\n      }\n    } else {\n      console.log(\"No image URL available for LCP preview\")\n      elementImage.innerHTML = '<div class=\"preview-placeholder\">No preview available</div>'\n    }\n  }\n\n  // Make the entire preview clickable\n  const lcpElementPreview = document.getElementById(\"lcpElementPreview\")\n  if (lcpElementPreview) {\n    lcpElementPreview.style.cursor = \"pointer\"\n    lcpElementPreview.title = \"Click to highlight this element on the page\"\n\n    // Remove existing click handlers\n    lcpElementPreview.replaceWith(lcpElementPreview.cloneNode(true))\n    const newPreview = document.getElementById(\"lcpElementPreview\")\n\n    newPreview.addEventListener(\"click\", () => {\n      highlightLCPElementOnPage()\n    })\n  }\n}\n\n/**\n * Updates the INP element preview with enhanced information\n * @param {Object} element - INP element data\n * @param {Object} interaction - Interaction entry data\n */\nfunction updateINPElementPreview(element, interaction) {\n  console.log(\"updateINPElementPreview called with:\", element, interaction)\n\n  const elementTag = document.getElementById(\"inpElementTag\")\n  const elementImage = document.getElementById(\"inpElementImage\")\n  const elementDimensions = document.getElementById(\"inpElementDimensions\")\n  const elementPosition = document.getElementById(\"inpElementPosition\")\n  const elementClassesContainer = document.getElementById(\"inpElementClassesContainer\")\n  const elementClasses = document.getElementById(\"inpElementClasses\")\n  const interactionTypeContainer = document.getElementById(\"inpInteractionTypeContainer\")\n  const interactionType = document.getElementById(\"inpInteractionType\")\n  const interactionDuration = document.getElementById(\"inpInteractionDuration\")\n\n  // Handle case where element data might be empty or incomplete\n  if (!element || Object.keys(element).length === 0) {\n    console.log(\"No INP element data available, showing interaction info\")\n    if (elementTag) elementTag.textContent = `${interaction.target || \"Element\"} (${interaction.name})`\n    if (interactionDuration) interactionDuration.textContent = `${interaction.duration}ms`\n    if (elementDimensions) elementDimensions.textContent = \"Element details not available\"\n    if (elementPosition) elementPosition.textContent = \"Position not available\"\n    if (elementImage) {\n      elementImage.innerHTML = '<div class=\"preview-placeholder\">No element preview available</div>'\n    }\n\n    // Hide optional sections\n    if (elementClassesContainer) elementClassesContainer.style.display = \"none\"\n    if (interactionTypeContainer) interactionTypeContainer.style.display = \"none\"\n    return\n  }\n\n  console.log(\"Updating INP element preview with:\", element)\n\n  // Update element tag with more detailed information\n  if (elementTag) {\n    let tagDisplay = element.tagName ? element.tagName.toUpperCase() : \"ELEMENT\"\n    if (element.classList && element.classList.length > 0) {\n      tagDisplay += \".\" + element.classList[0]\n    } else if (element.id) {\n      tagDisplay += `#${element.id}`\n    }\n    elementTag.textContent = tagDisplay\n    elementTag.style.color = \"#ff6b35\" // Orange-red color for INP\n  }\n\n  // Update interaction duration\n  if (interactionDuration) {\n    interactionDuration.textContent = `${interaction.duration}ms`\n  }\n\n  // Update dimensions\n  if (elementDimensions && element.dimensions) {\n    const dimensionText = `${element.dimensions.width || 0}${element.dimensions.height || 0}px`\n    elementDimensions.textContent = dimensionText\n  } else if (elementDimensions) {\n    elementDimensions.textContent = \"Unknown dimensions\"\n  }\n\n  // Update position\n  if (elementPosition && element.position) {\n    elementPosition.textContent = `${element.position.left || 0}, ${element.position.top || 0}px`\n  } else if (elementPosition) {\n    elementPosition.textContent = \"Unknown position\"\n  }\n\n  // Update classes\n  if (elementClassesContainer && elementClasses && element.classList && element.classList.length > 0) {\n    elementClassesContainer.style.display = \"block\"\n    elementClasses.textContent = element.classList.join(\" \")\n    elementClasses.title = element.classList.join(\" \")\n  } else if (elementClassesContainer) {\n    elementClassesContainer.style.display = \"none\"\n  }\n\n  // Update interaction type\n  if (interactionTypeContainer && interactionType) {\n    interactionTypeContainer.style.display = \"block\"\n    interactionType.textContent = interaction.name || \"unknown\"\n  } else if (interactionTypeContainer) {\n    interactionTypeContainer.style.display = \"none\"\n  }\n\n  // Update preview image with click functionality\n  if (elementImage) {\n    const imageUrl = element.preview || element.src || element.currentSrc\n\n    if (imageUrl) {\n      console.log(\"Setting INP preview image:\", imageUrl)\n      elementImage.innerHTML = `\n        <img src=\"${imageUrl}\" \n             alt=\"INP Element Preview\" \n             class=\"element-preview-img clickable-preview\" \n             title=\"Click to highlight this element on the page\"\n             crossorigin=\"anonymous\">\n      `\n\n      // Add click handler to highlight element\n      const previewImg = elementImage.querySelector(\".clickable-preview\")\n      if (previewImg) {\n        previewImg.addEventListener(\"click\", () => {\n          highlightINPElementOnPage()\n        })\n\n        // Add error handling for image loading\n        previewImg.addEventListener(\"error\", () => {\n          console.log(\"INP preview image failed to load\")\n          elementImage.innerHTML = '<div class=\"preview-placeholder\">Preview not available</div>'\n        })\n      }\n    } else {\n      console.log(\"No image URL available for INP preview\")\n      elementImage.innerHTML = '<div class=\"preview-placeholder\">No preview available</div>'\n    }\n  }\n\n  // Make the entire preview clickable\n  const inpElementPreview = document.getElementById(\"inpElementPreview\")\n  if (inpElementPreview) {\n    inpElementPreview.style.cursor = \"pointer\"\n    inpElementPreview.title = \"Click to highlight this element on the page\"\n\n    // Remove existing click handlers\n    inpElementPreview.replaceWith(inpElementPreview.cloneNode(true))\n    const newPreview = document.getElementById(\"inpElementPreview\")\n\n    newPreview.addEventListener(\"click\", () => {\n      highlightINPElementOnPage()\n    })\n  }\n}\n\n/**\n * Highlights the INP element on the page\n */\nasync function highlightINPElementOnPage() {\n  console.log(\"highlightINPElementOnPage called\")\n\n  const inpElementPreview = document.getElementById(\"inpElementPreview\")\n\n  try {\n    // Use the improved getTargetTabId function that auto-detects mode\n    const targetTabId = await getTargetTabId()\n    console.log(\"Target tab ID for INP highlighting:\", targetTabId)\n\n    if (!targetTabId) {\n      console.log(\"No target tab available for INP highlighting\")\n      if (inpElementPreview) {\n        showElementFeedback(inpElementPreview, \"error\")\n      }\n      return false\n    }\n\n    // Show immediate feedback\n    if (inpElementPreview) {\n      showElementFeedback(inpElementPreview, \"success\")\n    }\n\n    const response = await sendMessageToContentScript(targetTabId, {\n      action: \"highlightINPElement\",\n    })\n\n    console.log(\"INP highlight response:\", response)\n    return !!response\n  } catch (error) {\n    console.error(\"Error highlighting INP element:\", error)\n    if (inpElementPreview) {\n      showElementFeedback(inpElementPreview, \"error\")\n    }\n    return false\n  }\n}\n\n/**\n * Highlights the CLS element on the page\n */\nasync function highlightCLSElementOnPage() {\n  console.log(\"highlightCLSElementOnPage called\")\n\n  const clsElementPreview = document.getElementById(\"clsElementPreview\")\n\n  try {\n    // Use the improved getTargetTabId function that auto-detects mode\n    const targetTabId = await getTargetTabId()\n    console.log(\"Target tab ID for CLS highlighting:\", targetTabId)\n\n    if (!targetTabId) {\n      console.log(\"No target tab available for CLS highlighting\")\n      if (clsElementPreview) {\n        showElementFeedback(clsElementPreview, \"error\")\n      }\n      return false\n    }\n\n    // Show immediate feedback\n    if (clsElementPreview) {\n      showElementFeedback(clsElementPreview, \"success\")\n    }\n\n    const response = await sendMessageToContentScript(targetTabId, {\n      action: \"highlightCLSElement\",\n    })\n\n    console.log(\"CLS highlight response:\", response)\n    return !!response\n  } catch (error) {\n    console.error(\"Error highlighting CLS element:\", error)\n    if (clsElementPreview) {\n      showElementFeedback(clsElementPreview, \"error\")\n    }\n    return false\n  }\n}\n\n/**\n * Highlights the LCP element on the page\n */\nasync function highlightLCPElementOnPage() {\n  console.log(\"highlightLCPElementOnPage called\")\n\n  const lcpElementPreview = document.getElementById(\"lcpElementPreview\")\n\n  try {\n    // Use the improved getTargetTabId function that auto-detects mode\n    const targetTabId = await getTargetTabId()\n    console.log(\"Target tab ID for LCP highlighting:\", targetTabId)\n\n    if (!targetTabId) {\n      console.log(\"No target tab available for LCP highlighting\")\n      if (lcpElementPreview) {\n        showElementFeedback(lcpElementPreview, \"error\")\n      }\n      return false\n    }\n\n    // Show immediate feedback\n    if (lcpElementPreview) {\n      showElementFeedback(lcpElementPreview, \"success\")\n    }\n\n    const response = await sendMessageToContentScript(targetTabId, {\n      action: \"highlightLCPElement\",\n    })\n\n    console.log(\"LCP highlight response:\", response)\n    return !!response\n  } catch (error) {\n    console.error(\"Error highlighting LCP element:\", error)\n    if (lcpElementPreview) {\n      showElementFeedback(lcpElementPreview, \"error\")\n    }\n    return false\n  }\n}\n\n/**\n * Updates threshold indicators with correct Core Web Vitals ranges\n * Now supports combination indicators when values are close (within tolerance)\n */\nfunction updateMetricThresholds(metric, value, isField = false, isLab = false) {\n  const threshold = THRESHOLDS[metric]\n  if (!threshold || value === null || value === undefined) return\n\n  const bar = document.querySelector(`.${metric}-bar`)\n  if (!bar) return\n\n  // Calculate position based on threshold ranges\n  let percentage = 0\n  const maxValue = threshold.needsImprovement * 2 // Extended range for visualization\n\n  if (metric === \"cls\") {\n    // CLS uses different scale (0-1 range)\n    percentage = Math.min((value / 0.5) * 100, 100)\n  } else {\n    // Time-based metrics (ms)\n    percentage = Math.min((value / maxValue) * 100, 100)\n  }\n\n  // Determine indicator type and data label\n  let dataType = \"local\"\n  let dataLabel = \"Local\"\n\n  if (isLab) {\n    dataType = \"lab\"\n    dataLabel = \"Lab\"\n  } else if (isField) {\n    dataType = \"field\"\n    dataLabel = \"Field\"\n  }\n\n  // Get current metric values for combination checking\n  const localValue = insightsState.metrics[metric].local\n  const fieldValue = insightsState.metrics[metric].field\n  const labValue = insightsState.metrics[metric].lab\n\n  // Define tolerance for \"close enough\" values (0% to 0.1% tolerance)\n  const tolerance = calculateTolerance(metric, value)\n\n  // Check for matching values within tolerance\n  const localFieldMatch = localValue !== null && fieldValue !== null && Math.abs(localValue - fieldValue) <= tolerance\n  const localLabMatch = localValue !== null && labValue !== null && Math.abs(localValue - labValue) <= tolerance\n  const fieldLabMatch = fieldValue !== null && labValue !== null && Math.abs(fieldValue - labValue) <= tolerance\n  const allMatch =\n    localValue !== null && fieldValue !== null && labValue !== null && localFieldMatch && localLabMatch && fieldLabMatch\n\n  // Remove all existing indicators for this metric to avoid duplicates\n  const existingIndicators = bar.querySelectorAll(\".threshold-indicator\")\n  existingIndicators.forEach((indicator) => indicator.remove())\n\n  // Create indicators based on combinations and individual values\n  const indicatorsToCreate = new Set()\n\n  if (allMatch) {\n    // All three sources match - show single combination indicator\n    const indicator = document.createElement(\"div\")\n    indicator.className = `threshold-indicator all-sources-indicator`\n    indicator.style.left = `${percentage}%`\n    indicator.setAttribute(\"data-type\", \"all-sources-indicator\")\n    indicator.setAttribute(\"data-metric\", metric)\n    indicator.setAttribute(\"data-value\", value)\n    indicator.setAttribute(\"data-position\", percentage.toFixed(2))\n    indicator.title = `All Sources Match: ${formatMetricValue(metric, value)}`\n    bar.appendChild(indicator)\n    console.log(`Added all-sources combination indicator for ${metric} at ${percentage}%`)\n  } else {\n    // Handle partial matches and individual indicators\n    if (localFieldMatch && localValue !== null && fieldValue !== null) {\n      // Local and Field match - create combination indicator\n      const localPercentage = calculateIndicatorPosition(metric, localValue)\n      const indicator = document.createElement(\"div\")\n      indicator.className = `threshold-indicator local-field-indicator`\n      indicator.style.left = `${localPercentage}%`\n      indicator.setAttribute(\"data-type\", \"local-field-indicator\")\n      indicator.setAttribute(\"data-metric\", metric)\n      indicator.setAttribute(\"data-value\", localValue)\n      indicator.setAttribute(\"data-position\", localPercentage.toFixed(2))\n      indicator.title = `Local + Field Match: ${formatMetricValue(metric, localValue)}`\n      bar.appendChild(indicator)\n\n      // Add lab indicator separately if it exists and doesn't match\n      if (labValue !== null && !localLabMatch) {\n        createIndividualIndicator(bar, metric, labValue, \"lab\", \"Lab\")\n      }\n    } else if (localLabMatch && localValue !== null && labValue !== null) {\n      // Local and Lab match - create combination indicator\n      const localPercentage = calculateIndicatorPosition(metric, localValue)\n      const indicator = document.createElement(\"div\")\n      indicator.className = `threshold-indicator local-lab-indicator`\n      indicator.style.left = `${localPercentage}%`\n      indicator.setAttribute(\"data-type\", \"local-lab-indicator\")\n      indicator.setAttribute(\"data-metric\", metric)\n      indicator.setAttribute(\"data-value\", localValue)\n      indicator.setAttribute(\"data-position\", localPercentage.toFixed(2))\n      indicator.title = `Local + Lab Match: ${formatMetricValue(metric, localValue)}`\n      bar.appendChild(indicator)\n\n      // Add field indicator separately if it exists and doesn't match\n      if (fieldValue !== null && !localFieldMatch) {\n        createIndividualIndicator(bar, metric, fieldValue, \"field\", \"Field\")\n      }\n    } else if (fieldLabMatch && fieldValue !== null && labValue !== null) {\n      // Field and Lab match - create combination indicator\n      const fieldPercentage = calculateIndicatorPosition(metric, fieldValue)\n      const indicator = document.createElement(\"div\")\n      indicator.className = `threshold-indicator field-lab-indicator`\n      indicator.style.left = `${fieldPercentage}%`\n      indicator.setAttribute(\"data-type\", \"field-lab-indicator\")\n      indicator.setAttribute(\"data-metric\", metric)\n      indicator.setAttribute(\"data-value\", fieldValue)\n      indicator.setAttribute(\"data-position\", fieldPercentage.toFixed(2))\n      indicator.title = `Field + Lab Match: ${formatMetricValue(metric, fieldValue)}`\n      bar.appendChild(indicator)\n\n      // Add local indicator separately if it exists and doesn't match\n      if (localValue !== null && !localFieldMatch) {\n        createIndividualIndicator(bar, metric, localValue, \"local\", \"Local\")\n      }\n    } else {\n      // No matches - create individual indicators for all available sources\n      if (localValue !== null) {\n        createIndividualIndicator(bar, metric, localValue, \"local\", \"Local\")\n      }\n      if (fieldValue !== null) {\n        createIndividualIndicator(bar, metric, fieldValue, \"field\", \"Field\")\n      }\n      if (labValue !== null && (metric === \"cls\" || metric === \"lcp\")) {\n        createIndividualIndicator(bar, metric, labValue, \"lab\", \"Lab\")\n      }\n    }\n  }\n\n  // Smart positioning logic for multiple indicators\n  const allIndicators = bar.querySelectorAll(\".threshold-indicator\")\n  if (allIndicators.length > 1) {\n    bar.classList.add(\"multiple-indicators\")\n    positionIndicatorsIntelligently(bar, allIndicators)\n  } else {\n    bar.classList.remove(\"multiple-indicators\")\n  }\n}\n\n/**\n * Calculate tolerance based on metric type and value\n * 0% to 0.1% tolerance as requested\n */\nfunction calculateTolerance(metric, value) {\n  if (metric === \"cls\") {\n    // For CLS, 0.1% of typical range (0-0.5)\n    return Math.max(0.0005, value * 0.001) // Minimum 0.0005, or 0.1% of value\n  } else {\n    // For time-based metrics, 0.1% of value with minimum 1ms\n    return Math.max(1, value * 0.001) // Minimum 1ms, or 0.1% of value\n  }\n}\n\n/**\n * Calculate indicator position on the threshold bar\n */\nfunction calculateIndicatorPosition(metric, value) {\n  const threshold = THRESHOLDS[metric]\n  if (!threshold) return 0\n\n  const maxValue = threshold.needsImprovement * 2\n\n  if (metric === \"cls\") {\n    return Math.min((value / 0.5) * 100, 100)\n  } else {\n    return Math.min((value / maxValue) * 100, 100)\n  }\n}\n\n/**\n * Create individual indicator for a specific data source\n */\nfunction createIndividualIndicator(bar, metric, value, dataType, dataLabel) {\n  const threshold = THRESHOLDS[metric]\n  if (!threshold) return\n\n  // Calculate position\n  let percentage = 0\n  const maxValue = threshold.needsImprovement * 2\n\n  if (metric === \"cls\") {\n    percentage = Math.min((value / 0.5) * 100, 100)\n  } else {\n    percentage = Math.min((value / maxValue) * 100, 100)\n  }\n\n  const indicator = document.createElement(\"div\")\n  indicator.className = `threshold-indicator ${dataType}-indicator`\n  indicator.style.left = `${percentage}%`\n  indicator.setAttribute(\"data-type\", dataType)\n  indicator.setAttribute(\"data-metric\", metric)\n  indicator.setAttribute(\"data-value\", value)\n  indicator.setAttribute(\"data-position\", percentage.toFixed(2))\n  indicator.title = `${dataLabel}: ${formatMetricValue(metric, value)}`\n\n  bar.appendChild(indicator)\n}\n\n/**\n * Intelligently positions indicators to handle overlaps and same-position stacking\n */\nfunction positionIndicatorsIntelligently(bar, indicators) {\n  // Group indicators by position (within 1% tolerance for same position)\n  const positionGroups = new Map()\n\n  indicators.forEach((indicator) => {\n    const position = Number.parseFloat(indicator.getAttribute(\"data-position\"))\n    let foundGroup = false\n\n    // Check if this position is close to any existing group\n    for (const [groupPos, group] of positionGroups) {\n      if (Math.abs(position - groupPos) <= 1) {\n        group.push(indicator)\n        foundGroup = true\n        break\n      }\n    }\n\n    if (!foundGroup) {\n      positionGroups.set(position, [indicator])\n    }\n  })\n\n  // Position indicators within each group\n  positionGroups.forEach((group, position) => {\n    if (group.length === 1) {\n      // Single indicator - normal positioning\n      const indicator = group[0]\n      indicator.style.left = `${position}%`\n      indicator.style.top = \"-5px\" // Updated position\n      indicator.style.zIndex = \"10\"\n    } else {\n      // Multiple indicators at same position - stack them\n      group.forEach((indicator, index) => {\n        const dataType = indicator.getAttribute(\"data-type\")\n\n        // Vertical stacking with slight horizontal offset for visibility\n        const verticalOffset = index * 8 // 8px vertical spacing\n        const horizontalOffset = index * 2 // 2px horizontal offset for better visibility\n\n        indicator.style.left = `calc(${position}% + ${horizontalOffset}px)`\n        indicator.style.top = `${-5 - verticalOffset}px` // Updated position\n        indicator.style.zIndex = `${15 + index}` // Higher z-index for stacked items\n\n        // Add stacked class for special styling\n        indicator.classList.add(\"stacked-indicator\")\n      })\n    }\n  })\n}\n\n// Initialize PSI button when the module loads\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  setupPSIAnalyzeButton()\n})\n\n// Also export the setup function so it can be called from other modules\nexport { setupPSIAnalyzeButton, resetDataAvailability }\n\n// Export the state management function\nexport { updateInsightsState }\n\n// Ensure PSI button is set up when module loads\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", setupPSIAnalyzeButton)\n} else {\n  setupPSIAnalyzeButton()\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Module for handling image display in the popup\n */\n\n// Import the simplified helpers\nimport { sendMessageToContentScript, showElementFeedback } from \"../../utils/tab-helpers.js\"\n\n/**\n * Updates the image display with analysis results\n * @param {Array} images - Array of image data\n */\nexport function updateImageDisplay(images) {\n  const imageInfo = document.getElementById(\"imageInfo\")\n  const imageCountEl = document.getElementById(\"imageCount\")\n  const imageList = document.getElementById(\"imageList\")\n\n  // Add margin if no button is present\n  if (imageInfo) imageInfo.style.marginTop = \"0px\"\n\n  const totalImages = images.length\n  imageCountEl.textContent = `Found ${totalImages} preloaded image${totalImages !== 1 ? \"s\" : \"\"}`\n  imageList.innerHTML = \"\"\n\n  if (totalImages === 0) {\n    imageInfo.style.display = \"block\"\n    const p = document.createElement(\"p\")\n    p.textContent = \"No preloaded images detected on this page.\"\n    p.className = \"empty-state-message\"\n    imageList.appendChild(p)\n    return\n  }\n\n  images.forEach((image) => {\n    const li = createImageListItem(image)\n    imageList.appendChild(li)\n  })\n\n  imageInfo.style.display = \"block\"\n}\n\n/**\n * Creates a list item for an image\n * @param {Object} image - Image data object\n * @returns {HTMLElement} The created list item\n */\nfunction createImageListItem(image) {\n  const li = document.createElement(\"li\")\n  li.className = \"image-list-item\"\n  li.style.cursor = \"pointer\"\n  li.title = \"Click to highlight this image on the page\"\n\n  // Add click handler to highlight image on page\n  li.addEventListener(\"click\", async () => {\n    // Get the target tab ID (handles detached mode)\n    const targetTabId = await window.getTargetTabId()\n\n    if (!targetTabId) {\n      console.log(\"No target tab available for image highlighting\")\n      showElementFeedback(li, \"error\")\n      return\n    }\n\n    // Show immediate feedback\n    showElementFeedback(li, \"success\")\n\n    const response = await sendMessageToContentScript(targetTabId, {\n      action: \"highlightImage\",\n      imageUrl: image.url,\n    })\n\n    if (!response) {\n      console.log(\"Failed to highlight image\")\n    }\n  })\n\n  const imgContainer = createImageContainer(image)\n  const infoContainer = createImageInfoContainer(image)\n\n  li.appendChild(imgContainer)\n  li.appendChild(infoContainer)\n\n  return li\n}\n\n/**\n * Creates the image container with thumbnail\n * @param {Object} image - Image data object\n * @returns {HTMLElement} The image container\n */\nfunction createImageContainer(image) {\n  const imgContainer = document.createElement(\"div\")\n  imgContainer.className = \"img-container\"\n\n  const img = document.createElement(\"img\")\n  img.alt = image.url.substring(image.url.lastIndexOf(\"/\") + 1)\n  img.crossOrigin = \"anonymous\"\n\n  const fallbackIcon = document.createElement(\"div\")\n  fallbackIcon.className = \"fallback-icon\"\n  fallbackIcon.innerHTML =\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/><circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"/><polyline points=\"21 15 16 10 5 21\"/></svg>'\n\n  img.onload = () => {\n    img.style.display = \"block\"\n    fallbackIcon.style.display = \"none\"\n  }\n  img.onerror = () => {\n    img.style.display = \"none\"\n    fallbackIcon.style.display = \"flex\"\n  }\n  img.src = image.url\n\n  imgContainer.appendChild(img)\n  imgContainer.appendChild(fallbackIcon)\n\n  return imgContainer\n}\n\n/**\n * Creates the image info container with details and status indicators\n * @param {Object} image - Image data object\n * @returns {HTMLElement} The info container\n */\nfunction createImageInfoContainer(image) {\n  const infoContainer = document.createElement(\"div\")\n  infoContainer.className = \"info-container\"\n\n  const urlSpan = document.createElement(\"span\")\n  urlSpan.className = \"url\"\n  urlSpan.textContent = image.url\n  infoContainer.appendChild(urlSpan)\n\n  const detailsSpan = createImageDetailsSpan(image)\n  infoContainer.appendChild(detailsSpan)\n\n  const statusContainer = createImageStatusContainer(image)\n  infoContainer.appendChild(statusContainer)\n\n  return infoContainer\n}\n\n/**\n * Creates the details span for an image\n * @param {Object} image - Image data object\n * @returns {HTMLElement} The details span\n */\nfunction createImageDetailsSpan(image) {\n  const detailsSpan = document.createElement(\"span\")\n  detailsSpan.className = \"details\"\n  const details = []\n\n  // Add enhanced details\n  if (image.aboveFold !== undefined) {\n    details.push(image.aboveFold ? \"Above fold\" : \"Below fold\")\n  }\n  if (image.format) details.push(`Format: ${image.format}`)\n  if (image.fileSizeFormatted) details.push(`Size: ${image.fileSizeFormatted}`)\n  if (image.dimensions?.displayed) {\n    details.push(`${image.dimensions.displayed.width}${image.dimensions.displayed.height}px`)\n  }\n  if (image.type) details.push(`Type: ${image.type}`)\n  if (image.loading && image.loading !== \"auto\") details.push(`Loading: ${image.loading}`)\n\n  detailsSpan.textContent = details.length > 0 ? details.join(\" | \") : \"No additional details\"\n  return detailsSpan\n}\n\n/**\n * Creates the status container with status indicators\n * @param {Object} image - Image data object\n * @returns {HTMLElement} The status container\n */\nfunction createImageStatusContainer(image) {\n  const statusContainer = document.createElement(\"div\")\n  statusContainer.className = \"status-container\"\n\n  // Critical Path indicator (most important)\n  if (image.isCritical !== undefined) {\n    const criticalSticker = document.createElement(\"span\")\n    criticalSticker.textContent = image.isCritical ? \"CRITICAL PATH\" : \"NON-CRITICAL\"\n    criticalSticker.className = image.isCritical ? \"status-sticker critical-path\" : \"status-sticker non-critical\"\n    statusContainer.appendChild(criticalSticker)\n  }\n\n  // Above/Below fold indicator\n  if (image.aboveFold !== undefined) {\n    const foldSticker = document.createElement(\"span\")\n    foldSticker.textContent = image.aboveFold ? \"ABOVE FOLD\" : \"BELOW FOLD\"\n    foldSticker.className = image.aboveFold ? \"status-sticker above-fold\" : \"status-sticker below-fold\"\n    statusContainer.appendChild(foldSticker)\n  }\n\n  return statusContainer\n}\n","/**\n * Module for handling font display in the popup\n */\n\n/**\n * Updates the font display with analysis results\n * @param {Array} fonts - Array of font data\n */\nexport function updateFontDisplay(fonts) {\n  const fontInfo = document.getElementById(\"fontInfo\")\n  const fontCountEl = document.getElementById(\"fontCount\")\n  const fontList = document.getElementById(\"fontList\")\n\n  // Add margin if no button is present\n  if (fontInfo) fontInfo.style.marginTop = \"0px\"\n\n  const totalFonts = fonts.length\n  fontCountEl.textContent = `Found ${totalFonts} font${totalFonts !== 1 ? \"s\" : \"\"} loaded`\n  fontList.innerHTML = \"\"\n\n  if (totalFonts === 0) {\n    fontInfo.style.display = \"block\"\n    const p = document.createElement(\"p\")\n    p.textContent = \"No fonts detected loading on this page.\"\n    p.className = \"empty-state-message\"\n    fontList.appendChild(p)\n    return\n  }\n\n  fonts.forEach((font, index) => {\n    const li = createFontListItem(font, index)\n    fontList.appendChild(li)\n  })\n\n  fontInfo.style.display = \"block\"\n}\n\n/**\n * Creates a list item for a font\n * @param {Object} font - Font data object\n * @param {number} index - Font index\n * @returns {HTMLElement} The created list item\n */\nfunction createFontListItem(font, index) {\n  const li = document.createElement(\"li\")\n  li.className = \"card-style font-list-item\"\n\n  const numberBadge = document.createElement(\"div\")\n  numberBadge.className = \"font-list-item-badge\"\n  numberBadge.textContent = index + 1\n\n  const contentContainer = createFontContentContainer(font)\n\n  li.appendChild(numberBadge)\n  li.appendChild(contentContainer)\n\n  return li\n}\n\n/**\n * Creates the content container for a font\n * @param {Object} font - Font data object\n * @returns {HTMLElement} The content container\n */\nfunction createFontContentContainer(font) {\n  const contentContainer = document.createElement(\"div\")\n  contentContainer.className = \"font-list-item-content\"\n\n  const urlContainer = createFontUrlContainer(font)\n  contentContainer.appendChild(urlContainer)\n\n  const statusContainer = createFontStatusContainer(font)\n  contentContainer.appendChild(statusContainer)\n\n  return contentContainer\n}\n\n/**\n * Creates the URL container with copy button\n * @param {Object} font - Font data object\n * @returns {HTMLElement} The URL container\n */\nfunction createFontUrlContainer(font) {\n  const urlContainer = document.createElement(\"div\")\n  urlContainer.className = \"url-container\"\n\n  const urlSpan = document.createElement(\"span\")\n  urlSpan.className = \"font-url\"\n  urlSpan.textContent = font.url\n  urlSpan.title = font.url\n\n  const copyButton = createCopyButton(font.url)\n\n  urlContainer.appendChild(urlSpan)\n  urlContainer.appendChild(copyButton)\n\n  return urlContainer\n}\n\n/**\n * Creates a copy button for a URL\n * @param {string} url - The URL to copy\n * @returns {HTMLElement} The copy button\n */\nfunction createCopyButton(url) {\n  const copyButton = document.createElement(\"button\")\n  copyButton.className = \"copy-button icon-button-sm\"\n  copyButton.title = \"Copy URL\"\n\n  const originalCopyIcon =\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>'\n  const copiedIcon =\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>'\n\n  copyButton.innerHTML = originalCopyIcon\n\n  copyButton.onclick = (e) => {\n    e.stopPropagation()\n    navigator.clipboard.writeText(url).then(() => {\n      copyButton.innerHTML = copiedIcon\n      copyButton.classList.add(\"copied-feedback\")\n      setTimeout(() => {\n        copyButton.innerHTML = originalCopyIcon\n        copyButton.classList.remove(\"copied-feedback\")\n      }, 1200)\n    })\n  }\n\n  return copyButton\n}\n\n/**\n * Creates the status container with status indicators\n * @param {Object} font - Font data object\n * @returns {HTMLElement} The status container\n */\nfunction createFontStatusContainer(font) {\n  const statusContainer = document.createElement(\"div\")\n  statusContainer.className = \"status-container\"\n\n  // Font type sticker\n  if (font.type) {\n    const typeSticker = document.createElement(\"span\")\n    typeSticker.textContent = font.type\n    typeSticker.className = `status-sticker font-type font-type-${font.type.toLowerCase()}`\n    statusContainer.appendChild(typeSticker)\n  }\n\n  // Preload status sticker\n  const preloadedSticker = document.createElement(\"span\")\n  preloadedSticker.textContent = font.preloaded ? \"PRELOADED\" : \"NOT PRELOADED\"\n  preloadedSticker.className = font.preloaded ? \"status-sticker preloaded\" : \"status-sticker not-preloaded\"\n  statusContainer.appendChild(preloadedSticker)\n\n  return statusContainer\n}\n","/**\n * Formats a file size in bytes to a human-readable string\n * @param {number} bytes - The size in bytes\n * @returns {string} Formatted size string (e.g., \"1.5 KB\")\n */\nexport function formatFileSize(bytes) {\n  if (!bytes) return \"Unknown\"\n  if (bytes < 1024) return bytes + \" B\"\n  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + \" KB\"\n  return (bytes / (1024 * 1024)).toFixed(1) + \" MB\"\n}\n\n/**\n * Gets the appropriate background color for a header value\n * @param {string} headerKey - The header key\n * @param {string} value - The header value\n * @returns {string} CSS color value\n */\nexport function getHeaderColor(headerKey, value) {\n  const lowerValue = typeof value === \"string\" ? value.toLowerCase().trim() : \"n/a\"\n  const saneKey = typeof headerKey === \"string\" ? headerKey.toLowerCase().replace(/-/g, \"\") : \"\"\n\n  switch (saneKey) {\n    case \"xbigscootscachestatus\":\n    case \"cfcachestatus\":\n      return getCacheStatusColor(lowerValue)\n    case \"xbigscootscacheplan\":\n      return getCachePlanColor(lowerValue)\n    case \"xbigscootscachemode\":\n    case \"xbigscootscachemodeo2o\":\n      return getEnabledDisabledColor(lowerValue === \"enabled\" || lowerValue === \"true\", lowerValue === \"n/a\")\n    case \"xezoiccdn\":\n      if (lowerValue === \"hit\") return \"var(--success-bg-strong)\"\n      if (lowerValue === \"n/a\" || lowerValue === \"\") return \"var(--neutral-bg)\"\n      return \"var(--error-bg-strong)\"\n    case \"xnpcfe\":\n      if (lowerValue && lowerValue !== \"n/a\" && lowerValue !== \"disabled\" && lowerValue !== \"inactive\")\n        return \"var(--success-bg-strong)\"\n      if (lowerValue === \"n/a\" || lowerValue === \"\") return \"var(--neutral-bg)\"\n      return \"var(--error-bg-strong)\"\n    case \"perfmattersrucss\":\n    case \"perfmattersdelayjs\":\n      return getEnabledDisabledColor(lowerValue === \"enabled\", lowerValue === \"n/a\")\n    case \"xhostedby\":\n      return lowerValue && lowerValue !== \"n/a\" && lowerValue.trim() !== \"\"\n        ? \"var(--info-bg-strong)\"\n        : \"var(--neutral-bg)\"\n    case \"contentencoding\":\n      return lowerValue && lowerValue !== \"n/a\" && lowerValue.trim() !== \"\"\n        ? \"var(--info-bg-strong)\"\n        : \"var(--neutral-bg)\"\n    case \"gtm\":\n    case \"ua\":\n    case \"ga4\":\n    case \"ga\":\n      return lowerValue && lowerValue !== \"n/a\" && lowerValue.trim() !== \"\"\n        ? \"var(--warning-bg-strong)\"\n        : \"var(--neutral-bg)\"\n    case \"adprovider\":\n      if (lowerValue === \"none detected\" || lowerValue === \"n/a\" || lowerValue === \"\") return \"var(--neutral-bg)\"\n      return \"var(--success-bg-strong)\"\n    default:\n      return \"var(--neutral-bg)\"\n  }\n}\n\n/**\n * Gets the color for a cache status value\n * @param {string} status - The cache status\n * @returns {string} CSS color value\n */\nfunction getCacheStatusColor(status) {\n  switch (status) {\n    case \"hit\":\n      return \"var(--success-bg-strong)\"\n    case \"miss\":\n      return \"var(--error-bg-strong)\"\n    case \"bypass\":\n      return \"var(--warning-bg-strong)\"\n    case \"dynamic\":\n      return \"var(--info-bg-strong)\"\n    default:\n      return \"var(--neutral-bg)\"\n  }\n}\n\n/**\n * Gets the color for a cache plan value\n * @param {string} plan - The cache plan\n * @returns {string} CSS color value\n */\nfunction getCachePlanColor(plan) {\n  switch (plan) {\n    case \"standard\":\n      return \"var(--plan-standard-bg)\"\n    case \"performance+\":\n      return \"var(--plan-performance-plus-bg)\"\n    default:\n      return \"var(--neutral-bg)\"\n  }\n}\n\n/**\n * Gets the color for enabled/disabled status\n * @param {boolean} isEnabled - Whether the feature is enabled\n * @param {boolean} isNA - Whether the value is N/A\n * @returns {string} CSS color value\n */\nfunction getEnabledDisabledColor(isEnabled, isNA = false) {\n  if (isNA) return \"var(--neutral-bg)\"\n  return isEnabled ? \"var(--success-bg-strong)\" : \"var(--error-bg-strong)\"\n}\n\n/**\n * Gets the appropriate text color for a background color\n * @param {string} bgColorHexOrVar - The background color\n * @returns {string} CSS color value for text\n */\nexport function getContrastColor(bgColorHexOrVar) {\n  let hexColor = bgColorHexOrVar\n  if (hexColor.startsWith(\"var(--\")) {\n    const varName = hexColor.match(/--([a-zA-Z0-9-]+)/)[0]\n    hexColor = getComputedStyle(document.documentElement).getPropertyValue(varName).trim()\n  }\n\n  if (!hexColor || !hexColor.startsWith(\"#\")) return \"var(--text-primary)\"\n  hexColor = hexColor.slice(1)\n\n  let r, g, b\n  if (hexColor.length === 3) {\n    r = Number.parseInt(hexColor[0] + hexColor[0], 16)\n    g = Number.parseInt(hexColor[1] + hexColor[1], 16)\n    b = Number.parseInt(hexColor[2] + hexColor[2], 16)\n  } else if (hexColor.length === 6) {\n    r = Number.parseInt(hexColor.substr(0, 2), 16)\n    g = Number.parseInt(hexColor.substr(2, 2), 16)\n    b = Number.parseInt(hexColor.substr(4, 2), 16)\n  } else {\n    return \"var(--text-primary)\"\n  }\n  if (isNaN(r) || isNaN(g) || isNaN(b)) return \"var(--text-primary)\"\n\n  const yiq = (r * 299 + g * 587 + b * 114) / 1000\n\n  if (bgColorHexOrVar.includes(\"-strong\") || bgColorHexOrVar === \"var(--plan-performance-plus-bg)\") {\n    return \"#ffffff\"\n  }\n  if (bgColorHexOrVar === \"var(--plan-standard-bg)\") return \"var(--text-primary)\"\n\n  return yiq >= 145 ? \"var(--text-primary)\" : \"#ffffff\"\n}\n","/**\n * Module for handling header display in the popup\n */\n\nimport { getHeaderColor, getContrastColor } from \"../../utils/formatters.js\"\n\n/**\n * Updates the header display with analysis results\n * @param {Object} headersData - Headers data object\n */\nexport function updateHeaderDisplay(headersData) {\n  const headerInfoContainer = document.getElementById(\"headerInfo\")\n\n  // Add margin if no button is present\n  if (headerInfoContainer) headerInfoContainer.style.marginTop = \"0px\"\n\n  const existingEmptyMsg = headerInfoContainer.querySelector(\".empty-state-message\")\n  if (existingEmptyMsg) existingEmptyMsg.remove()\n\n  const allHeaderValueSpans = headerInfoContainer.querySelectorAll(\".header-list li .header-value\")\n\n  // Reset all headers to default state\n  resetHeaderValues(allHeaderValueSpans)\n\n  if (headersData && Object.keys(headersData).length > 0) {\n    const hasAnyData = updateHeaderValues(allHeaderValueSpans, headersData)\n\n    if (!hasAnyData) {\n      showEmptyHeaderMessage(headerInfoContainer, \"All header information is N/A or analysis pending.\")\n    }\n  } else {\n    showEmptyHeaderMessage(headerInfoContainer, \"No header information available or analysis pending.\")\n  }\n\n  headerInfoContainer.style.display = \"block\"\n}\n\n/**\n * Resets all header values to default state\n * @param {NodeList} headerValueSpans - All header value span elements\n */\nfunction resetHeaderValues(headerValueSpans) {\n  headerValueSpans.forEach((spanElement) => {\n    spanElement.textContent = \"N/A\"\n    const defaultBgColor = getHeaderColor(\"\", \"N/A\")\n    spanElement.style.backgroundColor = defaultBgColor\n    spanElement.style.color = getContrastColor(defaultBgColor)\n    spanElement.style.display = \"inline-block\"\n    if (spanElement.id === \"adprovider\") {\n      spanElement.setAttribute(\"data-provider\", \"N/A\")\n    }\n  })\n}\n\n/**\n * Updates header values with actual data\n * @param {NodeList} headerValueSpans - All header value span elements\n * @param {Object} headersData - Headers data object\n * @returns {boolean} True if any data was found\n */\nfunction updateHeaderValues(headerValueSpans, headersData) {\n  let hasAnyData = false\n\n  headerValueSpans.forEach((spanElement) => {\n    const elementId = spanElement.id\n    let headerKeyToLookup = elementId\n\n    const keyMapping = {\n      perfmattersrucss: \"perfmattersRUCSS\",\n      perfmattersdelayjs: \"perfmattersDelayJS\",\n      adprovider: \"adProvider\",\n    }\n\n    if (keyMapping[elementId]) {\n      headerKeyToLookup = keyMapping[elementId]\n    }\n\n    const value = headersData[headerKeyToLookup]\n\n    if (value !== undefined && value !== null && String(value).trim() !== \"\") {\n      spanElement.textContent = String(value)\n      hasAnyData = true\n    } else {\n      spanElement.textContent = \"N/A\"\n    }\n\n    const bgColor = getHeaderColor(headerKeyToLookup, value)\n    spanElement.style.backgroundColor = bgColor\n    spanElement.style.color = getContrastColor(bgColor)\n\n    if (elementId === \"adprovider\") {\n      spanElement.setAttribute(\"data-provider\", value && String(value).trim() !== \"\" ? String(value) : \"N/A\")\n    }\n  })\n\n  return hasAnyData\n}\n\n/**\n * Shows an empty state message\n * @param {HTMLElement} container - The container element\n * @param {string} message - The message to show\n */\nfunction showEmptyHeaderMessage(container, message) {\n  if (!container.querySelector(\".empty-state-message\")) {\n    const p = document.createElement(\"p\")\n    p.textContent = message\n    p.className = \"empty-state-message\"\n    container.appendChild(p)\n  }\n}\n","/**\n * Safely sends a message to the extension runtime\n * @param {Object} message - The message to send\n * @param {Function} callback - Optional callback function\n */\nexport function safeSendMessage(message, callback) {\n  try {\n    chrome.runtime.sendMessage(message, (response) => {\n      if (chrome.runtime.lastError) {\n        return\n      }\n      if (callback) callback(response)\n    })\n  } catch (error) {\n    // Extension context invalidated or other error\n    console.debug(\"Message sending failed:\", error)\n  }\n}\n\n/**\n * Sends a message to a specific tab\n * @param {number} tabId - The ID of the tab to send the message to\n * @param {Object} message - The message to send\n * @param {Function} callback - Optional callback function\n */\nexport function sendMessageToTab(tabId, message, callback) {\n  try {\n    chrome.tabs.sendMessage(tabId, message, (response) => {\n      if (chrome.runtime.lastError) {\n        return\n      }\n      if (callback) callback(response)\n    })\n  } catch (error) {\n    console.debug(\"Tab message sending failed:\", error)\n  }\n}\n\n/**\n * Sets up a listener for messages from content scripts or popup\n * @param {Object} handlers - Object mapping action names to handler functions\n */\nexport function setupMessageListener(handlers) {\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    const action = message.action\n    if (handlers[action]) {\n      handlers[action](message, sender, sendResponse)\n    }\n    return true // Keep the message channel open for async responses\n  })\n}\n","/**\n * Module for managing popup window state in the UI\n */\n\nimport { safeSendMessage } from \"../utils/messaging.js\"\nimport { isCurrentWindowDetached, clearOriginalTabId } from \"../utils/window-state.js\"\n\n/**\n * Detaches the current popup into a separate window\n * @returns {Promise<boolean>} Success status\n */\nexport async function detachPopup() {\n  return new Promise((resolve) => {\n    safeSendMessage({ action: \"detachPopup\" }, (response) => {\n      if (response && response.success) {\n        // Close current popup window\n        window.close()\n        resolve(true)\n      } else {\n        console.error(\"Failed to detach popup:\", response?.error)\n        resolve(false)\n      }\n    })\n  })\n}\n\n/**\n * Attaches the popup back to the extension icon\n * @returns {Promise<boolean>} Success status\n */\nexport async function attachPopup() {\n  return new Promise((resolve) => {\n    safeSendMessage({ action: \"attachPopup\" }, async (response) => {\n      if (response && response.success) {\n        // Clear the stored original tab ID\n        await clearOriginalTabId()\n\n        // Close current detached window\n        window.close()\n        resolve(true)\n      } else {\n        console.error(\"Failed to detach popup:\", response?.error)\n        resolve(false)\n      }\n    })\n  })\n}\n\n/**\n * Gets the current window state from background\n * @returns {Promise<string>} Current window state\n */\nexport async function getWindowStateFromBackground() {\n  return new Promise((resolve) => {\n    safeSendMessage({ action: \"getWindowState\" }, (response) => {\n      resolve(response?.state || \"attached\")\n    })\n  })\n}\n\n/**\n * Checks if the current popup is running in a detached window\n * Uses multiple detection methods for accuracy\n * @returns {Promise<boolean>} True if detached\n */\nexport async function isDetachedWindow() {\n  try {\n    // Method 1: Check against stored detached window ID\n    const isDetachedById = await isCurrentWindowDetached()\n\n    // Method 2: Check window characteristics\n    const hasLargerDimensions = window.outerWidth > 650 || window.outerHeight > 650\n    const isExtensionUrl = window.location.protocol === \"chrome-extension:\"\n\n    // Method 3: Check background state\n    const backgroundState = await getWindowStateFromBackground()\n    const isDetachedByState = backgroundState === \"detached\"\n\n    // Method 4: Check window type (detached windows have different properties)\n    const isPopupWindow = window.opener === null && window.parent === window\n\n    // Combine all methods for accurate detection\n    const isDetached = (isDetachedById || isDetachedByState) && hasLargerDimensions && isExtensionUrl && isPopupWindow\n\n    console.log(\"Detached window detection:\", {\n      isDetachedById,\n      hasLargerDimensions,\n      isExtensionUrl,\n      isDetachedByState,\n      isPopupWindow,\n      finalResult: isDetached,\n    })\n\n    return isDetached\n  } catch (error) {\n    console.debug(\"Error detecting detached window:\", error)\n    return false\n  }\n}\n\n/**\n * Applies detached mode styling to the UI\n * @param {boolean} isDetached - Whether we're in detached mode\n */\nexport function applyDetachedModeStyles(isDetached) {\n  if (isDetached) {\n    document.body.classList.add(\"detached-mode\")\n    document.querySelector(\".container\")?.classList.add(\"detached-mode\")\n  } else {\n    document.body.classList.remove(\"detached-mode\")\n    document.querySelector(\".container\")?.classList.remove(\"detached-mode\")\n  }\n}\n\n/**\n * Updates the window control button icon and tooltip based on current state\n * @param {boolean} isDetached - Whether we're in detached mode\n * @param {HTMLElement} button - The button element to update\n */\nexport function updateWindowControlButton(isDetached, button) {\n  if (!button) return\n\n  const icon = button.querySelector(\".window-toggle-icon\")\n  if (!icon) return\n\n  if (isDetached) {\n    // Show \"Attach\" icon when in detached mode - dock/attach back to extension\n    icon.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <path d=\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"/>\n    </svg>`\n    button.title = \"Attach popup back to extension icon\"\n  } else {\n    // Show \"Open in new window\" icon when in attached mode - like the one in your screenshot\n    icon.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <path d=\"M15 3h6v6\"/>\n      <path d=\"M10 14 21 3\"/>\n      <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\n    </svg>`\n    button.title = \"Open popup in separate window\"\n  }\n}\n","/**\n * Main popup script for the BigScoots Performance Debugger extension - Enhanced PSI support\n */\n\nconsole.log(\"=== POPUP STARTING ===\")\nconsole.log(\"DOM readyState:\", document.readyState)\nconsole.log(\"Chrome API available:\", typeof window.chrome !== \"undefined\")\nconsole.log(\"Window location:\", window.location.href)\n\n// Import display modules\nimport { updateImageDisplay } from \"./displays/image-display.js\"\nimport { updateFontDisplay } from \"./displays/font-display.js\"\nimport { updateHeaderDisplay } from \"./displays/header-display.js\"\nimport {\n  updateInsightsDisplay,\n  updateCLSDisplay,\n  updateLCPDisplay,\n  updateINPDisplay,\n  updateTTFBDisplay,\n  updatePSICLSDisplay,\n  updatePSILCPDisplay,\n  updatePSIINPDisplay,\n  updatePSITTFBDisplay,\n  updatePSIStatus,\n  updatePSILabCLSDisplay,\n  updatePSILabLCPDisplay,\n  resetDataAvailability,\n  handleCompletePSIResults,\n} from \"./displays/insights-display.js\"\n\n// Import management modules\nimport { setupTabSwitching } from \"./tab-manager.js\"\nimport { setupToggleManagement } from \"./toggle-manager.js\"\nimport {\n  detachPopup,\n  attachPopup,\n  isDetachedWindow,\n  applyDetachedModeStyles,\n  updateWindowControlButton,\n} from \"./window-state-manager.js\"\n\n// Import the tab helpers\nimport { getTargetTabId, getOriginalTabIdFromUrl, verifyTabExists } from \"../utils/tab-helpers.js\"\n\nconsole.log(\"All modules imported successfully\")\n\n// Declare chrome variable\n\n/**\n * Tab configuration\n */\nconst TABS = [\n  { id: \"insightsTab\", contentId: \"insightsContent\" },\n  { id: \"imageAnalyzerTab\", contentId: \"imageAnalyzerContent\" },\n  { id: \"fontAnalyzerTab\", contentId: \"fontAnalyzerContent\" },\n  { id: \"headerAnalyzerTab\", contentId: \"headerAnalyzerContent\" },\n]\n\nconsole.log(\"Testing tab elements...\")\nTABS.forEach((tab) => {\n  const tabEl = document.getElementById(tab.id)\n  const contentEl = document.getElementById(tab.contentId)\n  console.log(`Tab ${tab.id}:`, !!tabEl, \"Content:\", !!contentEl)\n})\n\n// Store for cached data to persist across refreshes\nlet cachedAnalysisData = null\nlet isDetachedMode = false\nlet boundTabId = null // The tab this detached window is bound to\nlet boundTabUrl = null // The URL of the bound tab\nlet pollingInterval = null\n\n/**\n * Sends a message to content script with retry logic and better error handling\n * @param {number} tabId - Tab ID to send message to\n * @param {Object} message - Message to send\n * @param {Function} callback - Callback function\n * @param {number} retries - Number of retries remaining\n */\nfunction sendMessageWithRetry(tabId, message, callback, retries = 3) {\n  console.log(`Sending message to tab ${tabId}:`, message.action, `(${retries} retries left)`)\n\n  chrome.tabs.sendMessage(tabId, message, (response) => {\n    if (chrome.runtime.lastError) {\n      const errorMsg = chrome.runtime.lastError.message\n      console.error(`Message to tab ${tabId} failed:`, errorMsg)\n\n      // Check if it's a \"receiving end does not exist\" error\n      if (errorMsg.includes(\"Receiving end does not exist\") && retries > 0) {\n        console.log(`Content script not ready, retrying in 1s... (${retries} retries left)`)\n        setTimeout(() => {\n          sendMessageWithRetry(tabId, message, callback, retries - 1)\n        }, 1000)\n        return\n      }\n\n      console.log(`Message failed after retries: ${errorMsg}`)\n      if (callback) callback(null)\n      return\n    }\n\n    console.log(`Message to tab ${tabId} successful, response:`, response)\n    if (callback) callback(response)\n  })\n}\n\n/**\n * Verifies content script is injected and ready\n * @param {number} tabId - Tab ID to check\n * @returns {Promise<boolean>} True if content script is ready\n */\nasync function verifyContentScriptReady(tabId) {\n  console.log(`Verifying content script readiness for tab ${tabId}`)\n\n  return new Promise((resolve) => {\n    chrome.tabs.sendMessage(tabId, { action: \"ping\" }, (response) => {\n      if (chrome.runtime.lastError) {\n        console.log(`Content script not ready for tab ${tabId}:`, chrome.runtime.lastError.message)\n        resolve(false)\n      } else {\n        console.log(`Content script is ready for tab ${tabId}`)\n        resolve(true)\n      }\n    })\n  })\n}\n\n/**\n * Gets the correct tab ID for messaging, handling detached mode\n * @returns {Promise<number|null>} Tab ID or null if not available\n */\nasync function getTargetTabIdForMessaging() {\n  // Use the improved getTargetTabId function that auto-detects mode\n  const tabId = await getTargetTabId()\n  console.log(\"Target tab ID for messaging:\", tabId)\n  return tabId\n}\n\n/**\n * Initializes detached mode binding\n */\nasync function initializeDetachedMode() {\n  console.log(\"Initializing detached mode...\")\n\n  // Get original tab ID from URL\n  const originalTabId = await getOriginalTabIdFromUrl()\n  console.log(\"Original tab ID from URL:\", originalTabId)\n\n  if (!originalTabId) {\n    console.error(\"No original tab ID found in detached mode\")\n    return false\n  }\n\n  // Verify the tab still exists\n  const tabExists = await verifyTabExists(originalTabId)\n  if (!tabExists) {\n    console.error(\"Original tab no longer exists:\", originalTabId)\n    return false\n  }\n\n  // Set the bound tab ID\n  boundTabId = originalTabId\n  console.log(\"Detached mode: successfully bound to tab\", boundTabId)\n\n  // Get and store the tab URL\n  try {\n    const response = await new Promise((resolve) => {\n      chrome.runtime.sendMessage({ action: \"getTabUrl\", tabId: boundTabId }, (response) => {\n        if (chrome.runtime.lastError) {\n          resolve({ success: false, error: chrome.runtime.lastError.message })\n        } else {\n          resolve(response)\n        }\n      })\n    })\n\n    if (response.success) {\n      boundTabUrl = response.url\n      console.log(\"Bound tab URL:\", boundTabUrl)\n      updateCurrentUrlDisplay(boundTabUrl)\n    }\n  } catch (error) {\n    console.error(\"Error getting bound tab URL:\", error)\n  }\n\n  return true\n}\n\n/**\n * Updates the current URL display in the header\n * @param {string} url - The URL to display\n */\nfunction updateCurrentUrlDisplay(url) {\n  console.log(\"Updating URL display:\", url)\n  const currentUrlElement = document.getElementById(\"currentUrl\")\n  const currentUrlValue = document.getElementById(\"currentUrlValue\")\n\n  if (currentUrlElement && currentUrlValue && url) {\n    // Clean up the URL for display\n    let displayUrl = url\n    try {\n      const urlObj = new URL(url)\n\n      // Get hostname and pathname\n      displayUrl = urlObj.hostname\n\n      // Add pathname but remove trailing slash\n      let pathname = urlObj.pathname\n      if (pathname !== \"/\" && pathname.endsWith(\"/\")) {\n        pathname = pathname.slice(0, -1)\n      }\n\n      // Only add pathname if it's not just \"/\"\n      if (pathname !== \"/\") {\n        displayUrl += pathname\n      }\n\n      // Add search params if present\n      if (urlObj.search) {\n        displayUrl += urlObj.search\n      }\n    } catch (error) {\n      // If URL parsing fails, use the original URL\n      // Still try to remove trailing slash\n      if (displayUrl.endsWith(\"/\") && displayUrl.length > 1) {\n        displayUrl = displayUrl.slice(0, -1)\n      }\n    }\n\n    currentUrlValue.textContent = displayUrl\n    currentUrlElement.classList.add(\"visible\")\n\n    // Store the bound tab URL in detached mode\n    if (isDetachedMode) {\n      boundTabUrl = url\n    }\n  } else if (currentUrlElement) {\n    currentUrlElement.classList.remove(\"visible\")\n  }\n}\n\n/**\n * Updates the popup with analysis results\n */\nasync function updatePopupWithResults() {\n  console.log(\"=== updatePopupWithResults called ===\")\n\n  try {\n    // Show loading state - but don't fail if this doesn't work\n    resetDataAvailability()\n  } catch (error) {\n    console.log(\"Could not update loading state:\", error)\n  }\n\n  // Reset data availability when updating popup (new page/refresh)\n  resetDataAvailability()\n\n  // Clear any existing data displays immediately\n  showEmptyStates()\n\n  try {\n    if (isDetachedMode) {\n      console.log(\"Running in detached mode\")\n\n      if (!boundTabId) {\n        console.error(\"No bound tab ID in detached mode\")\n        showEmptyStates()\n        updateCurrentUrlDisplay(\"Tab not available\")\n        return\n      }\n\n      // Get analysis results for the bound tab\n      console.log(\"Requesting analysis results for bound tab:\", boundTabId)\n      chrome.runtime.sendMessage({ action: \"getAnalysisResults\", tabId: boundTabId }, (data) => {\n        if (chrome.runtime.lastError) {\n          console.log(\"Error getting analysis results:\", chrome.runtime.lastError)\n          return\n        }\n\n        console.log(\"Analysis results received for bound tab:\", data)\n        if (data && Object.keys(data).length > 0) {\n          // Verify the data is for the current URL\n          if (boundTabUrl && data.url && data.url !== boundTabUrl) {\n            console.log(\"Analysis data is for different URL, ignoring:\", data.url, \"vs\", boundTabUrl)\n            showEmptyStates()\n            return\n          }\n\n          console.log(\"Displaying analysis data for bound tab\")\n          cachedAnalysisData = data\n          displayAnalysisData(data)\n\n          // Also update performance metrics from cached data\n          updatePerformanceMetricsFromData(data)\n        } else {\n          console.log(\"No analysis data available for bound tab, requesting fresh analysis\")\n          sendMessageWithRetry(boundTabId, { action: \"requestAnalysis\" }, (response) => {\n            if (response) {\n              console.log(\"Fresh analysis requested successfully\")\n            }\n          })\n        }\n      })\n\n      // Get stored PSI results for the bound tab\n      chrome.runtime.sendMessage({ action: \"getPSIResults\", tabId: boundTabId }, (psiData) => {\n        if (chrome.runtime.lastError) {\n          console.log(\"Error getting PSI results:\", chrome.runtime.lastError)\n          return\n        }\n\n        if (psiData && (psiData.allFieldData || psiData.allLabData)) {\n          // Verify PSI data is for current URL\n          if (boundTabUrl && psiData.url && psiData.url !== boundTabUrl) {\n            console.log(\"PSI data is for different URL, ignoring:\", psiData.url, \"vs\", boundTabUrl)\n            return\n          }\n\n          console.log(\"Restoring PSI data from storage:\", psiData)\n\n          // Restore field data\n          if (psiData.allFieldData) {\n            restorePSIFieldData(psiData.allFieldData)\n          }\n\n          // Restore lab data\n          if (psiData.allLabData) {\n            restorePSILabData(psiData.allLabData)\n          }\n\n          // NEW: Restore PSI insights data for detached mode\n          if (psiData.completeData) {\n            console.log(\"Restoring PSI insights from storage in detached mode\")\n            handleCompletePSIResults(psiData.completeData)\n          }\n\n          updatePSIStatus({ status: \"success\", message: \"PSI data restored\" })\n        }\n      })\n\n      // Get current performance data with better error handling\n      console.log(\"Requesting current performance data for bound tab:\", boundTabId)\n      sendMessageWithRetry(boundTabId, { action: \"getCurrentPerformanceData\" }, (response) => {\n        if (response) {\n          console.log(\"Fresh performance data received:\", response)\n          updatePerformanceMetrics(response)\n\n          // Merge with cached data if available\n          if (cachedAnalysisData) {\n            const mergedData = {\n              cls: response.cls || cachedAnalysisData.cls,\n              lcp: response.lcp || cachedAnalysisData.lcp,\n              inp: response.inp || cachedAnalysisData.inp,\n              additionalMetrics: response.additionalMetrics || cachedAnalysisData.additionalMetrics,\n            }\n            updatePerformanceMetrics(mergedData)\n          }\n        } else {\n          console.log(\"No fresh performance data, using cached data if available\")\n          if (cachedAnalysisData) {\n            updatePerformanceMetricsFromData(cachedAnalysisData)\n          }\n        }\n      })\n\n      return\n    }\n\n    // Attached mode logic\n    console.log(\"Running in attached mode\")\n    chrome.tabs.query({ active: true, currentWindow: true }, (activeTabs) => {\n      if (chrome.runtime.lastError || !activeTabs || activeTabs.length === 0) {\n        console.log(\"No active tabs found in attached mode\")\n        showEmptyStates()\n        return\n      }\n\n      const currentTabId = activeTabs[0].id\n      const currentTab = activeTabs[0]\n\n      console.log(\"Current tab ID:\", currentTabId, \"URL:\", currentTab.url)\n\n      // Update URL display\n      if (currentTab.url) {\n        updateCurrentUrlDisplay(currentTab.url)\n      }\n\n      // Query stored analysis results from background script\n      console.log(\"Requesting analysis results for tab:\", currentTabId)\n      chrome.runtime.sendMessage({ action: \"getAnalysisResults\", tabId: currentTabId }, (data) => {\n        if (chrome.runtime.lastError) {\n          console.log(\"Error getting analysis results:\", chrome.runtime.lastError)\n          return\n        }\n\n        console.log(\"Analysis results received for tab\", currentTabId, \":\", data)\n        if (data && Object.keys(data).length > 0) {\n          // Verify the data is for the current URL\n          if (currentTab.url && data.url && data.url !== currentTab.url) {\n            console.log(\"Analysis data is for different URL, ignoring:\", data.url, \"vs\", currentTab.url)\n            showEmptyStates()\n            // Request fresh analysis for current URL\n            chrome.tabs.sendMessage(currentTabId, { action: \"requestAnalysis\" }, (response) => {\n              if (chrome.runtime.lastError) {\n                console.log(\"Content script not ready yet:\", chrome.runtime.lastError)\n              }\n            })\n            return\n          }\n\n          console.log(\"Received analysis data for current tab - displaying now\")\n          cachedAnalysisData = data\n          displayAnalysisData(data)\n\n          // Also update performance metrics from cached data\n          updatePerformanceMetricsFromData(data)\n        } else {\n          console.log(\"No analysis data available, requesting fresh analysis\")\n          chrome.tabs.sendMessage(currentTabId, { action: \"requestAnalysis\" }, (response) => {\n            if (chrome.runtime.lastError) {\n              console.log(\"Content script not ready yet:\", chrome.runtime.lastError)\n            } else {\n              console.log(\"Fresh analysis requested\")\n            }\n          })\n        }\n      })\n\n      // Get stored PSI results for the current tab\n      chrome.runtime.sendMessage({ action: \"getPSIResults\", tabId: currentTabId }, (psiData) => {\n        if (chrome.runtime.lastError) {\n          console.log(\"Error getting PSI results:\", chrome.runtime.lastError)\n          return\n        }\n\n        if (psiData && (psiData.allFieldData || psiData.allLabData)) {\n          // Verify PSI data is for current URL\n          if (currentTab.url && psiData.url && psiData.url !== currentTab.url) {\n            console.log(\"PSI data is for different URL, ignoring:\", psiData.url, \"vs\", currentTab.url)\n            return\n          }\n\n          console.log(\"Restoring PSI data from storage:\", psiData)\n\n          // Restore field data\n          if (psiData.allFieldData) {\n            restorePSIFieldData(psiData.allFieldData)\n          }\n\n          // Restore lab data\n          if (psiData.allLabData) {\n            restorePSILabData(psiData.allLabData)\n          }\n\n          // NEW: Restore PSI insights data\n          if (psiData.completeData) {\n            console.log(\"Restoring PSI insights from storage\")\n            handleCompletePSIResults(psiData.completeData)\n          }\n\n          updatePSIStatus({ status: \"success\", message: \"PSI data restored\" })\n        }\n      })\n\n      // Query content script for current performance data\n      console.log(\"Requesting current performance data for tab:\", currentTabId)\n      chrome.tabs.sendMessage(currentTabId, { action: \"getCurrentPerformanceData\" }, (response) => {\n        if (chrome.runtime.lastError) {\n          console.log(\"Content script message error:\", chrome.runtime.lastError)\n\n          // If we have cached performance data, use it\n          if (cachedAnalysisData) {\n            console.log(\"Using cached performance data from analysis results\")\n            updatePerformanceMetricsFromData(cachedAnalysisData)\n          }\n          return\n        }\n\n        console.log(\"Performance data received:\", response)\n        if (response) {\n          updatePerformanceMetrics(response)\n        } else {\n          console.log(\"No fresh performance data, using cached data if available\")\n          if (cachedAnalysisData) {\n            updatePerformanceMetricsFromData(cachedAnalysisData)\n          }\n        }\n      })\n    })\n  } catch (error) {\n    console.error(\"Error updating popup with results:\", error)\n\n    // Update error state\n    try {\n      const { updateInsightsState } = await import(\"./displays/insights-display.js\")\n      updateInsightsState({\n        isLoading: false,\n        hasError: true,\n        errorMessage: \"Failed to load performance data. Please refresh the page and try again.\",\n      })\n    } catch (importError) {\n      console.error(\"Could not update error state:\", importError)\n    }\n\n    showEmptyStates()\n  }\n}\n\n/**\n * Updates performance metrics from cached analysis data\n * @param {Object} data - Cached analysis data\n */\nfunction updatePerformanceMetricsFromData(data) {\n  console.log(\"=== updatePerformanceMetricsFromData called ===\")\n  console.log(\"Using cached data for performance metrics:\", data)\n\n  if (data.cls) {\n    console.log(\"Updating CLS from cached data:\", data.cls)\n    updateCLSDisplay(data.cls)\n  }\n\n  if (data.lcp) {\n    console.log(\"Updating LCP from cached data:\", data.lcp)\n    updateLCPDisplay(data.lcp)\n  }\n\n  if (data.inp) {\n    console.log(\"Updating INP from cached data:\", data.inp)\n    updateINPDisplay(data.inp)\n  }\n\n  if (data.additionalMetrics) {\n    console.log(\"Updating TTFB from cached data:\", data.additionalMetrics)\n    updateTTFBDisplay(data.additionalMetrics)\n  }\n}\n\n/**\n * Restores PSI field data for all metrics\n * @param {Object} allFieldData - All PSI field data\n */\nfunction restorePSIFieldData(allFieldData) {\n  console.log(\"Restoring PSI field data:\", allFieldData)\n\n  if (allFieldData.cls) {\n    updatePSICLSDisplay(allFieldData.cls)\n  }\n\n  if (allFieldData.lcp) {\n    updatePSILCPDisplay(allFieldData.lcp)\n  }\n\n  if (allFieldData.inp) {\n    updatePSIINPDisplay(allFieldData.inp)\n  }\n\n  if (allFieldData.ttfb) {\n    updatePSITTFBDisplay(allFieldData.ttfb)\n  }\n}\n\n/**\n * Restores PSI lab data for all metrics\n * @param {Object} allLabData - All PSI lab data\n */\nfunction restorePSILabData(allLabData) {\n  console.log(\"Restoring PSI lab data:\", allLabData)\n\n  if (allLabData.labCLS) {\n    updatePSILabCLSDisplay(allLabData.labCLS)\n  }\n\n  if (allLabData.labLCP) {\n    updatePSILabLCPDisplay(allLabData.labLCP)\n  }\n}\n\n/**\n * Displays analysis data in the UI\n * @param {Object} data - Analysis data to display\n */\nfunction displayAnalysisData(data) {\n  console.log(\"=== displayAnalysisData called ===\")\n  console.log(\"Data received:\", data)\n\n  if (data.images) {\n    console.log(\"Updating images:\", data.images.length)\n    updateImageDisplay(data.images)\n  } else {\n    console.log(\"No images data, showing empty state\")\n    updateImageDisplay([])\n  }\n\n  if (data.fonts) {\n    console.log(\"Updating fonts:\", data.fonts.length)\n    updateFontDisplay(data.fonts)\n  } else {\n    console.log(\"No fonts data, showing empty state\")\n    updateFontDisplay([])\n  }\n\n  if (data.headers) {\n    console.log(\"Updating headers\")\n    updateHeaderDisplay(data.headers)\n  } else {\n    console.log(\"No headers data, showing empty state\")\n    updateHeaderDisplay({})\n  }\n\n  console.log(\"Updating insights display\")\n  updateInsightsDisplay(data)\n}\n\n/**\n * Updates performance metrics\n * @param {Object} response - Performance data response\n */\nfunction updatePerformanceMetrics(response) {\n  console.log(\"=== updatePerformanceMetrics called ===\")\n  console.log(\"Performance data:\", response)\n\n  if (response.cls) {\n    console.log(\"Updating CLS display with fresh data\")\n    updateCLSDisplay(response.cls)\n  }\n  if (response.lcp) {\n    console.log(\"Updating LCP display with fresh data\")\n    updateLCPDisplay(response.lcp)\n  }\n  if (response.inp) {\n    console.log(\"Updating INP display with fresh data\")\n    updateINPDisplay(response.inp)\n  }\n  if (response.additionalMetrics) {\n    console.log(\"Updating TTFB display with fresh data\")\n    updateTTFBDisplay(response.additionalMetrics)\n  }\n}\n\n/**\n * Shows empty states for all displays\n */\nfunction showEmptyStates() {\n  console.log(\"=== Setting empty states ===\")\n  updateImageDisplay([])\n  updateFontDisplay([])\n  updateHeaderDisplay({})\n  updateInsightsDisplay({})\n}\n\n/**\n * Sets up periodic polling for performance data\n */\nfunction setupPeriodicPolling() {\n  console.log(\"Setting up periodic polling\")\n\n  // Clear existing interval if any\n  if (pollingInterval) {\n    clearInterval(pollingInterval)\n  }\n\n  pollingInterval = setInterval(async () => {\n    if (!isDetachedMode) {\n      return\n    }\n\n    if (boundTabId) {\n      const tabExists = await verifyTabExists(boundTabId)\n      if (!tabExists) {\n        console.log(\"Bound tab no longer exists:\", boundTabId)\n        showEmptyStates()\n        updateCurrentUrlDisplay(\"Tab closed or unavailable\")\n\n        // Clear the interval since tab is gone\n        if (pollingInterval) {\n          clearInterval(pollingInterval)\n          pollingInterval = null\n        }\n        return\n      }\n\n      chrome.tabs.sendMessage(boundTabId, { action: \"getCurrentPerformanceData\" }, (response) => {\n        if (chrome.runtime.lastError) {\n          console.log(\"Error polling bound tab:\", chrome.runtime.lastError)\n          return\n        }\n\n        if (response) {\n          updatePerformanceMetrics(response)\n        }\n      })\n    }\n  }, 3000) // Increased from 2000ms to 3000ms for better performance\n}\n\n// Add cleanup when window is closed\nwindow.addEventListener(\"beforeunload\", () => {\n  if (pollingInterval) {\n    clearInterval(pollingInterval)\n    pollingInterval = null\n  }\n})\n\n/**\n * Sets up message listeners for updates from content script\n */\nfunction setupMessageListeners() {\n  console.log(\"Setting up message listeners\")\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    console.log(\"Popup received message:\", message.action, \"from sender:\", sender)\n\n    // In detached mode, only process messages from the bound tab\n    if (isDetachedMode && boundTabId) {\n      if (sender.tab && sender.tab.id !== boundTabId) {\n        console.log(\"Ignoring message from non-bound tab:\", sender.tab.id, \"bound to:\", boundTabId)\n        return\n      }\n\n      // Special handling for tab URL changes\n      if (message.action === \"tabUrlChanged\" && message.tabId === boundTabId) {\n        console.log(\"Bound tab URL changed:\", message.url)\n        updateCurrentUrlDisplay(message.url)\n      }\n    }\n\n    // Process performance updates\n    if (message.action === \"updateCLS\") {\n      console.log(\"Received CLS update\")\n      updateCLSDisplay(message)\n    } else if (message.action === \"updateLCP\") {\n      console.log(\"Received LCP update\")\n      updateLCPDisplay(message)\n    } else if (message.action === \"updateINP\") {\n      console.log(\"Received INP update\")\n      updateINPDisplay(message)\n    } else if (message.action === \"updateAdditionalMetrics\") {\n      console.log(\"Received additional metrics update\")\n      updateTTFBDisplay(message.metrics)\n    } else if (message.action === \"analysisResults\") {\n      // Only process analysis results from the bound tab in detached mode\n      if (isDetachedMode && boundTabId) {\n        if (sender.tab && sender.tab.id === boundTabId) {\n          console.log(\"Received fresh analysis results from bound tab\")\n          cachedAnalysisData = message\n          displayAnalysisData(message)\n          // Also update performance metrics\n          updatePerformanceMetricsFromData(message)\n        }\n      } else if (!isDetachedMode) {\n        // In attached mode, process all analysis results\n        console.log(\"Received fresh analysis results in attached mode\")\n        cachedAnalysisData = message\n        displayAnalysisData(message)\n        // Also update performance metrics\n        updatePerformanceMetricsFromData(message)\n      }\n    }\n    // Enhanced PSI message handling\n    else if (message.action === \"updatePSICLS\") {\n      console.log(\"Received PSI CLS update\")\n      updatePSICLSDisplay(message.fieldData)\n    } else if (message.action === \"updatePSILCP\") {\n      console.log(\"Received PSI LCP update\")\n      updatePSILCPDisplay(message.fieldData)\n    } else if (message.action === \"updatePSIINP\") {\n      console.log(\"Received PSI INP update\")\n      updatePSIINPDisplay(message.fieldData)\n    } else if (message.action === \"updatePSITTFB\") {\n      console.log(\"Received PSI TTFB update\")\n      updatePSITTFBDisplay(message.fieldData)\n    } else if (message.action === \"updatePSILabCLS\") {\n      console.log(\"Received PSI Lab CLS update\")\n      updatePSILabCLSDisplay(message.labData)\n    } else if (message.action === \"updatePSILabLCP\") {\n      console.log(\"Received PSI Lab LCP update\")\n      updatePSILabLCPDisplay(message.labData)\n    } else if (message.action === \"updatePSIStatus\") {\n      console.log(\"Received PSI status update\")\n      updatePSIStatus(message)\n    } else if (message.action === \"completePSIResults\") {\n      console.log(\"Received complete PSI results for insights\")\n      handleCompletePSIResults(message.psiData)\n    }\n  })\n}\n\n/**\n * Sets up the detach/attach button functionality\n */\nasync function setupWindowControls() {\n  console.log(\"Setting up window controls\")\n  const windowControlsContainer = document.querySelector(\".window-controls\")\n  if (!windowControlsContainer) {\n    console.log(\"Window controls container not found\")\n    return\n  }\n\n  // Detect if we're in detached mode\n  isDetachedMode = await isDetachedWindow()\n  console.log(\"Window mode detected:\", isDetachedMode ? \"detached\" : \"attached\")\n\n  // Apply detached mode styles if needed\n  applyDetachedModeStyles(isDetachedMode)\n\n  const button = windowControlsContainer.querySelector(\".window-toggle-btn\")\n\n  if (button) {\n    // Update button icon and tooltip based on current state\n    updateWindowControlButton(isDetachedMode, button)\n\n    // Add click handler\n    button.addEventListener(\"click\", async () => {\n      button.disabled = true\n\n      try {\n        if (isDetachedMode) {\n          await attachPopup()\n        } else {\n          await detachPopup()\n        }\n      } catch (error) {\n        console.error(\"Error toggling window state:\", error)\n      } finally {\n        button.disabled = false\n      }\n    })\n  }\n}\n\n/**\n * Sets up resize handling for detached mode\n */\nfunction setupResizeHandling() {\n  if (isDetachedMode) {\n    window.addEventListener(\"resize\", () => {\n      // Reapply detached mode styles on resize\n      applyDetachedModeStyles(true)\n    })\n  }\n}\n\n/**\n * Refreshes toggle states when popup loads or mode changes\n */\nasync function refreshToggleStates() {\n  try {\n    // Get the target tab ID\n    const targetTabId = await getTargetTabIdForMessaging()\n\n    if (!targetTabId) {\n      console.log(\"No target tab available for refreshing toggle states\")\n      return\n    }\n\n    console.log(\"Refreshing toggle states for tab:\", targetTabId)\n\n    // Get current parameters for this tab\n    chrome.runtime.sendMessage({ action: \"getParameters\", tabId: targetTabId }, (parameters) => {\n      if (chrome.runtime.lastError) {\n        console.error(\"Error getting parameters for refresh:\", chrome.runtime.lastError)\n        return\n      }\n\n      // Ensure parameters is an array\n      if (!Array.isArray(parameters)) {\n        parameters = []\n      }\n\n      console.log(\"Refreshed parameters for tab\", targetTabId, \":\", parameters)\n\n      // Update toggle states\n      const perfmattersoff = document.getElementById(\"perfmattersoff\")\n      const perfmatterscssoff = document.getElementById(\"perfmatterscssoff\")\n      const perfmattersjsoff = document.getElementById(\"perfmattersjsoff\")\n      const nocache = document.getElementById(\"nocache\")\n\n      if (perfmattersoff) perfmattersoff.checked = parameters.includes(\"perfmattersoff\")\n      if (perfmatterscssoff) perfmatterscssoff.checked = parameters.includes(\"perfmatterscssoff\")\n      if (perfmattersjsoff) perfmattersjsoff.checked = parameters.includes(\"perfmattersjsoff\")\n      if (nocache) nocache.checked = parameters.includes(\"nocache\")\n\n      // Update toggle dependencies\n      if (window.updateToggleStates) {\n        window.updateToggleStates(true)\n      }\n    })\n  } catch (error) {\n    console.error(\"Error refreshing toggle states:\", error)\n  }\n}\n\n/**\n * Initializes the popup when DOM is loaded\n */\nasync function initializePopup() {\n  try {\n    console.log(\"=== STARTING POPUP INITIALIZATION ===\")\n\n    // Add debug logging\n    console.log(\"DOM elements check:\")\n    TABS.forEach((tab) => {\n      const tabEl = document.getElementById(tab.id)\n      const contentEl = document.getElementById(tab.contentId)\n      console.log(`Tab ${tab.id}:`, !!tabEl, \"Content:\", !!contentEl)\n      if (!tabEl) console.error(`Missing tab element: ${tab.id}`)\n      if (!contentEl) console.error(`Missing content element: ${tab.contentId}`)\n    })\n\n    // Detect mode first\n    isDetachedMode = await isDetachedWindow()\n    console.log(\"Initializing popup in mode:\", isDetachedMode ? \"detached\" : \"attached\")\n\n    // Initialize detached mode if needed\n    if (isDetachedMode) {\n      const success = await initializeDetachedMode()\n      if (!success) {\n        console.error(\"Failed to initialize detached mode\")\n        showEmptyStates()\n        return\n      }\n    }\n\n    // Make helper function globally available with the correct signature\n    window.getTargetTabId = async () => {\n      return await getTargetTabId()\n    }\n\n    // Set up tab switching FIRST\n    console.log(\"Setting up tab switching...\")\n    setupTabSwitching(TABS)\n\n    // Set up toggle management\n    console.log(\"Setting up toggle management...\")\n    setupToggleManagement()\n\n    // Make updateToggleStates globally available for refresh\n    const toggleManagerModule = await import(\"./toggle-manager.js\")\n    if (toggleManagerModule.updateToggleStates) {\n      window.updateToggleStates = toggleManagerModule.updateToggleStates\n    }\n\n    // Set up window controls\n    console.log(\"Setting up window controls...\")\n    await setupWindowControls()\n\n    // Set up resize handling for detached mode\n    setupResizeHandling()\n\n    // Set up message listeners BEFORE updating popup\n    console.log(\"Setting up message listeners...\")\n    setupMessageListeners()\n\n    // Update popup with initial results\n    console.log(\"Updating popup with initial results...\")\n    await updatePopupWithResults()\n\n    // Refresh toggle states after everything is loaded\n    console.log(\"Refreshing toggle states...\")\n    await refreshToggleStates()\n\n    // Set up periodic polling\n    console.log(\"Setting up periodic polling...\")\n    setupPeriodicPolling()\n\n    // Set up debug gear button\n    console.log(\"Setting up debug gear button...\")\n    setupDebugGearButton()\n\n    console.log(\"=== POPUP INITIALIZATION COMPLETE ===\")\n  } catch (error) {\n    console.error(\"=== POPUP INITIALIZATION FAILED ===\")\n    console.error(\"Error:\", error)\n    console.error(\"Error stack:\", error.stack)\n\n    // Try to show empty states as fallback\n    try {\n      showEmptyStates()\n    } catch (fallbackError) {\n      console.error(\"Even fallback failed:\", fallbackError)\n    }\n  }\n}\n\n/**\n * Sets up the debug gear button functionality\n */\nfunction setupDebugGearButton() {\n  const debugGearBtn = document.getElementById(\"debugGearBtn\")\n  const debugModal = document.getElementById(\"debugModal\")\n  const debugModalClose = document.getElementById(\"debugModalClose\")\n  const debugModalOverlay = debugModal?.querySelector(\".debug-modal-overlay\")\n\n  if (!debugGearBtn || !debugModal) {\n    console.log(\"Debug gear button or modal not found\")\n    return\n  }\n\n  // Open modal\n  debugGearBtn.addEventListener(\"click\", () => {\n    debugModal.style.display = \"flex\"\n    document.body.style.overflow = \"hidden\" // Prevent background scrolling\n  })\n\n  // Close modal functions\n  const closeModal = () => {\n    debugModal.style.display = \"none\"\n    document.body.style.overflow = \"\" // Restore scrolling\n  }\n\n  // Close on X button\n  if (debugModalClose) {\n    debugModalClose.addEventListener(\"click\", closeModal)\n  }\n\n  // Close on overlay click\n  if (debugModalOverlay) {\n    debugModalOverlay.addEventListener(\"click\", closeModal)\n  }\n\n  // Close on Escape key\n  document.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Escape\" && debugModal.style.display === \"flex\") {\n      closeModal()\n    }\n  })\n}\n\n// Initialize when DOM is ready\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  console.log(\"DOM content loaded, initializing popup\")\n  initializePopup()\n})\n\n// Also try immediate initialization if DOM is already ready\nif (document.readyState !== \"loading\") {\n  console.log(\"DOM already ready, initializing immediately...\")\n  initializePopup()\n}\n\nconsole.log(\"=== POPUP SETUP COMPLETE ===\")\n","/**\n * Module for managing popup tabs\n */\n\nconsole.log(\"=== TAB MANAGER LOADING ===\")\n\n/**\n * Sets up tab switching functionality\n * @param {Array} tabs - Array of tab configuration objects\n */\nexport function setupTabSwitching(tabs) {\n  console.log(\"setupTabSwitching called with tabs:\", tabs)\n\n  function switchTab(activeTabId) {\n    console.log(\"switchTab called with:\", activeTabId)\n    tabs.forEach((tabInfo) => {\n      const tabEl = document.getElementById(tabInfo.id)\n      const contentEl = document.getElementById(tabInfo.contentId)\n      console.log(`Processing tab ${tabInfo.id}:`, !!tabEl, !!contentEl)\n\n      if (tabEl && contentEl) {\n        if (tabInfo.id === activeTabId) {\n          tabEl.classList.add(\"active\")\n          contentEl.classList.add(\"active\")\n          console.log(`Activated tab: ${tabInfo.id}`)\n        } else {\n          tabEl.classList.remove(\"active\")\n          contentEl.classList.remove(\"active\")\n        }\n      } else {\n        console.warn(`Missing elements for tab ${tabInfo.id}:`, { tabEl: !!tabEl, contentEl: !!contentEl })\n      }\n    })\n    localStorage.setItem(\"activeExtensionTab\", activeTabId)\n    console.log(\"Active tab saved to localStorage:\", activeTabId)\n  }\n\n  // Add click listeners to tabs\n  tabs.forEach((tabInfo) => {\n    const tabEl = document.getElementById(tabInfo.id)\n    console.log(`Setting up click listener for tab ${tabInfo.id}:`, !!tabEl)\n\n    if (tabEl) {\n      // Remove any existing listeners\n      const newTabEl = tabEl.cloneNode(true)\n      tabEl.parentNode.replaceChild(newTabEl, tabEl)\n\n      // Add new listener\n      newTabEl.addEventListener(\"click\", (e) => {\n        console.log(`Tab ${tabInfo.id} clicked`)\n        e.preventDefault()\n        e.stopPropagation()\n        switchTab(tabInfo.id)\n      })\n      console.log(`Click listener added to tab ${tabInfo.id}`)\n    } else {\n      console.error(`Tab element not found: ${tabInfo.id}`)\n    }\n  })\n\n  // Restore last active tab or default to first tab\n  const lastActiveTab = localStorage.getItem(\"activeExtensionTab\")\n  console.log(\"Last active tab from localStorage:\", lastActiveTab)\n\n  if (lastActiveTab && tabs.find((t) => t.id === lastActiveTab)) {\n    console.log(\"Restoring last active tab:\", lastActiveTab)\n    switchTab(lastActiveTab)\n  } else if (tabs.length > 0) {\n    console.log(\"No last active tab, defaulting to first tab:\", tabs[0].id)\n    switchTab(tabs[0].id)\n  }\n\n  console.log(\"Tab switching setup complete\")\n}\n\nconsole.log(\"=== TAB MANAGER LOADED ===\")\n"],"names":["isProcessingToggle","toggleQueue","currentOperation","setupToggleManagement","async","targetTabId","window","getTargetTabId","document","getElementById","checked","updateToggleStates","chrome","runtime","sendMessage","action","tabId","parameters","lastError","Array","isArray","includes","error","loadInitialToggleStates","querySelectorAll","forEach","input","addEventListener","event","preventDefault","toggleId","isChecked","operation","timestamp","Date","now","push","length","shift","processParameterChangeAndWaitForLoad","processToggleQueue","queueToggleChange","id","Promise","parameter","perfmattersoff","perfmatterscssoff","perfmattersjsoff","nocache","resolve","add","response","urlChanged","reject","timeout","startTime","checkTabStatus","tabs","get","tab","Error","status","setTimeout","then","catch","skipParameterUpdate","isPerfmattersOff","allContainers","closest","container","index","querySelector","disabled","classList","remove","toggle","nocacheContainer","STORAGE_KEYS","WINDOW_STATE","DETACHED_WINDOW_ID","WINDOW_BOUNDS","globalThis","self","getOriginalTabId","storage","local","originalTabId","clearOriginalTabId","isCurrentWindowDetached","currentWindowId","windows","getCurrent","getCurrentWindowId","getDetachedWindowId","getOriginalTabIdFromUrl","tabIdFromUrl","URLSearchParams","location","search","Number","parseInt","tabIdFromStorage","verifyTabExists","has","query","active","currentWindow","activeTabs","sendMessageToContentScript","message","showElementFeedback","element","type","duration","originalTransform","style","transform","originalTransition","transition","toastContainer","toastCounter","TOAST_TYPES","TOAST_CONFIG","success","warning","info","maxToasts","position","createToast","options","createElement","className","cssText","top","left","right","bottom","flexDirection","body","appendChild","initializeToastContainer","toastId","dismissible","compact","toast","pointerEvents","icon","icons","getToastIcon","innerHTML","dismissToast","requestAnimationFrame","animation","toasts","limitToasts","parentNode","removeChild","insightsRenderer","constructor","this","expandedInsights","Set","activeTooltip","renderInsights","insights","renderEmptyState","header","renderHeader","insight","item","renderInsightItem","initializeTooltips","cleanupTooltips","trigger","e","showTooltip","hideTooltip","updateTooltipPosition","tooltip","target","tooltipText","getAttribute","textContent","_tooltip","positionTooltip","triggerRect","getBoundingClientRect","tooltipRect","viewportWidth","innerWidth","viewportHeight","innerHeight","padding","width","height","opacity","count","title","countBadge","statusClass","determineInsightStatus","renderInsightHeader","content","renderInsightContent","category","undefined","score","parseFloat","setAttribute","formatInsightTitle","expandIcon","toggleInsight","parentElement","key","description","renderDescription","networkTree","renderNetworkDependencyFromAPI","details","renderNetworkTree","items","detailsContainer","renderDetails","children","debugContainer","JSON","stringify","noData","chainsData","longestChain","firstItem","value","chains","Object","keys","summary","chainCount","Math","round","chainsContainer","entries","chainId","chain","chainHeader","chainTree","renderAPIChain","noChains","depth","chainElement","itemElement","indent","url","filename","extractFilename","domain","extractDomain","urlDisplay","urlText","hostname","domainSpan","timing","transferSize","navStartToEndTime","formatBytes","values","childChain","childElement","renderNetworkDependencyTree","findLongestChain","renderCriticalChain","longest","maxDuration","calculateChainDuration","totalDuration","child","_chain$request","request","responseReceivedTime","descContainer","htmlDescription","replace","tableRendered","checklist","renderChecklist","nodeInfo","renderNodeInfo","table","renderDetailsTable","headings","tableData","extractTableData","checklistItem","checklistRow","label","nodeItem","nodeContainer","snippet","selector","nodeLabel","treeContainer","latencyInfo","navHeader","simpleList","renderNetworkSimpleList","renderNetworkChain","debugInfo","listContainer","href","metaInfo","parts","join","connector","marginLeft","displayName","slice","endTime","timingText","size","childId","nonSpecialItems","filter","thead","headerRow","heading","th","headingText","text","formatHeading","isNumericColumn","sourceHeader","timeHeader","tbody","row","renderTableRow","some","keyword","toLowerCase","td","formatUrlCell","formatNumericValue","formatSourceCell","formatTimeValue","formatCellValue","sourceCell","source","timeCell","reflowTime","time","urlString","String","escapeHtml","numValue","isNaN","toFixed","toLocaleString","bytes","i","floor","log","pow","URL","html","line","column","pathname","split","pop","numTime","l","toUpperCase","str","trim","contains","delete","emptyState","renderError","errorState","renderLoading","loadingState","div","processMarkdown","getFilenameFromUrl","urlObj","destroy","tooltipElement","psiInsightsState","lastUpdate","isLoading","hasError","errorMessage","updatePSIInsightsDisplay","psiData","data","lighthouseResult","audits","allInsights","failed","warnings","extractPSIInsights","display","showEmptyInsightsState","insightsArray","map","insightKey","insightData","displayPSIInsights","showInsightsError","setPSIInsightsLoading","insightsState","dataTypes","available","field","lab","metrics","cls","lcp","inp","ttfb","THRESHOLDS","good","needsImprovement","formatMetricValue","metric","updateInsightsState","updates","previousState","parse","assign","el","setPSIButtonState","errorContainer","updateErrorStates","hideElement","cacheStatus","localLegend","fieldLegend","labLegend","combinationStates","states","localField","localLab","fieldLab","allSources","metricData","localValue","fieldValue","labValue","tolerance","calculateTolerance","localFieldMatch","abs","localLabMatch","fieldLabMatch","getCombinationStates","showLocal","hasAnyCombinations","showField","showLab","legendContainer","existingCombinations","addCombinationLegendItem","updateCombinationLegends","hasAnyData","dt","updateLegendFromState","updateMetricValue","legendItem","dot","labelElement","valueContainer","charAt","textElement","displayValue","updateMetricThresholds","threshold","addThresholdStyling","setupPSIAnalyzeButton","psiBtn","newBtn","cloneNode","replaceChild","handlePSIButtonClick","isReady","ready","verifyContentScriptReady","clearTimeout","userMessage","showErrorToast","state","btnText","resetDataAvailability","clearPSIInsightsDisplay","updateInsightsDisplay","updateCLSDisplay","updateLCPDisplay","updateINPDisplay","additionalMetrics","updateTTFBDisplay","clsData","clsElementPreview","clsValue","elementTag","elementImage","clsShiftValue","elementDimensions","elementPosition","elementClassesContainer","elementClasses","elementSelectorContainer","elementSelector","tagName","tagDisplay","color","shiftValue","dimensions","dimensionText","naturalWidth","naturalHeight","imageUrl","preview","primarySource","src","currentSrc","backgroundImageUrl","previewImg","highlightCLSElementOnPage","cursor","replaceWith","updateCLSElementPreview","lcpData","lcpElementPreview","elementSrcContainer","elementSrc","elementTextContainer","elementText","sourceUrl","displaySrc","substring","displayText","highlightLCPElementOnPage","updateLCPElementPreview","inpData","inpStatus","inpElementPreview","latestEntry","name","interaction","interactionTypeContainer","interactionType","interactionDuration","highlightINPElementOnPage","updateINPElementPreview","updatePSICLSDisplay","updatePSILCPDisplay","updatePSIINPDisplay","updatePSITTFBDisplay","updatePSILabCLSDisplay","labData","updatePSILabLCPDisplay","updatePSIStatus","statusData","cacheStatusContainer","psiAnalysisStartTime","analysisEndTime","isFresh","statusText","cacheStatusText","handleCompletePSIResults","fromCache","psiCacheStatus","updatePSICacheStatus","isField","isLab","bar","percentage","maxValue","min","dataType","dataLabel","allMatch","indicator","localPercentage","calculateIndicatorPosition","createIndividualIndicator","fieldPercentage","allIndicators","indicators","positionGroups","Map","foundGroup","groupPos","group","set","zIndex","verticalOffset","horizontalOffset","positionIndicatorsIntelligently","max","readyState","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","o","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","updateImageDisplay","images","imageInfo","imageCountEl","imageList","marginTop","totalImages","p","image","li","imgContainer","img","alt","lastIndexOf","crossOrigin","fallbackIcon","onload","onerror","createImageContainer","infoContainer","urlSpan","detailsSpan","_image$dimensions","aboveFold","format","fileSizeFormatted","displayed","loading","createImageDetailsSpan","statusContainer","isCritical","criticalSticker","foldSticker","createImageStatusContainer","createImageInfoContainer","createImageListItem","updateFontDisplay","fonts","fontInfo","fontCountEl","fontList","totalFonts","font","numberBadge","contentContainer","urlContainer","copyButton","originalCopyIcon","copiedIcon","onclick","stopPropagation","navigator","clipboard","writeText","createCopyButton","createFontUrlContainer","typeSticker","preloadedSticker","preloaded","createFontStatusContainer","createFontContentContainer","createFontListItem","getHeaderColor","headerKey","lowerValue","getCacheStatusColor","plan","getCachePlanColor","getEnabledDisabledColor","isEnabled","isNA","getContrastColor","bgColorHexOrVar","g","b","hexColor","startsWith","varName","match","getComputedStyle","documentElement","getPropertyValue","substr","yiq","updateHeaderDisplay","headersData","headerInfoContainer","existingEmptyMsg","allHeaderValueSpans","spanElement","defaultBgColor","backgroundColor","headerValueSpans","elementId","headerKeyToLookup","keyMapping","perfmattersrucss","perfmattersdelayjs","adprovider","bgColor","updateHeaderValues","showEmptyHeaderMessage","safeSendMessage","callback","isDetachedWindow","isDetachedById","hasLargerDimensions","outerWidth","outerHeight","isExtensionUrl","protocol","isDetachedByState","getWindowStateFromBackground","isPopupWindow","opener","parent","applyDetachedModeStyles","isDetached","_document$querySelect","_document$querySelect2","TABS","contentId","cachedAnalysisData","isDetachedMode","boundTabId","boundTabUrl","pollingInterval","sendMessageWithRetry","retries","updateCurrentUrlDisplay","currentUrlElement","currentUrlValue","displayUrl","endsWith","updatePerformanceMetricsFromData","restorePSIFieldData","allFieldData","restorePSILabData","allLabData","labCLS","labLCP","displayAnalysisData","headers","updatePerformanceMetrics","showEmptyStates","setupWindowControls","windowControlsContainer","button","updateWindowControlButton","close","attachPopup","detachPopup","refreshToggleStates","getTargetTabIdForMessaging","initializePopup","initializeDetachedMode","switchTab","activeTabId","tabInfo","tabEl","contentEl","localStorage","setItem","newTabEl","lastActiveTab","getItem","find","t","setupTabSwitching","toggleManagerModule","onMessage","addListener","sender","sendResponse","fieldData","completeData","currentTabId","currentTab","importError","updatePopupWithResults","clearInterval","setInterval","debugGearBtn","debugModal","debugModalClose","debugModalOverlay","overflow","closeModal","setupDebugGearButton","fallbackError"],"sourceRoot":""}