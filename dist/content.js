(()=>{"use strict";function e(e,t){try{chrome.runtime.sendMessage(e,e=>{chrome.runtime.lastError||t&&t(e)})}catch(n){}}let t=0;const n=[];let o=null,i=0;function r(e){if(!e.currentRect||!e.previousRect)return 0;const t=e.currentRect,n=e.previousRect;return(Math.abs(t.x-n.x)+Math.abs(t.y-n.y))*(Math.max(t.width*t.height,n.width*n.height)/(window.innerWidth*window.innerHeight))}function s(e,t){if(!e||!e.getBoundingClientRect)return null;try{const n=e.getBoundingClientRect(),o=window.getComputedStyle(e),i=Array.from(e.classList||[]),r=o.backgroundImage;let s=null;if(r&&"none"!==r){const e=r.match(/url$$['"]?([^'"]+)['"]?$$/);s=e?e[1]:null}let l=e.src||s||null;e.tagName&&"img"===e.tagName.toLowerCase()&&e.currentSrc&&(l=e.currentSrc);const c=function(e){if(!e.tagName)return"unknown";if(e.id)return`#${e.id}`;let t=e.tagName.toLowerCase();e.classList&&e.classList.length>0&&(t+="."+Array.from(e.classList).join("."));if(!(e.id||e.classList&&0!==e.classList.length))try{var n;const o=Array.from((null===(n=e.parentElement)||void 0===n?void 0:n.children)||[]).indexOf(e)+1;o>0&&(t+=`:nth-child(${o})`)}catch(o){}return t}(e);return{tagName:e.tagName?e.tagName.toLowerCase():"unknown",id:e.id||null,classList:i,classString:i.join(" ")||null,selector:c,src:e.src||null,currentSrc:e.currentSrc||null,backgroundImageUrl:s,primarySource:l,alt:e.alt||null,title:e.title||null,textContent:e.textContent?e.textContent.substring(0,200):null,shiftValue:t,dimensions:{width:e.offsetWidth||0,height:e.offsetHeight||0,naturalWidth:e.naturalWidth||null,naturalHeight:e.naturalHeight||null},position:{top:e.offsetTop||0,left:e.offsetLeft||0,viewportTop:n.top,viewportLeft:n.left},styles:{position:o.position,display:o.display,float:o.float,transform:o.transform},attributes:a(e),preview:l}}catch(n){return null}}function a(e){const t={};return["loading","decoding","fetchpriority","sizes","srcset","data-src","data-lazy","style"].forEach(n=>{e.hasAttribute&&e.hasAttribute(n)&&(t[n]=e.getAttribute(n))}),t}function l(){const e=document.getElementById("bigscoots-cls-highlight");e&&e.remove()}function c(){let e=null;return o&&(e=s(o,i)),{value:t,entries:n,element:e,rating:t<.1?"good":t<.25?"needs-improvement":"poor"}}let u=0,d=null,g=null;function m(){if(window.PerformanceObserver)try{new PerformanceObserver(t=>{const n=t.getEntries(),o=n[n.length-1];o&&(u=o.startTime,d=o.element,d?(g=function(e){const t=e.getBoundingClientRect(),n=window.getComputedStyle(e),o=Array.from(e.classList),i=n.backgroundImage;let r=null;if(i&&"none"!==i){const e=i.match(/url$$['"]?([^'"]+)['"]?$$/);r=e?e[1]:null}let s=e.src||r||null;"img"===e.tagName.toLowerCase()&&e.currentSrc&&(s=e.currentSrc);const a=e.parentElement?{tagName:e.parentElement.tagName.toLowerCase(),classList:Array.from(e.parentElement.classList),id:e.parentElement.id||null}:null,l=function(e){if(e.id)return`#${e.id}`;let t=e.tagName.toLowerCase();e.classList.length>0&&(t+="."+Array.from(e.classList).join("."));if(!e.id&&0===e.classList.length){var n;t+=`:nth-child(${Array.from((null===(n=e.parentElement)||void 0===n?void 0:n.children)||[]).indexOf(e)+1})`}return t}(e);return{tagName:e.tagName.toLowerCase(),id:e.id||null,classList:o,classString:o.join(" ")||null,selector:l,src:e.src||null,currentSrc:e.currentSrc||null,backgroundImageUrl:r,primarySource:s,alt:e.alt||null,title:e.title||null,textContent:e.textContent?e.textContent.substring(0,200):null,dimensions:{width:e.offsetWidth,height:e.offsetHeight,naturalWidth:e.naturalWidth||null,naturalHeight:e.naturalHeight||null},position:{top:e.offsetTop,left:e.offsetLeft,viewportTop:t.top,viewportLeft:t.left},styles:{objectFit:n.objectFit,objectPosition:n.objectPosition,backgroundSize:n.backgroundSize,backgroundPosition:n.backgroundPosition},parent:a,attributes:p(e),preview:s}}(d),e({action:"updateLCP",value:u,element:g,rating:u<2500?"good":u<4e3?"needs-improvement":"poor"})):e({action:"updateLCP",value:u,element:null,rating:u<2500?"good":u<4e3?"needs-improvement":"poor"}))}).observe({type:"largest-contentful-paint",buffered:!0}),setTimeout(()=>{e({action:"updateLCP",value:u,element:g,rating:u<2500?"good":u<4e3?"needs-improvement":"poor"})},2e3)}catch(t){}}function p(e){const t={};return["loading","decoding","fetchpriority","sizes","srcset","data-src","data-lazy"].forEach(n=>{e.hasAttribute(n)&&(t[n]=e.getAttribute(n))}),t}function h(){const e=document.getElementById("bigscoots-lcp-highlight");e&&e.remove()}function f(){return{value:u,element:g,rating:u<2500?"good":u<4e3?"needs-improvement":"poor"}}const y="bigscoots_inp_"+Date.now();function b(){return window[y]||(window[y]={maxINP:0,interactions:new Map,inpEntries:[],isInitialized:!1,lastSentValue:null}),window[y]}function w(){const t=b();if(t.isInitialized)E();else if(window.PerformanceObserver)if(PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("event"))try{function o(t){if(!t.interactionId)return;const n=b(),o=t.interactionId,i=t.duration,r=n.interactions.get(o);if(!r||i>r){n.interactions.set(o,i);let r=null;t.target&&(r=function(e){if(!e)return null;try{const t=e.getBoundingClientRect();window.getComputedStyle(e);return{tagName:e.tagName,id:e.id||null,classList:e.classList?Array.from(e.classList):[],dimensions:{width:Math.round(t.width),height:Math.round(t.height)},position:{left:Math.round(t.left),top:Math.round(t.top)},selector:I(e),textContent:e.textContent?e.textContent.trim().substring(0,100):null}}catch(t){return{tagName:e.tagName||"UNKNOWN",error:"Could not capture details"}}}(t.target));const s={interactionId:o,duration:Math.round(i),startTime:t.startTime,name:t.name,target:t.target?t.target.tagName:"unknown",timestamp:Date.now(),element:r};if(i>n.maxINP){n.maxINP=i,n.inpEntries.unshift(s),n.inpEntries.length>10&&n.inpEntries.pop();const t=i<200?"good":i<500?"needs-improvement":"poor",o=Math.round(i);n.lastSentValue!==o&&(n.lastSentValue=o,e({action:"updateINP",value:o,entries:[...n.inpEntries],rating:t,status:"measured"}))}}}new PerformanceObserver(e=>{for(const t of e.getEntries())o(t)}).observe({type:"event",buffered:!0,durationThreshold:0}),t.isInitialized=!0,setTimeout(()=>{E()},3e3)}catch(n){T()}else T();else T()}function T(){const t=b();if(t.isInitialized)return void E();["pointerdown","click","keydown"].forEach(t=>{document.addEventListener(t,n=>{const o=performance.now();requestAnimationFrame(()=>{const i=performance.now()-o,r=b();if(i>r.maxINP){r.maxINP=i;const s={duration:Math.round(i),startTime:o,name:t,target:n.target?n.target.tagName:"unknown",method:"manual",timestamp:Date.now()};r.inpEntries.unshift(s),r.inpEntries.length>10&&r.inpEntries.pop();const a=i<200?"good":i<500?"needs-improvement":"poor",l=Math.round(i);r.lastSentValue!==l&&(r.lastSentValue=l,e({action:"updateINP",value:l,entries:[...r.inpEntries],rating:a,status:"measured"}))}})},{passive:!0,capture:!0})}),t.isInitialized=!0,setTimeout(()=>{E()},3e3)}function E(){const t=b();e({action:"updateINP",value:t.maxINP>0?Math.round(t.maxINP):null,entries:[...t.inpEntries],rating:t.maxINP<200?"good":t.maxINP<500?"needs-improvement":"poor",status:t.maxINP>0?"measured":"waiting"})}function v(){const e=b();return{value:e.maxINP>0?Math.round(e.maxINP):null,entries:[...e.inpEntries],rating:e.maxINP<200?"good":e.maxINP<500?"needs-improvement":"poor",status:e.maxINP>0?"measured":"waiting"}}function I(e){if(!e)return"";try{if(e.id)return`#${e.id}`;let t=e.tagName.toLowerCase();e.classList.length>0&&(t+="."+Array.from(e.classList).join("."));const n=e.parentElement;if(n){const o=Array.from(n.children).filter(t=>t.tagName===e.tagName);if(o.length>1){t+=`:nth-child(${o.indexOf(e)+1})`}}return t}catch(t){return e.tagName?e.tagName.toLowerCase():"unknown"}}const x={};function S(){return x}function N(e,t){const n=e.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth,r=n.top<o&&n.bottom>0,s=t.displayed.width>=150||t.displayed.height>=150,a=t.displayed.width*t.displayed.height>i*o*.02,l=n.top<.6*o&&(t.displayed.width>.3*i||t.displayed.height>.3*o),c=e.alt&&(e.alt.toLowerCase().includes("logo")||e.alt.toLowerCase().includes("brand")||e.className.toLowerCase().includes("logo")||e.id.toLowerCase().includes("logo"));return r&&(s||l||c)&&a}function C(e){return{jpg:"JPEG",jpeg:"JPEG",png:"PNG",gif:"GIF",webp:"WebP",avif:"AVIF",svg:"SVG"}[e.split(".").pop().split("?")[0].toLowerCase()]||"Unknown"}function L(){const e=new Map;performance.getEntriesByType("resource").filter(e=>"img"===e.initiatorType||e.name.match(/\.(jpg|jpeg|png|gif|webp|avif|svg)(\?.*)?$/i));return document.querySelectorAll('link[rel="preload"][as="image"]').forEach(t=>{e.set(t.href,{url:t.href,fetchpriority:t.getAttribute("fetchpriority")||null,type:"preload"})}),document.querySelectorAll("img[data-perfmatters-preload]").forEach(t=>{e.has(t.src)||e.set(t.src,{url:t.src,fetchpriority:t.getAttribute("fetchpriority")||null,type:"perfmatters"})}),document.querySelectorAll('img[loading="eager"]').forEach(t=>{e.has(t.src)||e.set(t.src,{url:t.src,fetchpriority:t.getAttribute("fetchpriority")||null,type:"eager"})}),Promise.resolve(Array.from(e.values()).map(e=>{const t=document.querySelector(`img[src="${e.url}"]`);if(t){const o={natural:{width:(n=t).naturalWidth||0,height:n.naturalHeight||0},displayed:{width:n.offsetWidth||0,height:n.offsetHeight||0}},i=function(e){const t=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight;return t.top<n&&t.bottom>0}(t),r=N(t,o),s=C(e.url),a=function(e,t){const n=[],{natural:o,displayed:i}=t;if(o.width>2*i.width||o.height>2*i.height){const e=o.width*o.height-i.width*i.height;n.push({type:"oversized",severity:"high",message:`Image is ${Math.round(e/1e3)}K pixels larger than needed`})}const r=C(e.src);return["JPEG","PNG"].includes(r)&&n.push({type:"format",severity:"low",message:`Consider modern formats like WebP or AVIF instead of ${r}`}),N(e,t)&&"lazy"===e.getAttribute("loading")&&n.push({type:"loading",severity:"high",message:"Critical image should not use lazy loading"}),n}(t,o);return{...e,dimensions:o,aboveFold:i,isCritical:r,format:s,issues:a,loading:t.getAttribute("loading")||"auto",decoding:t.getAttribute("decoding")||"auto",fetchpriority:t.getAttribute("fetchpriority")||null}}var n;return{...e,aboveFold:!1,isCritical:!1,format:C(e.url),issues:[{type:"missing",severity:"low",message:"Image not found in DOM"}]}}))}function P(){const e=document.getElementById("bigscoots-image-highlight");e&&e.remove()}function A(e){return{woff2:"WOFF2",woff:"WOFF",ttf:"TTF",otf:"OTF",eot:"EOT",svg:"SVG"}[e.split(".").pop().split("?")[0].toLowerCase()]||"Unknown"}async function _(){try{e({action:"updatePSIStatus",status:"loading",message:"Fetching PageSpeed Insights data..."});const t=await async function(){try{const e=window.location.href,t=`https://psi-api-worker-staging.cache-warmer-getjoinus.workers.dev/?url=${encodeURIComponent(e)}`,n=await fetch(t);if(!n.ok)throw new Error(`PSI API request failed: ${n.status} ${n.statusText}`);const o=await n.json();if("failed"===o.status||"error"===o.status){const e=o.message||"Unknown error occurred",t=o.error?` (${o.error.type}: ${o.error.code})`:"";throw new Error(`${e}${t}`)}if("success"!==o.status)throw new Error(`PSI API error: ${o.message||"Unknown error"}`);return o}catch(e){if(e.message.includes("[object Object]"))throw new Error("Failed to analyze page with PageSpeed Insights. Please try again.");throw e}}(),n=function(e){try{if(!e||!e.data||!e.data.loadingExperience)return null;const t=e.data.loadingExperience,n=t.metrics;if(!n)return null;const o={id:t.id,overallCategory:t.overall_category};return n.CUMULATIVE_LAYOUT_SHIFT_SCORE&&(o.cls={percentile:n.CUMULATIVE_LAYOUT_SHIFT_SCORE.percentile,category:n.CUMULATIVE_LAYOUT_SHIFT_SCORE.category,distributions:n.CUMULATIVE_LAYOUT_SHIFT_SCORE.distributions,value:n.CUMULATIVE_LAYOUT_SHIFT_SCORE.percentile/100}),n.LARGEST_CONTENTFUL_PAINT_MS&&(o.lcp={percentile:n.LARGEST_CONTENTFUL_PAINT_MS.percentile,category:n.LARGEST_CONTENTFUL_PAINT_MS.category,distributions:n.LARGEST_CONTENTFUL_PAINT_MS.distributions,value:n.LARGEST_CONTENTFUL_PAINT_MS.percentile}),n.INTERACTION_TO_NEXT_PAINT&&(o.inp={percentile:n.INTERACTION_TO_NEXT_PAINT.percentile,category:n.INTERACTION_TO_NEXT_PAINT.category,distributions:n.INTERACTION_TO_NEXT_PAINT.distributions,value:n.INTERACTION_TO_NEXT_PAINT.percentile}),n.EXPERIMENTAL_TIME_TO_FIRST_BYTE&&(o.ttfb={percentile:n.EXPERIMENTAL_TIME_TO_FIRST_BYTE.percentile,category:n.EXPERIMENTAL_TIME_TO_FIRST_BYTE.category,distributions:n.EXPERIMENTAL_TIME_TO_FIRST_BYTE.distributions,value:n.EXPERIMENTAL_TIME_TO_FIRST_BYTE.percentile}),n.FIRST_CONTENTFUL_PAINT_MS&&(o.fcp={percentile:n.FIRST_CONTENTFUL_PAINT_MS.percentile,category:n.FIRST_CONTENTFUL_PAINT_MS.category,distributions:n.FIRST_CONTENTFUL_PAINT_MS.distributions,value:n.FIRST_CONTENTFUL_PAINT_MS.percentile}),o}catch(t){return null}}(t),o=function(e){try{var t,n,o;let i=null;if(null!=e&&null!==(t=e.data)&&void 0!==t&&t.metrics)i=e.data.metrics;else if(null!=e&&null!==(n=e.data)&&void 0!==n&&null!==(n=n.lighthouseResult)&&void 0!==n&&n.audits){const t=e.data.lighthouseResult.audits;i={},t["cumulative-layout-shift"]&&(i.CLS=t["cumulative-layout-shift"]),t["largest-contentful-paint"]&&(i.LCP=t["largest-contentful-paint"])}else null!=e&&null!==(o=e.data)&&void 0!==o&&o.labData&&(i=e.data.labData);if(!i)return null;const r={};return i.CLS&&(r.cls={numericValue:i.CLS.numericValue,displayValue:i.CLS.displayValue,score:i.CLS.score,value:i.CLS.numericValue}),i.LCP&&(r.lcp={numericValue:i.LCP.numericValue,displayValue:i.LCP.displayValue,score:i.LCP.score,value:i.LCP.numericValue}),Object.keys(r).length>0?r:null}catch(i){return null}}(t);return e({action:"storePSIResults",psiData:{allFieldData:n,labData:o,timestamp:Date.now(),url:window.location.href,rawData:t.data}}),e({action:"completePSIResults",psiData:t}),n&&(n.cls&&e({action:"updatePSICLS",fieldData:n.cls,status:"success"}),n.lcp&&e({action:"updatePSILCP",fieldData:n.lcp,status:"success"}),n.inp&&e({action:"updatePSIINP",fieldData:n.inp,status:"success"}),n.ttfb&&e({action:"updatePSITTFB",fieldData:n.ttfb,status:"success"})),o&&(o.cls&&e({action:"updatePSILabCLS",labData:o.cls,status:"success"}),o.lcp&&e({action:"updatePSILabLCP",labData:o.lcp,status:"success"})),e({action:"updatePSIStatus",status:"success",message:"PSI data loaded successfully"}),!0}catch(t){let n="Analysis failed. Please try again.";return t.message&&(n=t.message.includes("hosting requirements")?"This site doesn't meet hosting requirements for analysis.":t.message.includes("403")?"Access denied. Site may not be eligible for analysis.":t.message.includes("404")?"Page not found or not accessible for analysis.":t.message.includes("500")?"Server error occurred. Please try again later.":t.message.includes("network")||t.message.includes("fetch")?"Network error. Please check your connection and try again.":t.message),e({action:"updatePSIStatus",status:"error",message:`Error analyzing PSI data: ${t.message}`,userMessage:n}),!1}}function O(){const e=document.documentElement.outerHTML,t=e.includes("data-pmdelayedstyle")?"enabled":"disabled",n=e.includes("pmdelayedscript")?"enabled":"disabled",o=Object.fromEntries(Object.entries({gtm:/GTM-\w+/g,ua:/UA-\d+-\d+/g,ga4:/G-[A-Z0-9]{9,}/g,ga:/GA-[A-Z0-9]+/g}).map(([t,n])=>[t,[...new Set(e.match(n)||[])]]));return{perfmattersRUCSS:t,perfmattersDelayJS:n,gtm:o.gtm.join(", "),ua:o.ua.join(", "),ga4:o.ga4.join(", "),ga:o.ga.join(", "),adProvider:M()}}function M(){const e=document.documentElement.outerHTML,t=Array.from(document.scripts).map(e=>e.src),n={Mediavine:{domains:["scripts.mediavine.com","ads.mediavine.com"],patterns:["window.mediavineDomain","__mediavineMachine"],enabled:!1},"AdThrive/Raptive":{domains:["ads.adthrive.com","cdn.adthrive.com"],patterns:["window.adthrive","adthrive.config"],enabled:!1},Ezoic:{domains:["www.ezojs.com","ezoic.com","ezoic.net"],patterns:["ezstandalone","ez_ad_units"],enabled:!1},"Google AdSense":{domains:["pagead2.googlesyndication.com","adsbygoogle"],patterns:["adsbygoogle.push","(adsbygoogle"],enabled:!1}};Object.keys(n).forEach(o=>{const i=n[o].domains.some(e=>t.some(t=>t&&t.includes(e))),r=n[o].patterns.some(t=>e.includes(t));(i||r)&&(n[o].enabled=!0)});return Object.keys(n).filter(e=>n[e].enabled).join(", ")||"None detected"}async function R(){if(!["portal.bigscoots.com","wpo-admin.bigscoots.com","wpo.bigscoots.com"].some(e=>window.location.hostname===e)&&!window.location.hostname.endsWith("bigscoots-wpo.com")){!function(){if(window.PerformanceObserver)try{new PerformanceObserver(a=>{for(const l of a.getEntries())if(!l.hadRecentInput){if(t+=l.value,l.sources&&l.sources.length>0){const e=l.sources.reduce((e,t)=>r(t)>r(e)?t:e);l.value>i&&(i=l.value,o=e.node)}const a={value:l.value,startTime:l.startTime,sources:l.sources?l.sources.map(e=>({node:e.node?e.node.tagName:"unknown",currentRect:e.currentRect,previousRect:e.previousRect,shiftValue:r(e)})):[]};n.push(a);let c=null;o&&(c=s(o,i)),e({action:"updateCLS",value:t,entries:n,element:c,rating:t<.1?"good":t<.25?"needs-improvement":"poor"})}}).observe({type:"layout-shift",buffered:!0}),setTimeout(()=>{let r=null;o&&(r=s(o,i)),e({action:"updateCLS",value:t,entries:n,element:r,rating:t<.1?"good":t<.25?"needs-improvement":"poor"})},1e3)}catch(a){}}(),m(),w(),function(){const t=performance.getEntriesByType("navigation")[0];t&&(x.ttfb=Math.round(t.responseStart-t.requestStart),x.domLoad=Math.round(t.domContentLoadedEventEnd-t.navigationStart),x.pageLoad=Math.round(t.loadEventEnd-t.navigationStart));try{new PerformanceObserver(t=>{for(const n of t.getEntries())"first-contentful-paint"===n.name&&(x.fcp=Math.round(n.startTime),e({action:"updateAdditionalMetrics",metrics:x}))}).observe({type:"paint",buffered:!0})}catch(n){}setTimeout(()=>{e({action:"updateAdditionalMetrics",metrics:x})},1500)}();try{const[t,n,o,i]=await Promise.all([L(),new Promise(e=>{const t=performance.getEntriesByType("resource").filter(e=>{const t=e.startTime<3e3,n="css"===e.initiatorType&&(e.name.includes("/fonts/")||e.name.match(/\.(woff2?|ttf|otf|eot)($|\?)/i));return t&&n}),n=Array.from(document.querySelectorAll('link[rel="preload"][as="font"]')).map(e=>({url:e.href,fetchpriority:e.getAttribute("fetchpriority")||null,type:e.getAttribute("type")||null,crossorigin:e.getAttribute("crossorigin")||null})),o=new Map;t.forEach(e=>{const t=n.find(t=>t.url===e.name);var i;o.set(e.name,{url:e.name,loadTime:Math.round(e.startTime),preloaded:!!t,fetchpriority:(null==t?void 0:t.fetchpriority)||null,type:A(e.name),crossorigin:(null==t?void 0:t.crossorigin)||null,fileSize:e.transferSize||null,fileSizeFormatted:e.transferSize?(i=e.transferSize,i?i<1024?i+" B":i<1048576?(i/1024).toFixed(1)+" KB":(i/1048576).toFixed(1)+" MB":"Unknown"):null})}),n.forEach(e=>{o.has(e.url)||o.set(e.url,{url:e.url,loadTime:0,preloaded:!0,fetchpriority:e.fetchpriority,type:A(e.url),crossorigin:e.crossorigin,fileSize:null,fileSizeFormatted:null})}),e(Array.from(o.values()).sort((e,t)=>e.loadTime-t.loadTime))}),fetch(window.location.href,{method:"GET",cache:"no-store",credentials:"include"}).then(e=>{const t={};return["x-bigscoots-cache-status","cf-cache-status","x-hosted-by","x-bigscoots-cache-plan","content-encoding","x-bigscoots-cache-mode","x-ezoic-cdn","x-np-cfe"].forEach(n=>{t[n]=e.headers.get(n)||"N/A"}),t["x-bigscoots-cache-mode (O2O)"]="N/A"!==t["x-bigscoots-cache-mode"]?"Enabled":"Disabled",t["x-np-cfe"]="N/A"!==t["x-np-cfe"]?"Nerdpress active":t["x-np-cfe"],t}).catch(e=>({})),Promise.resolve(O())]);e({action:"analysisResults",...{images:t,fonts:n,headers:{...o,...i},cls:c(),lcp:f(),inp:v(),additionalMetrics:S()}}),e({action:"updateBadge",hostedBy:o["x-hosted-by"]||"N/A",cacheStatus:o["x-bigscoots-cache-status"]||o["cf-cache-status"]||"N/A"})}catch(a){}}}R(),chrome.runtime.onMessage.addListener((e,t,n)=>{if("ping"===e.action)return n({ready:!0}),!1;if("getCurrentPerformanceData"===e.action){const e={cls:c(),lcp:f(),inp:v(),additionalMetrics:S()};return n(e),!1}if("highlightImage"===e.action){const t=function(e){P();const t=document.querySelectorAll("img");let n=null;for(const o of t)if(o.src===e||o.currentSrc===e){n=o;break}if(!n){const t=document.querySelectorAll("*");for(const o of t){const t=window.getComputedStyle(o).backgroundImage;if(t&&t.includes(e)){n=o;break}}}if(n){const e=document.createElement("div");if(e.id="bigscoots-image-highlight",e.style.cssText="\n      position: absolute;\n      pointer-events: none;\n      z-index: 999999;\n      border: 3px solid #ff4444;\n      background: rgba(255, 68, 68, 0.1);\n      box-shadow: 0 0 0 2px rgba(255, 68, 68, 0.3), 0 0 20px rgba(255, 68, 68, 0.5);\n      animation: bigscoots-pulse 2s infinite;\n      border-radius: 4px;\n    ",!document.getElementById("bigscoots-highlight-styles")){const e=document.createElement("style");e.id="bigscoots-highlight-styles",e.textContent="\n        @keyframes bigscoots-pulse {\n          0% { box-shadow: 0 0 0 2px rgba(255, 68, 68, 0.3), 0 0 20px rgba(255, 68, 68, 0.5); }\n          50% { box-shadow: 0 0 0 6px rgba(255, 68, 68, 0.5), 0 0 30px rgba(255, 68, 68, 0.8); }\n          100% { box-shadow: 0 0 0 2px rgba(255, 68, 68, 0.3), 0 0 20px rgba(255, 68, 68, 0.5); }\n        }\n      ",document.head.appendChild(e)}const t=n.getBoundingClientRect(),o=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;return e.style.top=t.top+o-3+"px",e.style.left=t.left+i-3+"px",e.style.width=t.width+6+"px",e.style.height=t.height+6+"px",document.body.appendChild(e),n.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),setTimeout(()=>{P()},5e3),!0}return!1}(e.imageUrl);return n({success:t}),!1}if("highlightLCPElement"===e.action){const e=function(){if(!d)return!1;h();const e=document.createElement("div");if(e.id="bigscoots-lcp-highlight",e.style.cssText="\n    position: absolute;\n    pointer-events: none;\n    z-index: 999999;\n    border: 3px solid #007aff;\n    background: rgba(0, 122, 255, 0.1);\n    box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.3), 0 0 20px rgba(0, 122, 255, 0.5);\n    animation: bigscoots-lcp-pulse 2s infinite;\n    border-radius: 4px;\n  ",!document.getElementById("bigscoots-lcp-highlight-styles")){const e=document.createElement("style");e.id="bigscoots-lcp-highlight-styles",e.textContent="\n      @keyframes bigscoots-lcp-pulse {\n        0% { box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.3), 0 0 20px rgba(0, 122, 255, 0.5); }\n        50% { box-shadow: 0 0 0 6px rgba(0, 122, 255, 0.5), 0 0 30px rgba(0, 122, 255, 0.8); }\n        100% { box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.3), 0 0 20px rgba(0, 122, 255, 0.5); }\n      }\n    ",document.head.appendChild(e)}const t=d.getBoundingClientRect(),n=window.pageYOffset||document.documentElement.scrollTop,o=window.pageXOffset||document.documentElement.scrollLeft;return e.style.top=t.top+n-3+"px",e.style.left=t.left+o-3+"px",e.style.width=t.width+6+"px",e.style.height=t.height+6+"px",document.body.appendChild(e),d.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),setTimeout(()=>{h()},5e3),!0}();return n({success:e}),!1}if("highlightCLSElement"===e.action){const e=function(){if(!o)return!1;l();const e=document.createElement("div");if(e.id="bigscoots-cls-highlight",e.style.cssText="\n    position: absolute;\n    pointer-events: none;\n    z-index: 999999;\n    border: 3px solid #ff9500;\n    background: rgba(255, 149, 0, 0.1);\n    box-shadow: 0 0 0 2px rgba(255, 149, 0, 0.3), 0 0 20px rgba(255, 149, 0, 0.5);\n    animation: bigscoots-cls-pulse 2s infinite;\n    border-radius: 4px;\n  ",!document.getElementById("bigscoots-cls-highlight-styles")){const e=document.createElement("style");e.id="bigscoots-cls-highlight-styles",e.textContent="\n      @keyframes bigscoots-cls-pulse {\n        0% { box-shadow: 0 0 0 2px rgba(255, 149, 0, 0.3), 0 0 20px rgba(255, 149, 0, 0.5); }\n        50% { box-shadow: 0 0 0 6px rgba(255, 149, 0, 0.5), 0 0 30px rgba(255, 149, 0, 0.8); }\n        100% { box-shadow: 0 0 0 2px rgba(255, 149, 0, 0.3), 0 0 20px rgba(255, 149, 0, 0.5); }\n      }\n    ",document.head.appendChild(e)}const t=o.getBoundingClientRect(),n=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;return e.style.top=t.top+n-3+"px",e.style.left=t.left+i-3+"px",e.style.width=t.width+6+"px",e.style.height=t.height+6+"px",document.body.appendChild(e),o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),setTimeout(()=>{l()},5e3),!0}();return n({success:e}),!1}if("highlightINPElement"===e.action){const e=function(){try{const t=v();if(!t.entries||0===t.entries.length)return!1;const n=t.entries[0];if(!n.element||!n.element.selector)return!1;let o=null;try{o=document.querySelector(n.element.selector)}catch(e){}if(!o&&n.element.id&&(o=document.getElementById(n.element.id)),!o&&n.element.classList&&n.element.classList.length>0&&(o=document.querySelector(`.${n.element.classList[0]}`)),!o)return!1;const i=document.createElement("div");i.id="bigscoots-inp-highlight",i.style.cssText="\n      position: fixed !important;\n      pointer-events: none !important;\n      z-index: 999999 !important;\n      border: 3px solid #ff6b35 !important;\n      background: rgba(255, 107, 53, 0.1) !important;\n      border-radius: 4px !important;\n      box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.3) !important;\n      transition: all 0.3s ease !important;\n    ";const r=o.getBoundingClientRect();i.style.left=r.left-3+"px",i.style.top=r.top-3+"px",i.style.width=`${r.width+6}px`,i.style.height=`${r.height+6}px`;const s=document.getElementById("bigscoots-inp-highlight");s&&s.remove(),document.body.appendChild(i),o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});let a=0;const l=setInterval(()=>{a>=6?clearInterval(l):(i.style.transform=a%2==0?"scale(1.05)":"scale(1)",a++)},300);return setTimeout(()=>{i&&i.parentNode&&i.remove()},3e3),!0}catch(e){return!1}}();return n({success:e}),!1}if("requestAnalysis"===e.action)return R(),n({success:!0}),!1;if("analyzePSI"===e.action){return(async()=>{try{await _();n({success:!0})}catch(e){n({success:!1,error:e.message})}})(),!0}return!1})})();
//# sourceMappingURL=content.js.map