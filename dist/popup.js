(()=>{"use strict";var e={153:(e,t,n)=>{n.r(t),n.d(t,{setupToggleManagement:()=>l,updateToggleStates:()=>r});let a=!1;const s=[];let i=null;function l(){!async function(){try{const e=await window.getTargetTabId();if(!e)return document.getElementById("perfmattersoff").checked=!1,document.getElementById("perfmatterscssoff").checked=!1,document.getElementById("perfmattersjsoff").checked=!1,document.getElementById("nocache").checked=!1,void r(!0);chrome.runtime.sendMessage({action:"getParameters",tabId:e},e=>{chrome.runtime.lastError&&(e=[]),Array.isArray(e)||(e=[]),document.getElementById("perfmattersoff").checked=e.includes("perfmattersoff"),document.getElementById("perfmatterscssoff").checked=e.includes("perfmatterscssoff"),document.getElementById("perfmattersjsoff").checked=e.includes("perfmattersjsoff"),document.getElementById("nocache").checked=e.includes("nocache"),r(!0)})}catch(e){document.getElementById("perfmattersoff").checked=!1,document.getElementById("perfmatterscssoff").checked=!1,document.getElementById("perfmattersjsoff").checked=!1,document.getElementById("nocache").checked=!1,r(!0)}}();document.querySelectorAll(".toggle-input").forEach(e=>{e.addEventListener("change",t=>{if(a)return t.preventDefault(),void(e.checked=!e.checked);!function(e,t){const n={toggleId:e,isChecked:t,timestamp:Date.now()};s.push(n),a||async function(){if(a||0===s.length)return;a=!0;for(;s.length>0;){const e=s.shift();i=e,r(!0),await o(e.toggleId,e.isChecked)}i=null,a=!1,r(!0)}()}(e.id,e.checked)})})}async function o(e,t){return new Promise(async n=>{const a={perfmattersoff:"perfmattersoff",perfmatterscssoff:"perfmatterscssoff",perfmattersjsoff:"perfmattersjsoff",nocache:"nocache"}[e];if(a)try{const e=await window.getTargetTabId();if(!e)return void n();chrome.runtime.sendMessage({action:"updateParameters",parameter:a,add:t,tabId:e},t=>{var a;chrome.runtime.lastError?n():t&&t.error?n():t&&t.urlChanged?(a=e,new Promise((e,t)=>{const n=2e4,s=Date.now();function i(){chrome.tabs.get(a,a=>{chrome.runtime.lastError?t(new Error("Tab not found")):"complete"!==a.status?Date.now()-s>n?e():setTimeout(i,500):setTimeout(()=>{e()},3e3)})}i()})).then(()=>{n()}).catch(e=>{setTimeout(n,5e3)}):setTimeout(n,2e3)})}catch(s){n()}else n()})}function r(e=!1){const t=document.getElementById("perfmattersoff"),n=document.getElementById("perfmatterscssoff"),s=document.getElementById("perfmattersjsoff"),l=document.getElementById("nocache"),o=t.checked,r=[t.closest(".toggle-container"),n.closest(".toggle-container"),s.closest(".toggle-container"),l.closest(".toggle-container")];if(a)return void r.forEach((e,t)=>{const n=["perfmattersoff","perfmatterscssoff","perfmattersjsoff","nocache"][t];if(e){const t=e.querySelector(".toggle-input");t&&(t.disabled=!0),i&&i.toggleId===n?(e.classList.add("processing-current"),e.classList.remove("disabled-toggle")):(e.classList.add("disabled-toggle"),e.classList.remove("processing-current"))}});r.forEach(e=>{if(e){e.classList.remove("processing-current","disabled-toggle");const t=e.querySelector(".toggle-input");t&&(t.disabled=!1)}}),[n,s].forEach(e=>{e.disabled=o;const t=e.closest(".toggle-container");o?(e.checked=!1,t.classList.add("disabled-toggle")):t.classList.remove("disabled-toggle")}),l.disabled=o||n.checked||s.checked;const c=l.closest(".toggle-container");l.disabled?(l.checked&&(l.checked=!1),c.classList.add("disabled-toggle")):c.classList.remove("disabled-toggle"),t.disabled=!1;t.closest(".toggle-container").classList.remove("disabled-toggle")}},194:(e,t,n)=>{n.d(t,{Wm:()=>o,d2:()=>l,iF:()=>i});const a={WINDOW_STATE:"popup_window_state",DETACHED_WINDOW_ID:"detached_window_id",WINDOW_BOUNDS:"detached_window_bounds"},s=globalThis.chrome||self.chrome;async function i(){try{return(await s.storage.local.get("originalTabId")).originalTabId||null}catch(e){return null}}async function l(){try{await s.storage.local.remove("originalTabId")}catch(e){}}async function o(){try{const e=await async function(){try{return(await s.windows.getCurrent()).id}catch(e){return null}}();return e===await async function(){try{return(await s.storage.local.get(a.DETACHED_WINDOW_ID))[a.DETACHED_WINDOW_ID]||null}catch(e){return null}}()}catch(e){return!1}}},607:(e,t,n)=>{n.d(t,{Oc:()=>l,Rn:()=>i,TE:()=>r,pT:()=>o,rq:()=>s});var a=n(194);async function s(){try{const e=new URLSearchParams(window.location.search).get("originalTabId");if(e){return Number.parseInt(e,10)}const t=await(0,a.iF)();return t||null}catch(e){return null}}async function i(e){if(!e)return!1;try{return new Promise(t=>{chrome.tabs.get(Number.parseInt(e,10),e=>{chrome.runtime.lastError?t(!1):t(!0)})})}catch(t){return!1}}async function l(){try{if(new URLSearchParams(window.location.search).has("originalTabId")){const e=await s();if(e){return await i(e)?e:null}return null}return new Promise(e=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{if(chrome.runtime.lastError||!t||0===t.length)return void e(null);const n=t[0].id;e(n)})})}catch(e){return null}}async function o(e,t){if(!e)return null;try{return new Promise(n=>{chrome.tabs.sendMessage(Number.parseInt(e,10),t,e=>{chrome.runtime.lastError?n(null):n(e)})})}catch(n){return null}}function r(e,t="success",n=1e3){if(!e)return;const a=e.style.transform,s=e.style.transition;e.style.transition="transform 0.1s ease",e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="scale(1)",setTimeout(()=>{e.style.transform=a,e.style.transition=s},100)},50)}},665:(e,t,n)=>{n.d(t,{IC:()=>U,X4:()=>I,Wl:()=>T,jd:()=>M,jl:()=>N,updateInsightsState:()=>b,LM:()=>S,sK:()=>B,RK:()=>P,vA:()=>A,LV:()=>H,yk:()=>j,gY:()=>O,eB:()=>D,_3:()=>$});var a=n(607);let s=null,i=0;const l="error",o="info",r={duration:{success:2500,error:4e3,warning:3e3,info:2500},maxToasts:3,position:"top-center"};function c(e,t=o,n={}){!function(){if(!s){switch(s=document.createElement("div"),s.id="toast-container",s.className=`toast-container toast-${r.position}`,s.style.cssText="\n    position: fixed;\n    z-index: 10000;\n    pointer-events: none;\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n    max-width: 320px;\n    padding: 8px;\n  ",r.position){case"top-center":s.style.top="8px",s.style.left="50%",s.style.transform="translateX(-50%)";break;case"top-right":s.style.top="8px",s.style.right="8px";break;case"top-left":s.style.top="8px",s.style.left="8px";break;case"bottom-right":s.style.bottom="8px",s.style.right="8px",s.style.flexDirection="column-reverse";break;case"bottom-left":s.style.bottom="8px",s.style.left="8px",s.style.flexDirection="column-reverse"}document.body.appendChild(s)}}();const a="toast-"+ ++i,l=n.duration||r.duration[t],c=!1!==n.dismissible,m=!1!==n.compact,u=document.createElement("div");u.id=a,u.className=`toast toast-${t} ${m?"toast-compact":""}`,u.style.pointerEvents="auto";const p=function(e){const t={success:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>\n      <polyline points="22,4 12,14.01 9,11.01"></polyline>\n    </svg>',error:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <circle cx="12" cy="12" r="10"></circle>\n      <line x1="15" y1="9" x2="9" y2="15"></line>\n      <line x1="9" y1="9" x2="15" y2="15"></line>\n    </svg>',warning:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>\n      <line x1="12" y1="9" x2="12" y2="13"></line>\n      <line x1="12" y1="17" x2="12.01" y2="17"></line>\n    </svg>',info:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <circle cx="12" cy="12" r="10"></circle>\n      <line x1="12" y1="16" x2="12" y2="12"></line>\n      <line x1="12" y1="8" x2="12.01" y2="8"></line>\n    </svg>'};return t[e]||t.info}(t);if(u.innerHTML=m?`\n      <div class="toast-content-compact">\n        <div class="toast-icon-compact">${p}</div>\n        <div class="toast-message-compact">${e}</div>\n        ${c?'<button class="toast-dismiss-compact" aria-label="Dismiss">Ã—</button>':""}\n      </div>\n      <div class="toast-progress-compact"></div>\n    `:`\n      <div class="toast-content">\n        <div class="toast-icon">${p}</div>\n        <div class="toast-message">${e}</div>\n        ${c?'<button class="toast-dismiss" aria-label="Dismiss">&times;</button>':""}\n      </div>\n      <div class="toast-progress"></div>\n    `,c){u.querySelector(m?".toast-dismiss-compact":".toast-dismiss").addEventListener("click",()=>d(u))}if(s.appendChild(u),requestAnimationFrame(()=>{u.classList.add("toast-show")}),l>0){u.querySelector(m?".toast-progress-compact":".toast-progress").style.animation=`toast-progress ${l}ms linear`,setTimeout(()=>{d(u)},l)}return function(){const e=s.querySelectorAll(".toast");if(e.length>r.maxToasts){d(e[0])}}(),u}function d(e){e&&e.parentNode&&(e.classList.add("toast-hide"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}const m=new class{constructor(){this.expandedInsights=new Set,this.activeTooltip=null}renderInsights(e,t){if(!e)return;if(e.innerHTML="",!t||!Array.isArray(t)||0===t.length)return void this.renderEmptyState(e);const n=this.renderHeader(t.length);e.appendChild(n),t.forEach((t,n)=>{const a=this.renderInsightItem(t,n);e.appendChild(a)}),this.initializeTooltips()}initializeTooltips(){this.cleanupTooltips(),document.querySelectorAll(".tooltip-trigger").forEach(e=>{e.addEventListener("mouseenter",e=>this.showTooltip(e)),e.addEventListener("mouseleave",e=>this.hideTooltip(e)),e.addEventListener("mousemove",e=>this.updateTooltipPosition(e))})}cleanupTooltips(){document.querySelectorAll(".smart-tooltip").forEach(e=>e.remove()),this.activeTooltip=null}showTooltip(e){this.cleanupTooltips();const t=e.target,n=t.getAttribute("data-tooltip");if(!n)return;const a=document.createElement("div");a.className="smart-tooltip",a.textContent=n,document.body.appendChild(a),this.activeTooltip=a,t._tooltip=a,this.positionTooltip(t,a)}positionTooltip(e,t){const n=e.getBoundingClientRect(),a=t.getBoundingClientRect(),s=window.innerWidth,i=window.innerHeight,l=16;let o=n.left,r=n.bottom+8;o+a.width>s-l&&(o=s-a.width-l),o<l&&(o=l),r+a.height>i-l&&(r=n.top-a.height-8),r<l&&(r=n.bottom+8),t.style.left=`${o}px`,t.style.top=`${r}px`,t.style.opacity="1",t.style.transform="translateY(0)"}updateTooltipPosition(e){if(!this.activeTooltip)return;const t=e.target;this.positionTooltip(t,this.activeTooltip)}hideTooltip(e){const t=e.target;t._tooltip&&(t._tooltip.remove(),t._tooltip=null),this.activeTooltip&&(this.activeTooltip.remove(),this.activeTooltip=null)}renderHeader(e){const t=document.createElement("div");t.className="psi-insights-header";const n=document.createElement("h3");n.className="section-title",n.textContent="Performance Insights";const a=document.createElement("span");return a.className="insights-count",a.textContent=`${e} insights`,t.appendChild(n),t.appendChild(a),t}renderInsightItem(e,t){const n=document.createElement("div"),a=this.determineInsightStatus(e);n.className=`psi-insight-item ${a}`;const s=this.renderInsightHeader(e,t);n.appendChild(s);const i=this.renderInsightContent(e);return n.appendChild(i),n}determineInsightStatus(e){if(e.category)switch(e.category){case"failed":return"failed-insight";case"warning":return"warning-insight";default:return"unknown-insight"}if(void 0===e.score||null===e.score)return"unknown-insight";const t=Number.parseFloat(e.score);return t<.5?"failed-insight":t<.9?"warning-insight":"unknown-insight"}renderInsightHeader(e,t){const n=document.createElement("div");n.className="insight-header",n.setAttribute("role","button"),n.setAttribute("tabindex","0"),n.setAttribute("aria-expanded","false");const a=document.createElement("div");a.className="insight-title",a.textContent=this.formatInsightTitle(e.title||e.id);const s=document.createElement("div");return s.className="insight-expand-icon",s.innerHTML='\n            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                <polyline points="6,9 12,15 18,9"></polyline>\n            </svg>\n        ',n.appendChild(a),n.appendChild(s),n.addEventListener("click",()=>this.toggleInsight(n.parentElement,t)),n.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.toggleInsight(n.parentElement,t))}),n}renderInsightContent(e){const t=document.createElement("div");if(t.className="insight-content",e.description){const n=this.renderDescription(e.description);t.appendChild(n)}if("network-dependency-tree-insight"===e.id||"critical-request-chains"===e.id){const n=this.renderNetworkDependencyFromAPI(e);return t.appendChild(n),t}if(e.details)if("network-tree"===e.details.type){const n=this.renderNetworkTree(e.details);t.appendChild(n)}else if(e.details.items){const n=this.renderDetails(e.details,e);n.children.length>0&&t.appendChild(n)}else{const n=document.createElement("div");n.className="debug-details",n.innerHTML=`<pre style="font-size: 10px; max-height: 150px; overflow: auto;">${JSON.stringify(e.details,null,2)}</pre>`,t.appendChild(n)}else{const e=document.createElement("div");e.className="no-data-message",e.textContent="No detailed data available",t.appendChild(e)}return t}renderNetworkDependencyFromAPI(e){const t=document.createElement("div");t.className="network-dependency-container";let n=null,a=null;if(e.details&&e.details.items&&e.details.items.length>0){const t=e.details.items[0];t.value&&t.value.chains&&(n=t.value.chains,a=t.value.longestChain)}if(n&&Object.keys(n).length>0){const e=document.createElement("div");e.className="network-summary";const s=Object.keys(n).length;e.innerHTML=`\n        <div class="summary-item">\n          <span class="summary-label">Critical chains:</span>\n          <span class="summary-value">${s}</span>\n        </div>\n        ${a&&a.duration?`\n        <div class="summary-item">\n          <span class="summary-label">Longest chain:</span>\n          <span class="summary-value">${Math.round(a.duration)}ms</span>\n        </div>\n        `:""}\n      `,t.appendChild(e);const i=document.createElement("div");i.className="critical-chains",Object.entries(n).forEach(([e,t],n)=>{const a=document.createElement("div");a.className="chain-header",a.textContent=`Chain ${n+1}`,i.appendChild(a);const s=this.renderAPIChain(t,0);i.appendChild(s)}),t.appendChild(i)}else{const e=document.createElement("div");e.className="no-chains-message",e.textContent="No critical request chains detected",t.appendChild(e)}return t}renderAPIChain(e,t){const n=document.createElement("div");n.className=`critical-chain-item depth-${t}`;const a=document.createElement("div");a.className="chain-item";const s=document.createElement("div");s.className="chain-indent",s.style.width=16*t+"px",t>0&&(s.innerHTML="â””â”€ ");const i=e.url||"Unknown URL",l=this.extractFilename(i),o=this.extractDomain(i),r=document.createElement("div");r.className="chain-url";const c=document.createElement("span");if(c.className="url-text tooltip-trigger",c.setAttribute("data-tooltip",i),c.textContent=l,o&&!o.includes(window.location.hostname)){const e=document.createElement("span");e.className="url-domain",e.textContent=` (${o})`,c.appendChild(e)}r.appendChild(c);const d=document.createElement("div");d.className="chain-timing";const m=e.transferSize||0,u=e.navStartToEndTime||0;return d.innerHTML=`\n      <span class="timing-size">${this.formatBytes(m)}</span>\n      <span class="timing-duration">${Math.round(u)}ms</span>\n    `,a.appendChild(s),a.appendChild(r),a.appendChild(d),n.appendChild(a),e.children&&Object.keys(e.children).length>0&&Object.values(e.children).forEach(e=>{const a=this.renderAPIChain(e,t+1);n.appendChild(a)}),n}renderNetworkDependencyTree(e){const t=document.createElement("div");t.className="network-dependency-container";let n=null;if(e.details&&e.details.chains)n=e.details.chains;else if(e.details&&e.details.items)for(const a of e.details.items)if(a.chains){n=a.chains;break}if(n&&Object.keys(n).length>0){const e=document.createElement("div");e.className="network-summary";const a=Object.keys(n).length,s=this.findLongestChain(n);e.innerHTML=`\n        <div class="summary-item">\n          <span class="summary-label">Critical chains:</span>\n          <span class="summary-value">${a}</span>\n        </div>\n        ${s?`\n        <div class="summary-item">\n          <span class="summary-label">Longest chain:</span>\n          <span class="summary-value">${Math.round(s.duration)}ms</span>\n        </div>\n        `:""}\n      `,t.appendChild(e);const i=document.createElement("div");i.className="critical-chains",Object.entries(n).forEach(([e,t],n)=>{const a=document.createElement("div");a.className="chain-header",a.textContent=`Chain ${n+1}`,i.appendChild(a);const s=this.renderCriticalChain(t,0);i.appendChild(s)}),t.appendChild(i)}else{const e=document.createElement("div");e.className="no-chains-message",e.textContent="No critical request chains detected",t.appendChild(e)}return t}findLongestChain(e){let t=null,n=0;return Object.values(e).forEach(e=>{const a=this.calculateChainDuration(e);a>n&&(n=a,t={...e,duration:a})}),t}calculateChainDuration(e){let t=e.transferSize||0;return e.children&&Object.values(e.children).forEach(e=>{t+=this.calculateChainDuration(e)}),t}renderCriticalChain(e,t){var n;const a=document.createElement("div");a.className=`critical-chain-item depth-${t}`;const s=document.createElement("div");s.className="chain-item";const i=document.createElement("div");i.className="chain-indent",i.style.width=16*t+"px",t>0&&(i.innerHTML="â””â”€ ");const l=(null===(n=e.request)||void 0===n?void 0:n.url)||e.url||"Unknown URL",o=this.extractFilename(l),r=this.extractDomain(l),c=document.createElement("div");c.className="chain-url";const d=document.createElement("span");if(d.className="url-text tooltip-trigger",d.setAttribute("data-tooltip",l),d.textContent=o,r&&!r.includes(window.location.hostname)){const e=document.createElement("span");e.className="url-domain",e.textContent=` (${r})`,d.appendChild(e)}c.appendChild(d);const m=document.createElement("div");m.className="chain-timing";const u=e.transferSize||0,p=e.responseReceivedTime-e.startTime||0;return m.innerHTML=`\n      <span class="timing-size">${this.formatBytes(u)}</span>\n      <span class="timing-duration">${Math.round(p)}ms</span>\n    `,s.appendChild(i),s.appendChild(c),s.appendChild(m),a.appendChild(s),e.children&&Object.keys(e.children).length>0&&Object.values(e.children).forEach(e=>{const n=this.renderCriticalChain(e,t+1);a.appendChild(n)}),a}renderDescription(e){const t=document.createElement("div");t.className="insight-description";const n=e.replace(/\[([^\]]+)\]$$([^)]+)$$/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="insight-link">$1</a>');return t.innerHTML=n,t}renderDetails(e,t){const n=document.createElement("div");if(n.className="insight-details-container",!e.items||!Array.isArray(e.items))return n;let a=!1;for(const s of e.items)if("checklist"===s.type){const e=this.renderChecklist(s);n.appendChild(e)}else if("node"===s.type){const e=this.renderNodeInfo(s);n.appendChild(e)}else if(s.items&&Array.isArray(s.items)&&!a){const e=this.renderDetailsTable({items:s.items,headings:s.headings},t);n.appendChild(e),a=!0}if(!a&&0===n.children.length){const a=this.extractTableData(e);if(a&&a.items&&a.items.length>0){const e=this.renderDetailsTable(a,t);n.appendChild(e)}}return n}renderChecklist(e){const t=document.createElement("div");return t.className="insight-checklist",e.items&&"object"==typeof e.items?(Object.entries(e.items).forEach(([e,n])=>{const a=document.createElement("div");a.className="checklist-item";const s=document.createElement("div");s.className="checklist-icon "+(n.value?"checklist-pass":"checklist-fail"),n.value?s.innerHTML='\n          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="20,6 9,17 4,12"></polyline>\n          </svg>\n        ':s.innerHTML='\n          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <line x1="18" y1="6" x2="6" y2="18"></line>\n            <line x1="6" y1="6" x2="18" y2="18"></line>\n          </svg>\n        ';const i=document.createElement("div");i.className="checklist-label",i.textContent=n.label||e,a.appendChild(s),a.appendChild(i),t.appendChild(a)}),t):t}renderNodeInfo(e){const t=document.createElement("div");if(t.className="insight-node-info",e.snippet){const n=document.createElement("div");n.className="node-snippet",n.textContent=e.snippet,t.appendChild(n)}if(e.selector){const n=document.createElement("div");n.className="node-selector",n.textContent=`Selector: ${e.selector}`,t.appendChild(n)}if(e.nodeLabel){const n=document.createElement("div");n.className="node-label",n.textContent=e.nodeLabel,t.appendChild(n)}return t}renderNetworkTree(e){const t=document.createElement("div");if(t.className="network-tree-container",e.longestChain&&e.longestChain.duration){const n=document.createElement("div");n.className="network-latency-info",n.textContent=`Maximum critical path latency: ${e.longestChain.duration} ms`,t.appendChild(n)}const n=document.createElement("div");n.className="network-nav-header",n.textContent="Initial Navigation",t.appendChild(n);let a=null;if(e.chains)a=e.chains;else if(e.items&&Array.isArray(e.items)){for(const t of e.items){if(t.chains){a=t.chains;break}if(t.url&&(t.children||t.transferSize)){a={0:t};break}}if(!a&&e.items.length>0){const n=this.renderNetworkSimpleList(e.items);return t.appendChild(n),t}}if(a&&"object"==typeof a){const e=document.createElement("div");e.className="network-chains",Object.entries(a).forEach(([t,n])=>{const a=this.renderNetworkChain(n,0);e.appendChild(a)}),t.appendChild(e)}else{const n=document.createElement("div");n.className="network-debug",n.innerHTML=`\n        <div>Network tree structure not recognized:</div>\n        <pre style="font-size: 8px; max-height: 200px; overflow: auto;">${JSON.stringify(e,null,2)}</pre>\n      `,t.appendChild(n)}return t}renderNetworkSimpleList(e){const t=document.createElement("div");return t.className="network-simple-list",e.forEach((e,n)=>{const a=document.createElement("div");a.className="network-list-item";const s=e.url||e.href||"Unknown URL",i=this.extractFilename(s),l=this.extractDomain(s),o=document.createElement("div");if(o.className="network-url-display",o.textContent=i,l&&!l.includes(window.location.hostname)){const e=document.createElement("span");e.className="network-domain",e.textContent=` (${l})`,o.appendChild(e)}const r=document.createElement("div");r.className="network-meta";const c=[];e.transferSize&&c.push(this.formatBytes(e.transferSize)),e.duration&&c.push(`${e.duration}ms`),e.startTime&&c.push(`@${e.startTime}ms`),c.length>0&&(r.textContent=c.join(", ")),a.appendChild(o),r.textContent&&a.appendChild(r),t.appendChild(a)}),t}renderNetworkChain(e,t){if(!e||"object"!=typeof e)return document.createElement("div");const n=document.createElement("div");n.className=`network-chain-item depth-${t}`;const a=document.createElement("div");a.className="network-item";const s=document.createElement("div");s.className="tree-connector",s.style.marginLeft=20*t+"px",t>0&&(s.innerHTML="â””â”€ ");const i=e.url||e.href||"Unknown",l=this.extractFilename(i),o=this.extractDomain(i),r=document.createElement("span");r.className="network-url",o&&o.includes("mediavine.com")?r.classList.add("mediavine-domain"):o&&o.includes("googlesyndication.com")?r.classList.add("third-party"):r.classList.add("main-domain");const c=l.length>50?`...${l.slice(-47)}`:l;if(r.textContent=c,o&&!o.includes(window.location.hostname)){const e=document.createElement("span");e.className="network-domain",e.textContent=` (${o})`,r.appendChild(e)}const d=document.createElement("span");d.className="network-meta";const m=e.navStartToEndTime||e.duration||e.endTime,u=m?`${Math.round(m)} ms`:"N/A",p=e.transferSize?this.formatBytes(e.transferSize):"N/A";return d.innerHTML=` - <span class="network-timing">${u}</span>, <span class="network-size">${p}</span>`,a.appendChild(s),a.appendChild(r),a.appendChild(d),n.appendChild(a),e.children&&"object"==typeof e.children&&Object.keys(e.children).length>0&&Object.entries(e.children).forEach(([e,a])=>{const s=this.renderNetworkChain(a,t+1);n.appendChild(s)}),n}extractTableData(e){if(!e)return null;if(e.items&&Array.isArray(e.items)&&e.items.length>0){for(const n of e.items)if(n.items&&Array.isArray(n.items)&&n.items.length>0&&"checklist"!==n.type&&"node"!==n.type)return{headings:n.headings||e.headings||[],items:n.items};const t=e.items.filter(e=>"checklist"!==e.type&&"node"!==e.type&&!e.items);if(t.length>0)return{headings:e.headings||[],items:t}}return null}renderDetailsTable(e,t){const n=document.createElement("table");n.className="insight-table";const a=document.createElement("thead"),s=document.createElement("tr");if(e.headings&&e.headings.length>0)e.headings.forEach((e,t)=>{const n=document.createElement("th");let a="Column";"string"==typeof e?a=e:e&&"object"==typeof e&&(a=e.label||e.text||e.key||"Column"),n.textContent=this.formatHeading(a),0===t?n.classList.add("url-column"):this.isNumericColumn(a)&&n.classList.add("numeric-column"),s.appendChild(n)});else{const e=document.createElement("th");e.textContent="Source",e.classList.add("url-column");const t=document.createElement("th");t.textContent="Reflow Time",t.classList.add("numeric-column"),s.appendChild(e),s.appendChild(t)}a.appendChild(s),n.appendChild(a);const i=document.createElement("tbody");return e.items.forEach(n=>{const a=this.renderTableRow(n,e.headings,t);i.appendChild(a)}),n.appendChild(i),n}isNumericColumn(e){return["transfer","savings","time","size","bytes","ms","kb","mb","duration","score"].some(t=>e.toLowerCase().includes(t))}renderTableRow(e,t,n){const a=document.createElement("tr");if(t&&t.length>0)t.forEach((t,n)=>{const s=document.createElement("td");let i="unknown";"string"==typeof t?i=t:t&&"object"==typeof t&&(i=t.key||t.text||t.label||"unknown");const l=e[i];0===n?(s.className="url-cell",s.innerHTML=this.formatUrlCell(l,e)):this.isNumericColumn(i)?(s.className="numeric-cell",s.innerHTML=this.formatNumericValue(l,i)):"source"===i?(s.className="source-cell",s.innerHTML=this.formatSourceCell(l,e)):"reflowTime"===i||"time"===i||i.includes("time")||i.includes("Time")?(s.className="metric-value",s.innerHTML=this.formatTimeValue(l)):s.textContent=this.formatCellValue(l),a.appendChild(s)});else{const t=document.createElement("td");t.className="source-cell",t.innerHTML=this.formatSourceCell(e.source||e.url,e);const n=document.createElement("td");n.className="metric-value",n.innerHTML=this.formatTimeValue(e.reflowTime||e.time||e.duration),a.appendChild(t),a.appendChild(n)}return a}formatUrlCell(e,t){if(!e)return'<div class="unattributed">Unattributed</div>';const n="object"==typeof e&&(e.url||e.href)||String(e),a=this.extractFilename(n),s=this.extractDomain(n);return`\n  <div class="url-container compact">\n    <div class="url-filename tooltip-trigger" data-tooltip="${this.escapeHtml(n)}">\n      ${this.escapeHtml(a)}${s?` (${this.escapeHtml(s)})`:""}\n    </div>\n  </div>\n`}formatNumericValue(e,t){if(null==e)return'<span class="numeric-na">â€”</span>';const n=Number.parseFloat(e);return isNaN(n)?'<span class="numeric-na">â€”</span>':t.toLowerCase().includes("bytes")||t.toLowerCase().includes("size")?`<span class="numeric-bytes">${this.formatBytes(n)}</span>`:t.toLowerCase().includes("time")||t.toLowerCase().includes("ms")?`<span class="numeric-time">${n.toFixed(1)}ms</span>`:t.toLowerCase().includes("savings")?`<span class="numeric-savings">${this.formatBytes(n)}</span>`:`<span class="numeric-value">${n.toLocaleString()}</span>`}formatBytes(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]}extractDomain(e){if(!e)return"";try{return new URL(e).hostname}catch(t){return""}}formatSourceCell(e,t){if(!e)return'<div class="unattributed">Unattributed</div>';if("object"==typeof e&&e.url){const t=this.extractFilename(e.url),n=this.extractDomain(e.url);let a=`\n  <div class="url-container compact">\n    <div class="url-filename tooltip-trigger" data-tooltip="${this.escapeHtml(e.url||e)}">\n      ${this.escapeHtml(t)}${n?` (${this.escapeHtml(n)})`:""}\n    </div>\n  </div>\n`;if(void 0!==e.line||void 0!==e.column){a+=`<div class="source-location">Line ${e.line||0}, Column ${e.column||0}</div>`}return a}if("string"==typeof e){const n=this.extractFilename(e),a=this.extractDomain(e);let s=`\n  <div class="url-container compact">\n    <div class="url-filename tooltip-trigger" data-tooltip="${this.escapeHtml(e.url||e)}">\n      ${this.escapeHtml(n)}${a?` (${this.escapeHtml(a)})`:""}\n    </div>\n  </div>\n`;if(void 0!==t.line||void 0!==t.column){s+=`<div class="source-location">Line ${t.line||0}, Column ${t.column||0}</div>`}return s}return'<div class="unattributed">Unattributed</div>'}extractFilename(e){if(!e)return"Unknown";try{const t=new URL(e).pathname;return t.split("/").pop()||t||"Unknown"}catch(t){const n=e.split("/");return n[n.length-1]||e}}formatTimeValue(e){if(null==e)return'<span class="reflow-time low">N/A</span>';const t=Number.parseFloat(e);if(isNaN(t))return'<span class="reflow-time low">N/A</span>';let n="low";return t>50?n="high":t>16&&(n="medium"),`<span class="reflow-time ${n}">${t.toFixed(2)}ms</span>`}formatCellValue(e){return null==e?"N/A":"object"==typeof e?JSON.stringify(e):String(e)}formatInsightTitle(e){return e?e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"Performance Insight"}formatHeading(e){return e?"string"!=typeof e?String(e):e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim():"Column"}toggleInsight(e,t){const n=e.querySelector(".insight-header");e.querySelector(".insight-content"),n.querySelector(".insight-expand-icon");e.classList.contains("expanded")?(e.classList.remove("expanded"),n.classList.remove("expanded"),n.setAttribute("aria-expanded","false"),this.expandedInsights.delete(t)):(e.classList.add("expanded"),n.classList.add("expanded"),n.setAttribute("aria-expanded","true"),this.expandedInsights.add(t),setTimeout(()=>this.initializeTooltips(),100))}renderEmptyState(e){const t=document.createElement("div");t.className="psi-insights-empty",t.innerHTML="\n            <p>No performance insights available</p>\n            <small>Run a PageSpeed Insights analysis to see detailed performance recommendations</small>\n        ",e.appendChild(t)}renderError(e,t){const n=document.createElement("div");n.className="psi-insights-error",n.innerHTML=`\n            <p>Failed to load insights</p>\n            <small>${this.escapeHtml(t.message||"Unknown error occurred")}</small>\n        `,e.appendChild(n)}renderLoading(e){const t=document.createElement("div");t.className="psi-insights-loading",t.textContent="Loading insights...",e.appendChild(t)}escapeHtml(e){if("string"!=typeof e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}processMarkdown(e){return e?e.replace(/\[([^\]]+)\]$$([^)]+)$$/g,'<a href="$2" class="insight-link" target="_blank">$1</a>'):""}getFilenameFromUrl(e){try{const t=new URL(e),n=t.pathname;return n.split("/").pop()||t.hostname}catch{return e}}destroy(){this.tooltipElement&&this.tooltipElement.remove()}},u=(globalThis.chrome||window.chrome,{insights:{},lastUpdate:null,isLoading:!1,hasError:!1,errorMessage:""});function p(e){try{const t=function(e){try{if(!e||!e.data)return null;const t=e.data.lighthouseResult;if(!t)return null;const n=t.audits;if(!n)return null;const a={};return n.failed&&n.failed.insights&&Object.keys(n.failed.insights).forEach(e=>{a[e]={...n.failed.insights[e],category:"failed",score:0}}),n.warnings&&n.warnings.insights&&Object.keys(n.warnings.insights).forEach(e=>{a[e]={...n.warnings.insights[e],category:"warning",score:.7}}),Object.keys(a).length>0?a:null}catch(t){return null}}(e);if(!t||0===Object.keys(t).length)return void function(){const e=document.getElementById("psiInsightsContainer");if(!e)return;e.innerHTML='\n    <div class="psi-insights-empty">\n      <p>No performance insights available</p>\n      <small>Run PSI analysis to get detailed insights</small>\n    </div>\n  ',e.style.display="block"}();u.insights=t,u.lastUpdate=Date.now(),u.isLoading=!1,u.hasError=!1,function(e){const t=document.getElementById("psiInsightsContainer");if(!t)return;const n=Object.keys(e).map(t=>{const n=e[t];return{id:t,title:n.title||t,description:n.description,details:n.details,...n}});m.renderInsights(t,n),t.style.display="block"}(t)}catch(t){u.hasError=!0,u.errorMessage=t.message,u.isLoading=!1,function(e){const t=document.getElementById("psiInsightsContainer");if(!t)return;t.innerHTML=`\n    <div class="psi-insights-error">\n      <p>Error loading insights: ${e}</p>\n    </div>\n  `,t.style.display="block"}(t.message)}}function h(e){u.isLoading=e;const t=document.getElementById("psiInsightsContainer");t&&e&&(t.innerHTML='\n      <div class="psi-insights-loading">\n        <p>Loading performance insights...</p>\n      </div>\n    ',t.style.display="block")}const g=globalThis.chrome||window.chrome,f={isLoading:!1,hasError:!1,errorMessage:"",lastUpdate:null,dataTypes:{local:{available:!1,lastUpdate:null},field:{available:!1,lastUpdate:null},lab:{available:!1,lastUpdate:null}},metrics:{cls:{local:null,field:null,lab:null},lcp:{local:null,field:null,lab:null},inp:{local:null,field:null,lab:null},ttfb:{local:null,field:null,lab:null}}},y={cls:{good:.1,needsImprovement:.25},lcp:{good:2500,needsImprovement:4e3},inp:{good:200,needsImprovement:500},ttfb:{good:800,needsImprovement:1800}};function v(e,t){return"cls"===e?"number"==typeof t?t.toFixed(3):t:"number"==typeof t?`${Math.round(t)}ms`:t}function b(e){const t=JSON.parse(JSON.stringify(f));e.dataTypes&&Object.assign(f.dataTypes,e.dataTypes),e.metrics&&Object.keys(e.metrics).forEach(t=>{f.metrics[t]&&Object.assign(f.metrics[t],e.metrics[t])}),Object.keys(e).forEach(t=>{"dataTypes"!==t&&"metrics"!==t&&(f[t]=e[t])}),f.lastUpdate=Date.now(),JSON.stringify(t)!==JSON.stringify(f)&&(document.querySelectorAll(".metric-loading").forEach(e=>{e.style.display=f.isLoading?"flex":"none"}),f.isLoading&&k("analyzing"),function(){const e=document.getElementById("insightsErrorContainer");e&&(f.hasError?(e.style.display="block",e.textContent=f.errorMessage||"An error occurred",e.className="insights-error-message"):e.style.display="none")}(),hideElement("psiCacheStatus"),cacheStatus.style.display="none",function(){const e=document.querySelector('.legend-item[data-type="local"]'),t=document.querySelector('.legend-item[data-type="field"]'),n=document.querySelector('.legend-item[data-type="lab"]'),a=function(){const e={localField:!1,localLab:!1,fieldLab:!1,allSources:!1};return Object.keys(f.metrics).forEach(t=>{const n=f.metrics[t],a=n.local,s=n.field,i=n.lab;if(null!==a&&null!==s&&null!==i){const n=W(t,a),l=Math.abs(a-s)<=n,o=Math.abs(a-i)<=n,r=Math.abs(s-i)<=n;l&&o&&r?e.allSources=!0:l?e.localField=!0:o?e.localLab=!0:r&&(e.fieldLab=!0)}else{if(null!==a&&null!==s){const n=W(t,a);Math.abs(a-s)<=n&&(e.localField=!0)}if(null!==a&&null!==i){const n=W(t,a);Math.abs(a-i)<=n&&(e.localLab=!0)}if(null!==s&&null!==i){const n=W(t,s);Math.abs(s-i)<=n&&(e.fieldLab=!0)}}}),e}();if(e){const t=f.dataTypes.local.available&&!E(a);e.style.display=t?"flex":"none"}if(t){const e=f.dataTypes.field.available&&!E(a);t.style.display=e?"flex":"none"}if(n){const e=f.dataTypes.lab.available&&!E(a);n.style.display=e?"flex":"none"}!function(e){const t=document.querySelector(".cwv-legend");if(!t)return;const n=t.querySelectorAll('.legend-item[data-type*="-"], .legend-item[data-type="all-sources"]');n.forEach(e=>e.remove()),e.allSources?w(t,"all-sources","All Match"):(e.localField&&w(t,"local-field","Local + Field"),e.localLab&&w(t,"local-lab","Local + Lab"),e.fieldLab&&w(t,"field-lab","Field + Lab"))}(a);const s=document.querySelector(".cwv-legend");if(s){const e=Object.values(f.dataTypes).some(e=>e.available);s.style.display=e?"flex":"none"}}(),Object.keys(f.metrics).forEach(e=>{const t=f.metrics[e];null!==t.local&&C(e,"local",t.local),null!==t.field&&C(e,"field",t.field),null===t.lab||"cls"!==e&&"lcp"!==e||C(e,"lab",t.lab)}))}function E(e){return e.localField||e.localLab||e.fieldLab||e.allSources}function w(e,t,n){const a=document.createElement("div");a.className="legend-item",a.setAttribute("data-type",t);const s=document.createElement("div");s.className="legend-dot";const i=document.createElement("span");i.className="legend-label",i.textContent=n,a.appendChild(s),a.appendChild(i),e.appendChild(a)}function C(e,t,n){const a=document.getElementById(`${e}${t.charAt(0).toUpperCase()+t.slice(1)}Value`),s=document.getElementById(`${e}${t.charAt(0).toUpperCase()+t.slice(1)}Text`);if(!a||!s)return;a.style.display="flex";const i=v(e,n);s.textContent=i,"number"==typeof n&&(R(e,n,"field"===t,"lab"===t),function(e,t,n){const a=y[t];if(!a)return;e.classList.remove("metric-good","metric-needs-improvement","metric-poor"),n<=a.good?e.classList.add("metric-good"):n<=a.needsImprovement?e.classList.add("metric-needs-improvement"):e.classList.add("metric-poor")}(s,e,n))}function x(){const e=document.getElementById("analyzePSIBtn");if(!e)return;const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.setAttribute("data-tooltip","Analyze with PageSpeed Insights"),t.addEventListener("click",L)}async function L(){try{b({isLoading:!0,hasError:!1,errorMessage:""});const e=await(0,a.Oc)();if(!e)throw new Error("No target tab available. Please ensure you're on a valid webpage.");const t=await async function(e){return new Promise(t=>{g.tabs.sendMessage(e,{action:"ping"},e=>{g.runtime.lastError?t(!1):e&&e.ready?t(!0):t(!1)})})}(e);if(!t)throw new Error("Content script not ready. Please refresh the page and try again.");await new Promise((t,n)=>{const a=setTimeout(()=>{n(new Error("Request timeout - analysis taking too long"))},45e3);g.tabs.sendMessage(e,{action:"analyzePSI"},e=>{if(clearTimeout(a),g.runtime.lastError)n(new Error(`Connection failed: ${g.runtime.lastError.message}`));else if(e&&e.success)t(e);else{const t=(null==e?void 0:e.userMessage)||(null==e?void 0:e.message)||"Analysis failed. Please try again.";n(new Error(t))}})});b({isLoading:!1,hasError:!1})}catch(e){b({isLoading:!1,hasError:!0,errorMessage:e.message}),function(e,t={}){c(e,l,t)}(e.message,{duration:5e3})}}function k(e){const t=document.getElementById("analyzePSIBtn");if(!t)return;t.classList.remove("analyzing","success","error");const n=t.querySelector(".psi-btn-text");t.querySelector(".psi-btn-icon");"analyzing"===e?(t.classList.add("analyzing"),t.disabled=!0,n&&(n.textContent="Analyzing..."),t.setAttribute("data-tooltip","Analyzing with PageSpeed Insights...")):"success"===e?(t.classList.add("success"),t.disabled=!1,n&&(n.textContent="Success!"),t.setAttribute("data-tooltip","Analysis completed successfully"),setTimeout(()=>{k("default")},2e3)):"error"===e?(t.classList.add("error"),t.disabled=!1,n&&(n.textContent="Error"),t.setAttribute("data-tooltip","Analysis failed - click to retry"),setTimeout(()=>{k("default")},3e3)):(t.disabled=!1,n&&(n.textContent="Analyze PSI"),t.setAttribute("data-tooltip","Analyze with PageSpeed Insights"))}function I(){b({dataTypes:{local:{available:!1,lastUpdate:null},field:{available:!1,lastUpdate:null},lab:{available:!1,lastUpdate:null}},metrics:{cls:{local:null,field:null,lab:null},lcp:{local:null,field:null,lab:null},inp:{local:null,field:null,lab:null},ttfb:{local:null,field:null,lab:null}},hasError:!1,errorMessage:"",isLoading:!1}),function(){const e=document.getElementById("psiInsightsContainer");e&&(e.innerHTML="",e.style.display="none"),u.insights={},u.lastUpdate=null,u.hasError=!1,u.errorMessage=""}()}function N(e){void 0!==e.cls&&T(e.cls),void 0!==e.lcp&&S(e.lcp),void 0!==e.inp&&M(e.inp),void 0!==e.additionalMetrics&&$(e.additionalMetrics)}function T(e){const t=e.value||0;b({dataTypes:{local:{available:!0,lastUpdate:Date.now()}},metrics:{cls:{local:t}}});const n=document.getElementById("clsElementPreview");n&&(t>0?(n.style.display="block",function(e,t){const n=document.getElementById("clsElementTag"),a=document.getElementById("clsElementImage"),s=document.getElementById("clsShiftValue"),i=document.getElementById("clsElementDimensions"),l=document.getElementById("clsElementPosition"),o=document.getElementById("clsElementClassesContainer"),r=document.getElementById("clsElementClasses"),c=document.getElementById("clsElementSelector"),d=document.getElementById("clsElementSelector");if(!e||0===Object.keys(e).length||!e.tagName)return n&&(n.textContent="Layout Shift Detected"),s&&(s.textContent=t?t.toFixed(3):"0.000"),i&&(i.textContent="Element details not available"),l&&(l.textContent="Position not available"),a&&(a.innerHTML='<div class="preview-placeholder">No element preview available</div>'),o&&(o.style.display="none"),void(c&&(c.style.display="none"));if(n){let t=e.tagName?e.tagName.toUpperCase():"ELEMENT";e.classList&&e.classList.length>0?t+="."+e.classList[0]:e.id&&(t+=`#${e.id}`),n.textContent=t,n.style.color="#ff9500"}s&&(s.textContent=e.shiftValue?e.shiftValue.toFixed(3):t?t.toFixed(3):"0.000");if(i&&e.dimensions){let t=`${e.dimensions.width||0}Ã—${e.dimensions.height||0}px`;e.dimensions.naturalWidth&&e.dimensions.naturalHeight&&(t+=` (natural: ${e.dimensions.naturalWidth}Ã—${e.dimensions.naturalHeight}px)`),i.textContent=t}else i&&(i.textContent="Unknown dimensions");l&&e.position?l.textContent=`${e.position.left||0}, ${e.position.top||0}px`:l&&(l.textContent="Unknown position");o&&r&&e.classList&&e.classList.length>0?(o.style.display="block",r.textContent=e.classList.join(" "),r.title=e.classList.join(" ")):o&&(o.style.display="none");c&&d&&e.selector?(c.style.display="block",d.textContent=e.selector,d.title=e.selector):c&&(c.style.display="none");if(a){const t=e.preview||e.primarySource||e.src||e.currentSrc||e.backgroundImageUrl;if(t){a.innerHTML=`\n        <img src="${t}" \n             alt="CLS Element Preview" \n             class="element-preview-img clickable-preview" \n             title="Click to highlight this element on the page"\n             crossorigin="anonymous">\n      `;const e=a.querySelector(".clickable-preview");e&&(e.addEventListener("click",()=>{z()}),e.addEventListener("error",()=>{a.innerHTML='<div class="preview-placeholder">Preview not available</div>'}))}else a.innerHTML='<div class="preview-placeholder">No preview available</div>'}const m=document.getElementById("clsElementPreview");if(m){m.style.cursor="pointer",m.title="Click to highlight this element on the page",m.replaceWith(m.cloneNode(!0));document.getElementById("clsElementPreview").addEventListener("click",()=>{z()})}}(e.element||{},t)):n.style.display="none"),R("cls",t,!1,!1)}function S(e){const t=e.value||0;b({dataTypes:{local:{available:!0,lastUpdate:Date.now()}},metrics:{lcp:{local:t}}});const n=document.getElementById("lcpElementPreview");n&&(n.style.display="block",function(e){const t=document.getElementById("lcpElementTag"),n=document.getElementById("lcpElementImage"),a=document.getElementById("lcpElementDimensions"),s=document.getElementById("lcpElementPosition"),i=document.getElementById("lcpElementSrcContainer"),l=document.getElementById("lcpElementSrc"),o=document.getElementById("lcpElementText"),r=document.getElementById("lcpElementText"),c=document.getElementById("lcpElementClassesContainer"),d=document.getElementById("lcpElementClasses");if(!e||0===Object.keys(e).length)return t&&(t.textContent="LCP Element"),a&&(a.textContent="Analyzing..."),s&&(s.textContent="Analyzing..."),n&&(n.innerHTML='<div class="preview-placeholder">Analyzing LCP element...</div>'),i&&(i.style.display="none"),o&&(o.style.display="none"),void(c&&(c.style.display="none"));if(t){let n=e.tagName?e.tagName.toUpperCase():"ELEMENT";e.classList&&e.classList.length>0?n+="."+e.classList[0]:e.id&&(n+=`#${e.id}`),t.textContent=n,t.style.color="#007aff"}if(a&&e.dimensions){let t=`${e.dimensions.width||0}Ã—${e.dimensions.height||0}px`;e.dimensions.naturalWidth&&e.dimensions.naturalHeight&&(t+=` (natural: ${e.dimensions.naturalWidth}Ã—${e.dimensions.naturalHeight}px)`),a.textContent=t}else a&&(a.textContent="Unknown dimensions");s&&e.position?s.textContent=`${e.position.left||0}, ${e.position.top||0}px`:s&&(s.textContent="Unknown position");c&&d&&e.classList&&e.classList.length>0?(c.style.display="block",d.textContent=e.classList.join(" "),d.title=e.classList.join(" ")):c&&(c.style.display="none");if(e.primarySource||e.src||e.currentSrc||e.backgroundImageUrl){const t=e.primarySource||e.src||e.currentSrc||e.backgroundImageUrl;if(i&&l){i.style.display="block";const e=t.length>60?t.substring(0,60)+"...":t;l.textContent=e,l.title=t}}else i&&(i.style.display="none");if(e.textContent&&e.textContent.trim()){if(o&&r){o.style.display="block";const t=e.textContent.length>60?e.textContent.substring(0,60)+"...":e.textContent;r.textContent=t,r.title=e.textContent}}else o&&(o.style.display="none");if(n){const t=e.preview||e.primarySource||e.src||e.currentSrc||e.backgroundImageUrl;if(t){n.innerHTML=`\n        <img src="${t}" \n             alt="LCP Element Preview" \n             class="element-preview-img clickable-preview" \n             title="Click to highlight this element on the page"\n             crossorigin="anonymous">\n      `;const e=n.querySelector(".clickable-preview");e&&(e.addEventListener("click",()=>{q()}),e.addEventListener("error",()=>{n.innerHTML='<div class="preview-placeholder">Preview not available</div>'}))}else n.innerHTML='<div class="preview-placeholder">No preview available</div>'}const m=document.getElementById("lcpElementPreview");if(m){m.style.cursor="pointer",m.title="Click to highlight this element on the page",m.replaceWith(m.cloneNode(!0));document.getElementById("lcpElementPreview").addEventListener("click",()=>{q()})}}(e.element||{})),R("lcp",t,!1,!1)}function M(e){const t=e.value||0;b({dataTypes:{local:{available:!0,lastUpdate:Date.now()}},metrics:{inp:{local:t}}});const n=document.getElementById("inpStatus"),a=document.getElementById("inpElementPreview");if(n){const s=e.status||"waiting";if(null!=t&&t>0)if(e.entries&&e.entries.length>0){const t=e.entries[0];n.innerHTML=`\n          <div class="inp-message">\n            Latest interaction: ${t.name} on ${t.target} (${t.duration}ms)\n          </div>\n        `,t.element&&a&&(a.style.display="block",function(e,t){const n=document.getElementById("inpElementTag"),a=document.getElementById("inpElementImage"),s=document.getElementById("inpElementDimensions"),i=document.getElementById("inpElementPosition"),l=document.getElementById("inpElementClassesContainer"),o=document.getElementById("inpElementClasses"),r=document.getElementById("inpInteractionTypeContainer"),c=document.getElementById("inpInteractionType"),d=document.getElementById("inpInteractionDuration");if(!e||0===Object.keys(e).length)return n&&(n.textContent=`${t.target||"Element"} (${t.name})`),d&&(d.textContent=`${t.duration}ms`),s&&(s.textContent="Element details not available"),i&&(i.textContent="Position not available"),a&&(a.innerHTML='<div class="preview-placeholder">No element preview available</div>'),l&&(l.style.display="none"),void(r&&(r.style.display="none"));if(n){let t=e.tagName?e.tagName.toUpperCase():"ELEMENT";e.classList&&e.classList.length>0?t+="."+e.classList[0]:e.id&&(t+=`#${e.id}`),n.textContent=t,n.style.color="#ff6b35"}d&&(d.textContent=`${t.duration}ms`);if(s&&e.dimensions){const t=`${e.dimensions.width||0}Ã—${e.dimensions.height||0}px`;s.textContent=t}else s&&(s.textContent="Unknown dimensions");i&&e.position?i.textContent=`${e.position.left||0}, ${e.position.top||0}px`:i&&(i.textContent="Unknown position");l&&o&&e.classList&&e.classList.length>0?(l.style.display="block",o.textContent=e.classList.join(" "),o.title=e.classList.join(" ")):l&&(l.style.display="none");r&&c?(r.style.display="block",c.textContent=t.name||"unknown"):r&&(r.style.display="none");if(a){const t=e.preview||e.src||e.currentSrc;if(t){a.innerHTML=`\n        <img src="${t}" \n             alt="INP Element Preview" \n             class="element-preview-img clickable-preview" \n             title="Click to highlight this element on the page"\n             crossorigin="anonymous">\n      `;const e=a.querySelector(".clickable-preview");e&&(e.addEventListener("click",()=>{F()}),e.addEventListener("error",()=>{a.innerHTML='<div class="preview-placeholder">Preview not available</div>'}))}else a.innerHTML='<div class="preview-placeholder">No preview available</div>'}const m=document.getElementById("inpElementPreview");if(m){m.style.cursor="pointer",m.title="Click to highlight this element on the page",m.replaceWith(m.cloneNode(!0));document.getElementById("inpElementPreview").addEventListener("click",()=>{F()})}}(t.element,t))}else n.innerHTML=`<div class="inp-message">INP measured: ${t}ms</div>`,a&&(a.style.display="none");else n.innerHTML="waiting"===s?'<div class="inp-message">Click anywhere on the page to measure interaction responsiveness</div>':'<div class="inp-message">No interactions detected yet</div>',a&&(a.style.display="none")}R("inp",t,!1,!1)}function $(e){const t=e.ttfb||0;b({dataTypes:{local:{available:!0,lastUpdate:Date.now()}},metrics:{ttfb:{local:t}}}),R("ttfb",t,!1,!1)}function B(e){e&&null!==e.value&&void 0!==e.value&&!isNaN(e.value)&&(b({dataTypes:{field:{available:!0,lastUpdate:Date.now()}},metrics:{cls:{field:e.value}}}),R("cls",e.value,!0,!1))}function A(e){e&&null!==e.value&&void 0!==e.value&&!isNaN(e.value)&&(b({dataTypes:{field:{available:!0,lastUpdate:Date.now()}},metrics:{lcp:{field:e.value}}}),R("lcp",e.value,!0,!1))}function P(e){e&&null!==e.value&&void 0!==e.value&&!isNaN(e.value)&&(b({dataTypes:{field:{available:!0,lastUpdate:Date.now()}},metrics:{inp:{field:e.value}}}),R("inp",e.value,!0,!1))}function D(e){e&&null!==e.value&&void 0!==e.value&&!isNaN(e.value)&&(b({dataTypes:{field:{available:!0,lastUpdate:Date.now()}},metrics:{ttfb:{field:e.value}}}),R("ttfb",e.value,!0,!1))}function H(e){e&&null!==e.value&&void 0!==e.value&&!isNaN(e.value)&&(b({dataTypes:{lab:{available:!0,lastUpdate:Date.now()}},metrics:{cls:{lab:e.value}}}),R("cls",e.value,!1,!0))}function j(e){e&&null!==e.value&&void 0!==e.value&&!isNaN(e.value)&&(b({dataTypes:{lab:{available:!0,lastUpdate:Date.now()}},metrics:{lcp:{lab:e.value}}}),R("lcp",e.value,!1,!0))}function O(e){if("loading"===e.status){const e=document.getElementById("psiCacheStatus");document.getElementById("cacheStatusText");k("analyzing"),h(!0),e&&(e.style.display="none",cacheStatus&&(cacheStatus.style.display="none"),window.psiAnalysisStartTime=Date.now())}else if("success"===e.status)k("success"),h(!1);else if("error"===e.status){if(k("error"),h(!1),cacheStatus){const e=Date.now(),t=e-(window.psiAnalysisStartTime||e)>1e4,n=t?"FRESH":"CACHED",a=document.getElementById("cacheStatusText");a&&(a.textContent=n,a.className="cache-status-text "+(t?"fresh":"cached"),cacheStatus.style.display="block")}cacheStatusContainer&&(cacheStatus.style.display="none")}}function U(e){try{!function(e){const t=document.getElementById("psiCacheStatus"),n=document.getElementById("cacheStatusText");if(!t||!n)return;if(null==e)return void(psiCacheStatus.style.display="none");t.style.display="flex",!1===e?(n.textContent="Fresh",n.className="cache-status-text fresh"):(n.textContent="Cached",n.className="cache-status-text cached")}(e.fromCache),p(e)}catch(t){}}async function F(){const e=document.getElementById("inpElementPreview");try{const t=await(0,a.Oc)();if(!t)return e&&(0,a.TE)(e,"error"),!1;e&&(0,a.TE)(e,"success");return!!await(0,a.pT)(t,{action:"highlightINPElement"})}catch(t){return e&&(0,a.TE)(e,"error"),!1}}async function z(){const e=document.getElementById("clsElementPreview");try{const t=await(0,a.Oc)();if(!t)return e&&(0,a.TE)(e,"error"),!1;e&&(0,a.TE)(e,"success");return!!await(0,a.pT)(t,{action:"highlightCLSElement"})}catch(t){return e&&(0,a.TE)(e,"error"),!1}}async function q(){const e=document.getElementById("lcpElementPreview");try{const t=await(0,a.Oc)();if(!t)return e&&(0,a.TE)(e,"error"),!1;e&&(0,a.TE)(e,"success");return!!await(0,a.pT)(t,{action:"highlightLCPElement"})}catch(t){return e&&(0,a.TE)(e,"error"),!1}}function R(e,t,n=!1,a=!1){const s=y[e];if(!s||null==t)return;const i=document.querySelector(`.${e}-bar`);if(!i)return;let l=0;const o=2*s.needsImprovement;l="cls"===e?Math.min(t/.5*100,100):Math.min(t/o*100,100);let r="local",c="Local";a?(r="lab",c="Lab"):n&&(r="field",c="Field");const d=f.metrics[e].local,m=f.metrics[e].field,u=f.metrics[e].lab,p=W(e,t),h=null!==d&&null!==m&&Math.abs(d-m)<=p,g=null!==d&&null!==u&&Math.abs(d-u)<=p,b=null!==m&&null!==u&&Math.abs(m-u)<=p,E=null!==d&&null!==m&&null!==u&&h&&g&&b;i.querySelectorAll(".threshold-indicator").forEach(e=>e.remove());new Set;if(E){const n=document.createElement("div");n.className="threshold-indicator all-sources-indicator",n.style.left=`${l}%`,n.setAttribute("data-type","all-sources-indicator"),n.setAttribute("data-metric",e),n.setAttribute("data-value",t),n.setAttribute("data-position",l.toFixed(2)),n.title=`All Sources Match: ${v(e,t)}`,i.appendChild(n)}else if(h&&null!==d&&null!==m){const t=_(e,d),n=document.createElement("div");n.className="threshold-indicator local-field-indicator",n.style.left=`${t}%`,n.setAttribute("data-type","local-field-indicator"),n.setAttribute("data-metric",e),n.setAttribute("data-value",d),n.setAttribute("data-position",t.toFixed(2)),n.title=`Local + Field Match: ${v(e,d)}`,i.appendChild(n),null===u||g||V(i,e,u,"lab","Lab")}else if(g&&null!==d&&null!==u){const t=_(e,d),n=document.createElement("div");n.className="threshold-indicator local-lab-indicator",n.style.left=`${t}%`,n.setAttribute("data-type","local-lab-indicator"),n.setAttribute("data-metric",e),n.setAttribute("data-value",d),n.setAttribute("data-position",t.toFixed(2)),n.title=`Local + Lab Match: ${v(e,d)}`,i.appendChild(n),null===m||h||V(i,e,m,"field","Field")}else if(b&&null!==m&&null!==u){const t=_(e,m),n=document.createElement("div");n.className="threshold-indicator field-lab-indicator",n.style.left=`${t}%`,n.setAttribute("data-type","field-lab-indicator"),n.setAttribute("data-metric",e),n.setAttribute("data-value",m),n.setAttribute("data-position",t.toFixed(2)),n.title=`Field + Lab Match: ${v(e,m)}`,i.appendChild(n),null===d||h||V(i,e,d,"local","Local")}else null!==d&&V(i,e,d,"local","Local"),null!==m&&V(i,e,m,"field","Field"),null===u||"cls"!==e&&"lcp"!==e||V(i,e,u,"lab","Lab");const w=i.querySelectorAll(".threshold-indicator");w.length>1?(i.classList.add("multiple-indicators"),function(e,t){const n=new Map;t.forEach(e=>{const t=Number.parseFloat(e.getAttribute("data-position"));let a=!1;for(const[s,i]of n)if(Math.abs(t-s)<=1){i.push(e),a=!0;break}a||n.set(t,[e])}),n.forEach((e,t)=>{if(1===e.length){const n=e[0];n.style.left=`${t}%`,n.style.top="-5px",n.style.zIndex="10"}else e.forEach((e,n)=>{e.getAttribute("data-type");const a=8*n,s=2*n;e.style.left=`calc(${t}% + ${s}px)`,e.style.top=-5-a+"px",e.style.zIndex=`${15+n}`,e.classList.add("stacked-indicator")})})}(0,w)):i.classList.remove("multiple-indicators")}function W(e,t){return"cls"===e?Math.max(5e-4,.001*t):Math.max(1,.001*t)}function _(e,t){const n=y[e];if(!n)return 0;const a=2*n.needsImprovement;return"cls"===e?Math.min(t/.5*100,100):Math.min(t/a*100,100)}function V(e,t,n,a,s){const i=y[t];if(!i)return;let l=0;const o=2*i.needsImprovement;l="cls"===t?Math.min(n/.5*100,100):Math.min(n/o*100,100);const r=document.createElement("div");r.className=`threshold-indicator ${a}-indicator`,r.style.left=`${l}%`,r.setAttribute("data-type",a),r.setAttribute("data-metric",t),r.setAttribute("data-value",n),r.setAttribute("data-position",l.toFixed(2)),r.title=`${s}: ${v(t,n)}`,e.appendChild(r)}document.addEventListener("DOMContentLoaded",()=>{x()}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",x):x()}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a=n(607);function s(e){const t=document.getElementById("imageInfo"),n=document.getElementById("imageCount"),s=document.getElementById("imageList");t&&(t.style.marginTop="0px");const i=e.length;if(n.textContent=`Found ${i} preloaded image${1!==i?"s":""}`,s.innerHTML="",0===i){t.style.display="block";const e=document.createElement("p");return e.textContent="No preloaded images detected on this page.",e.className="empty-state-message",void s.appendChild(e)}e.forEach(e=>{const t=function(e){const t=document.createElement("li");t.className="image-list-item",t.style.cursor="pointer",t.title="Click to highlight this image on the page",t.addEventListener("click",async()=>{const n=await window.getTargetTabId();if(!n)return void(0,a.TE)(t,"error");(0,a.TE)(t,"success");await(0,a.pT)(n,{action:"highlightImage",imageUrl:e.url})});const n=function(e){const t=document.createElement("div");t.className="img-container";const n=document.createElement("img");n.alt=e.url.substring(e.url.lastIndexOf("/")+1),n.crossOrigin="anonymous";const a=document.createElement("div");return a.className="fallback-icon",a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>',n.onload=()=>{n.style.display="block",a.style.display="none"},n.onerror=()=>{n.style.display="none",a.style.display="flex"},n.src=e.url,t.appendChild(n),t.appendChild(a),t}(e),s=function(e){const t=document.createElement("div");t.className="info-container";const n=document.createElement("span");n.className="url",n.textContent=e.url,t.appendChild(n);const a=function(e){var t;const n=document.createElement("span");n.className="details";const a=[];void 0!==e.aboveFold&&a.push(e.aboveFold?"Above fold":"Below fold");e.format&&a.push(`Format: ${e.format}`);e.fileSizeFormatted&&a.push(`Size: ${e.fileSizeFormatted}`);null!==(t=e.dimensions)&&void 0!==t&&t.displayed&&a.push(`${e.dimensions.displayed.width}Ã—${e.dimensions.displayed.height}px`);e.type&&a.push(`Type: ${e.type}`);e.loading&&"auto"!==e.loading&&a.push(`Loading: ${e.loading}`);return n.textContent=a.length>0?a.join(" | "):"No additional details",n}(e);t.appendChild(a);const s=function(e){const t=document.createElement("div");if(t.className="status-container",void 0!==e.isCritical){const n=document.createElement("span");n.textContent=e.isCritical?"CRITICAL PATH":"NON-CRITICAL",n.className=e.isCritical?"status-sticker critical-path":"status-sticker non-critical",t.appendChild(n)}if(void 0!==e.aboveFold){const n=document.createElement("span");n.textContent=e.aboveFold?"ABOVE FOLD":"BELOW FOLD",n.className=e.aboveFold?"status-sticker above-fold":"status-sticker below-fold",t.appendChild(n)}return t}(e);return t.appendChild(s),t}(e);return t.appendChild(n),t.appendChild(s),t}(e);s.appendChild(t)}),t.style.display="block"}function i(e){const t=document.getElementById("fontInfo"),n=document.getElementById("fontCount"),a=document.getElementById("fontList");t&&(t.style.marginTop="0px");const s=e.length;if(n.textContent=`Found ${s} font${1!==s?"s":""} loaded`,a.innerHTML="",0===s){t.style.display="block";const e=document.createElement("p");return e.textContent="No fonts detected loading on this page.",e.className="empty-state-message",void a.appendChild(e)}e.forEach((e,t)=>{const n=function(e,t){const n=document.createElement("li");n.className="card-style font-list-item";const a=document.createElement("div");a.className="font-list-item-badge",a.textContent=t+1;const s=function(e){const t=document.createElement("div");t.className="font-list-item-content";const n=function(e){const t=document.createElement("div");t.className="url-container";const n=document.createElement("span");n.className="font-url",n.textContent=e.url,n.title=e.url;const a=function(e){const t=document.createElement("button");t.className="copy-button icon-button-sm",t.title="Copy URL";const n='<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>',a='<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';return t.innerHTML=n,t.onclick=s=>{s.stopPropagation(),navigator.clipboard.writeText(e).then(()=>{t.innerHTML=a,t.classList.add("copied-feedback"),setTimeout(()=>{t.innerHTML=n,t.classList.remove("copied-feedback")},1200)})},t}(e.url);return t.appendChild(n),t.appendChild(a),t}(e);t.appendChild(n);const a=function(e){const t=document.createElement("div");if(t.className="status-container",e.type){const n=document.createElement("span");n.textContent=e.type,n.className=`status-sticker font-type font-type-${e.type.toLowerCase()}`,t.appendChild(n)}const n=document.createElement("span");return n.textContent=e.preloaded?"PRELOADED":"NOT PRELOADED",n.className=e.preloaded?"status-sticker preloaded":"status-sticker not-preloaded",t.appendChild(n),t}(e);return t.appendChild(a),t}(e);return n.appendChild(a),n.appendChild(s),n}(e,t);a.appendChild(n)}),t.style.display="block"}function l(e,t){const n="string"==typeof t?t.toLowerCase().trim():"n/a";switch("string"==typeof e?e.toLowerCase().replace(/-/g,""):""){case"xbigscootscachestatus":case"cfcachestatus":return function(e){switch(e){case"hit":return"var(--success-bg-strong)";case"miss":return"var(--error-bg-strong)";case"bypass":return"var(--warning-bg-strong)";case"dynamic":return"var(--info-bg-strong)";default:return"var(--neutral-bg)"}}(n);case"xbigscootscacheplan":return function(e){switch(e){case"standard":return"var(--plan-standard-bg)";case"performance+":return"var(--plan-performance-plus-bg)";default:return"var(--neutral-bg)"}}(n);case"xbigscootscachemode":case"xbigscootscachemodeo2o":return o("enabled"===n||"true"===n,"n/a"===n);case"xezoiccdn":return"hit"===n?"var(--success-bg-strong)":"n/a"===n||""===n?"var(--neutral-bg)":"var(--error-bg-strong)";case"xnpcfe":return n&&"n/a"!==n&&"disabled"!==n&&"inactive"!==n?"var(--success-bg-strong)":"n/a"===n||""===n?"var(--neutral-bg)":"var(--error-bg-strong)";case"perfmattersrucss":case"perfmattersdelayjs":return o("enabled"===n,"n/a"===n);case"xhostedby":case"contentencoding":return n&&"n/a"!==n&&""!==n.trim()?"var(--info-bg-strong)":"var(--neutral-bg)";case"gtm":case"ua":case"ga4":case"ga":return n&&"n/a"!==n&&""!==n.trim()?"var(--warning-bg-strong)":"var(--neutral-bg)";case"adprovider":return"none detected"===n||"n/a"===n||""===n?"var(--neutral-bg)":"var(--success-bg-strong)";default:return"var(--neutral-bg)"}}function o(e,t=!1){return t?"var(--neutral-bg)":e?"var(--success-bg-strong)":"var(--error-bg-strong)"}function r(e){let t,n,a,s=e;if(s.startsWith("var(--")){const e=s.match(/--([a-zA-Z0-9-]+)/)[0];s=getComputedStyle(document.documentElement).getPropertyValue(e).trim()}if(!s||!s.startsWith("#"))return"var(--text-primary)";if(s=s.slice(1),3===s.length)t=Number.parseInt(s[0]+s[0],16),n=Number.parseInt(s[1]+s[1],16),a=Number.parseInt(s[2]+s[2],16);else{if(6!==s.length)return"var(--text-primary)";t=Number.parseInt(s.substr(0,2),16),n=Number.parseInt(s.substr(2,2),16),a=Number.parseInt(s.substr(4,2),16)}if(isNaN(t)||isNaN(n)||isNaN(a))return"var(--text-primary)";const i=(299*t+587*n+114*a)/1e3;return e.includes("-strong")||"var(--plan-performance-plus-bg)"===e?"#ffffff":"var(--plan-standard-bg)"===e||i>=145?"var(--text-primary)":"#ffffff"}function c(e){const t=document.getElementById("headerInfo");t&&(t.style.marginTop="0px");const n=t.querySelector(".empty-state-message");n&&n.remove();const a=t.querySelectorAll(".header-list li .header-value");if(a.forEach(e=>{e.textContent="N/A";const t=l("","N/A");e.style.backgroundColor=t,e.style.color=r(t),e.style.display="inline-block","adprovider"===e.id&&e.setAttribute("data-provider","N/A")}),e&&Object.keys(e).length>0){const n=function(e,t){let n=!1;return e.forEach(e=>{const a=e.id;let s=a;const i={perfmattersrucss:"perfmattersRUCSS",perfmattersdelayjs:"perfmattersDelayJS",adprovider:"adProvider"};i[a]&&(s=i[a]);const o=t[s];null!=o&&""!==String(o).trim()?(e.textContent=String(o),n=!0):e.textContent="N/A";const c=l(s,o);e.style.backgroundColor=c,e.style.color=r(c),"adprovider"===a&&e.setAttribute("data-provider",o&&""!==String(o).trim()?String(o):"N/A")}),n}(a,e);n||d(t,"All header information is N/A or analysis pending.")}else d(t,"No header information available or analysis pending.");t.style.display="block"}function d(e,t){if(!e.querySelector(".empty-state-message")){const n=document.createElement("p");n.textContent=t,n.className="empty-state-message",e.appendChild(n)}}var m=n(665);var u=n(153);function p(e,t){try{chrome.runtime.sendMessage(e,e=>{chrome.runtime.lastError||t&&t(e)})}catch(n){}}var h=n(194);async function g(){try{const e=await(0,h.Wm)(),t=window.outerWidth>650||window.outerHeight>650,n="chrome-extension:"===window.location.protocol,a="detached"===await async function(){return new Promise(e=>{p({action:"getWindowState"},t=>{e((null==t?void 0:t.state)||"attached")})})}(),s=null===window.opener&&window.parent===window;return(e||a)&&t&&n&&s}catch(e){return!1}}function f(e){var t,n;e?(document.body.classList.add("detached-mode"),null===(t=document.querySelector(".container"))||void 0===t||t.classList.add("detached-mode")):(document.body.classList.remove("detached-mode"),null===(n=document.querySelector(".container"))||void 0===n||n.classList.remove("detached-mode"))}const y=[{id:"insightsTab",contentId:"insightsContent"},{id:"imageAnalyzerTab",contentId:"imageAnalyzerContent"},{id:"fontAnalyzerTab",contentId:"fontAnalyzerContent"},{id:"headerAnalyzerTab",contentId:"headerAnalyzerContent"}];y.forEach(e=>{document.getElementById(e.id),document.getElementById(e.contentId)});let v=null,b=!1,E=null,w=null,C=null;function x(e,t,n,a=3){chrome.tabs.sendMessage(e,t,s=>{if(chrome.runtime.lastError){return chrome.runtime.lastError.message.includes("Receiving end does not exist")&&a>0?void setTimeout(()=>{x(e,t,n,a-1)},1e3):void(n&&n(null))}n&&n(s)})}function L(e){const t=document.getElementById("currentUrl"),n=document.getElementById("currentUrlValue");if(t&&n&&e){let s=e;try{const t=new URL(e);s=t.hostname;let n=t.pathname;"/"!==n&&n.endsWith("/")&&(n=n.slice(0,-1)),"/"!==n&&(s+=n),t.search&&(s+=t.search)}catch(a){s.endsWith("/")&&s.length>1&&(s=s.slice(0,-1))}n.textContent=s,t.classList.add("visible"),b&&(w=e)}else t&&t.classList.remove("visible")}function k(e){e.cls&&(0,m.Wl)(e.cls),e.lcp&&(0,m.LM)(e.lcp),e.inp&&(0,m.jd)(e.inp),e.additionalMetrics&&(0,m._3)(e.additionalMetrics)}function I(e){e.cls&&(0,m.sK)(e.cls),e.lcp&&(0,m.vA)(e.lcp),e.inp&&(0,m.RK)(e.inp),e.ttfb&&(0,m.eB)(e.ttfb)}function N(e){e.labCLS&&(0,m.LV)(e.labCLS),e.labLCP&&(0,m.yk)(e.labLCP)}function T(e){e.images?s(e.images):s([]),e.fonts?i(e.fonts):i([]),e.headers?c(e.headers):c({}),(0,m.jl)(e)}function S(e){e.cls&&(0,m.Wl)(e.cls),e.lcp&&(0,m.LM)(e.lcp),e.inp&&(0,m.jd)(e.inp),e.additionalMetrics&&(0,m._3)(e.additionalMetrics)}function M(){s([]),i([]),c({}),(0,m.jl)({})}async function $(){const e=document.querySelector(".window-controls");if(!e)return;b=await g(),f(b);const t=e.querySelector(".window-toggle-btn");t&&(!function(e,t){if(!t)return;const n=t.querySelector(".window-toggle-icon");n&&(e?(n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>\n    </svg>',t.title="Attach popup back to extension icon"):(n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <path d="M15 3h6v6"/>\n      <path d="M10 14 21 3"/>\n      <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>\n    </svg>',t.title="Open popup in separate window"))}(b,t),t.addEventListener("click",async()=>{t.disabled=!0;try{b?await async function(){return new Promise(e=>{p({action:"attachPopup"},async t=>{t&&t.success?(await(0,h.d2)(),window.close(),e(!0)):e(!1)})})}():await async function(){return new Promise(e=>{p({action:"detachPopup"},t=>{t&&t.success?(window.close(),e(!0)):e(!1)})})}()}catch(e){}finally{t.disabled=!1}}))}async function B(){try{const e=await async function(){return await(0,a.Oc)()}();if(!e)return;chrome.runtime.sendMessage({action:"getParameters",tabId:e},e=>{if(chrome.runtime.lastError)return;Array.isArray(e)||(e=[]);const t=document.getElementById("perfmattersoff"),n=document.getElementById("perfmatterscssoff"),a=document.getElementById("perfmattersjsoff"),s=document.getElementById("nocache");t&&(t.checked=e.includes("perfmattersoff")),n&&(n.checked=e.includes("perfmatterscssoff")),a&&(a.checked=e.includes("perfmattersjsoff")),s&&(s.checked=e.includes("nocache")),window.updateToggleStates&&window.updateToggleStates(!0)})}catch(e){}}async function A(){try{if(y.forEach(e=>{document.getElementById(e.id),document.getElementById(e.contentId)}),b=await g(),b){if(!await async function(){const e=await(0,a.rq)();if(!e)return!1;if(!await(0,a.Rn)(e))return!1;E=e;try{const e=await new Promise(e=>{chrome.runtime.sendMessage({action:"getTabUrl",tabId:E},t=>{chrome.runtime.lastError?e({success:!1,error:chrome.runtime.lastError.message}):e(t)})});e.success&&(w=e.url,L(w))}catch(t){}return!0}())return void M()}window.getTargetTabId=async()=>await(0,a.Oc)(),function(e){function t(t){e.forEach(e=>{const n=document.getElementById(e.id),a=document.getElementById(e.contentId);n&&a&&(e.id===t?(n.classList.add("active"),a.classList.add("active")):(n.classList.remove("active"),a.classList.remove("active")))}),localStorage.setItem("activeExtensionTab",t)}e.forEach(e=>{const n=document.getElementById(e.id);if(n){const a=n.cloneNode(!0);n.parentNode.replaceChild(a,n),a.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),t(e.id)})}});const n=localStorage.getItem("activeExtensionTab");n&&e.find(e=>e.id===n)?t(n):e.length>0&&t(e[0].id)}(y),(0,u.setupToggleManagement)();const e=await Promise.resolve().then(n.bind(n,153));e.updateToggleStates&&(window.updateToggleStates=e.updateToggleStates),await $(),b&&window.addEventListener("resize",()=>{f(!0)}),chrome.runtime.onMessage.addListener((e,t,n)=>{if(b&&E){if(t.tab&&t.tab.id!==E)return;"tabUrlChanged"===e.action&&e.tabId===E&&L(e.url)}"updateCLS"===e.action?(0,m.Wl)(e):"updateLCP"===e.action?(0,m.LM)(e):"updateINP"===e.action?(0,m.jd)(e):"updateAdditionalMetrics"===e.action?(0,m._3)(e.metrics):"analysisResults"===e.action?b&&E?t.tab&&t.tab.id===E&&(v=e,T(e),k(e)):b||(v=e,T(e),k(e)):"updatePSICLS"===e.action?(0,m.sK)(e.fieldData):"updatePSILCP"===e.action?(0,m.vA)(e.fieldData):"updatePSIINP"===e.action?(0,m.RK)(e.fieldData):"updatePSITTFB"===e.action?(0,m.eB)(e.fieldData):"updatePSILabCLS"===e.action?(0,m.LV)(e.labData):"updatePSILabLCP"===e.action?(0,m.yk)(e.labData):"updatePSIStatus"===e.action?(0,m.gY)(e):"completePSIResults"===e.action&&(0,m.IC)(e.psiData)}),await async function(){try{(0,m.X4)()}catch(e){}(0,m.X4)(),M();try{if(b)return E?(chrome.runtime.sendMessage({action:"getAnalysisResults",tabId:E},e=>{if(!chrome.runtime.lastError)if(e&&Object.keys(e).length>0){if(w&&e.url&&e.url!==w)return void M();v=e,T(e),k(e)}else x(E,{action:"requestAnalysis"},e=>{})}),chrome.runtime.sendMessage({action:"getPSIResults",tabId:E},e=>{if(!chrome.runtime.lastError&&e&&(e.allFieldData||e.allLabData)){if(w&&e.url&&e.url!==w)return;e.allFieldData&&I(e.allFieldData),e.allLabData&&N(e.allLabData),e.completeData&&(0,m.IC)(e.completeData),(0,m.gY)({status:"success",message:"PSI data restored"})}}),void x(E,{action:"getCurrentPerformanceData"},e=>{e?(S(e),v&&S({cls:e.cls||v.cls,lcp:e.lcp||v.lcp,inp:e.inp||v.inp,additionalMetrics:e.additionalMetrics||v.additionalMetrics})):v&&k(v)})):(M(),void L("Tab not available"));chrome.tabs.query({active:!0,currentWindow:!0},e=>{if(chrome.runtime.lastError||!e||0===e.length)return void M();const t=e[0].id,n=e[0];n.url&&L(n.url),chrome.runtime.sendMessage({action:"getAnalysisResults",tabId:t},e=>{if(!chrome.runtime.lastError)if(e&&Object.keys(e).length>0){if(n.url&&e.url&&e.url!==n.url)return M(),void chrome.tabs.sendMessage(t,{action:"requestAnalysis"},e=>{chrome.runtime.lastError});v=e,T(e),k(e)}else chrome.tabs.sendMessage(t,{action:"requestAnalysis"},e=>{chrome.runtime.lastError})}),chrome.runtime.sendMessage({action:"getPSIResults",tabId:t},e=>{if(!chrome.runtime.lastError&&e&&(e.allFieldData||e.allLabData)){if(n.url&&e.url&&e.url!==n.url)return;e.allFieldData&&I(e.allFieldData),e.allLabData&&N(e.allLabData),e.completeData&&(0,m.IC)(e.completeData),(0,m.gY)({status:"success",message:"PSI data restored"})}}),chrome.tabs.sendMessage(t,{action:"getCurrentPerformanceData"},e=>{chrome.runtime.lastError?v&&k(v):e?S(e):v&&k(v)})})}catch(e){try{const{updateInsightsState:e}=await Promise.resolve().then(n.bind(n,665));e({isLoading:!1,hasError:!0,errorMessage:"Failed to load performance data. Please refresh the page and try again."})}catch(t){}M()}}(),await B(),C&&clearInterval(C),C=setInterval(async()=>{if(b&&E){if(!await(0,a.Rn)(E))return M(),L("Tab closed or unavailable"),void(C&&(clearInterval(C),C=null));chrome.tabs.sendMessage(E,{action:"getCurrentPerformanceData"},e=>{chrome.runtime.lastError||e&&S(e)})}},3e3),function(){const e=document.getElementById("debugGearBtn"),t=document.getElementById("debugModal"),n=document.getElementById("debugModalClose"),a=null==t?void 0:t.querySelector(".debug-modal-overlay");if(!e||!t)return;e.addEventListener("click",()=>{t.style.display="flex",document.body.style.overflow="hidden"});const s=()=>{t.style.display="none",document.body.style.overflow=""};n&&n.addEventListener("click",s);a&&a.addEventListener("click",s);document.addEventListener("keydown",e=>{"Escape"===e.key&&"flex"===t.style.display&&s()})}()}catch(e){try{M()}catch(t){}}}window.addEventListener("beforeunload",()=>{C&&(clearInterval(C),C=null)}),document.addEventListener("DOMContentLoaded",()=>{A()}),"loading"!==document.readyState&&A()})();
//# sourceMappingURL=popup.js.map